{"ast":null,"code":"/*!\n    *\n    * Wijmo Library 5.20231.904\n    * http://wijmo.com/\n    *\n    * Copyright(c) GrapeCity, Inc.  All rights reserved.\n    *\n    * Licensed under the GrapeCity Commercial License.\n    * sales@wijmo.com\n    * wijmo.com/products/wijmo-5/license/\n    *\n    */\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (e, t) {\n    return (extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (e, t) {\n      e.__proto__ = t;\n    } || function (e, t) {\n      for (var i in t) t.hasOwnProperty(i) && (e[i] = t[i]);\n    })(e, t);\n  };\n  return function (e, t) {\n    extendStatics(e, t);\n    function __() {\n      this.constructor = e;\n    }\n    e.prototype = null === t ? Object.create(t) : (__.prototype = t.prototype, new __());\n  };\n}();\nimport { _addCultureInfo, culture, setAriaLabel, disableAutoComplete, isIE, isIE9, asBoolean, asString, asEnum, setSelectionRange, contains, getActiveElement, setAttribute, showPopup, hidePopup, hasClass, addClass, removeClass, toggleClass, removeChild, Control, Key, Event, EventArgs, CancelEventArgs, tryCast, createElement, hasItems, isObject, isString, asArray, asFunction, asNumber, asType, asCollectionView, closest, escapeHtml, toPlainText, setCss, Binding, Rect, DateTime, assert, isFirefox, getUniqueId, isNumber, enable, isFunction, escapeRegExp, setText, isDate, isBoolean, asDate, asInt, Globalize, _ClickRepeater, CollectionView, format, clamp, Color, _MaskProvider, setChecked, Point, isArray, getElementRect, PopupPosition, moveFocus, getElement, isUndefined, _registerModule } from \"@grapecity/wijmo\";\nimport * as selfModule from \"@grapecity/wijmo.input\";\n_addCultureInfo(\"InputNumber\", {\n  ariaLabels: {\n    incVal: \"Increase Value\",\n    decVal: \"Decrease Value\"\n  }\n});\nvar InputNumber = function (e) {\n  __extends(InputNumber, e);\n  function InputNumber(t, i) {\n    var n = e.call(this, t) || this;\n    n._value = null;\n    n._min = null;\n    n._max = null;\n    n._format = \"\";\n    n._step = null;\n    n._showBtn = !0;\n    n._readOnly = !1;\n    n._handleWheel = !0;\n    n._oldText = \"\";\n    n._fromKb = !0;\n    n.textChanged = new Event();\n    n.valueChanged = new Event();\n    var o = n.hostElement;\n    setAttribute(o, \"role\", \"spinbutton\", !0);\n    var s = n.getTemplate();\n    n.applyTemplate(\"wj-control wj-content wj-inputnumber\", s, {\n      _tbx: \"input\",\n      _btnUp: \"btn-inc\",\n      _btnDn: \"btn-dec\"\n    }, \"input\");\n    var r = culture.InputNumber.ariaLabels;\n    setAriaLabel(n._btnUp.querySelector(\"button\"), r.incVal);\n    setAriaLabel(n._btnDn.querySelector(\"button\"), r.decVal);\n    n._tbx.type.match(/number/i) && (n.inputType = \"\");\n    var a = n._tbx;\n    a.autocomplete = \"off\";\n    a.spellcheck = !1;\n    n._updateSymbols();\n    var l = n.addEventListener.bind(n);\n    l(a, \"keypress\", n._keypress.bind(n));\n    l(a, \"keydown\", n._keydown.bind(n));\n    l(a, \"input\", n._input.bind(n));\n    l(a, \"blur\", function () {\n      n.text != n._oldText && n._setText(n.text);\n    });\n    l(a, \"paste\", function () {\n      n._fromKb = !1;\n    });\n    l(a, \"compositionstart\", function () {\n      n._composing = !0;\n    });\n    l(a, \"compositionend\", function () {\n      n._composing = !1;\n      setTimeout(function () {\n        var e = n.text,\n          t = n._oldText,\n          i = n._chrPct;\n        t && t.indexOf(i) > -1 && e.indexOf(i) < 0 && (e += i);\n        n._setText(e);\n      });\n    });\n    var h = n._clickSpinner.bind(n);\n    l(n._btnUp, \"click\", h);\n    l(n._btnDn, \"click\", h);\n    n._rptUp = new _ClickRepeater(n._btnUp.querySelector(\"button\"));\n    n._rptDn = new _ClickRepeater(n._btnDn.querySelector(\"button\"));\n    l(a, \"wheel\", function (e) {\n      if (n.handleWheel && !e.defaultPrevented && !e.ctrlKey && n._isEditable() && n.containsFocus()) {\n        var t = clamp(-e.deltaY, -1, 1);\n        n._increment((n.step || 1) * t);\n        setTimeout(function () {\n          return n.selectAll();\n        });\n        e.preventDefault();\n      }\n    });\n    n.value = 0;\n    n.isRequired = !0;\n    n.initialize(i);\n    return n;\n  }\n  Object.defineProperty(InputNumber.prototype, \"inputElement\", {\n    get: function () {\n      return this._tbx;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputNumber.prototype, \"inputType\", {\n    get: function () {\n      return this._tbx.type;\n    },\n    set: function (e) {\n      this._tbx.type = asString(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputNumber.prototype, \"value\", {\n    get: function () {\n      return this._value;\n    },\n    set: function (e) {\n      if (e != this._value) if (null == (e = asNumber(e, !this.isRequired || null == e && null == this._value))) this._setText(\"\");else if (!isNaN(e)) {\n        var t = Globalize.format(e, this.format);\n        this._setText(t);\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputNumber.prototype, \"isRequired\", {\n    get: function () {\n      return this._tbx.required;\n    },\n    set: function (e) {\n      this._tbx.required = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputNumber.prototype, \"isReadOnly\", {\n    get: function () {\n      return this._readOnly;\n    },\n    set: function (e) {\n      this._readOnly = asBoolean(e);\n      this.inputElement.readOnly = this._readOnly;\n      toggleClass(this.hostElement, \"wj-state-readonly\", this.isReadOnly);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputNumber.prototype, \"handleWheel\", {\n    get: function () {\n      return this._handleWheel;\n    },\n    set: function (e) {\n      this._handleWheel = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputNumber.prototype, \"min\", {\n    get: function () {\n      return this._min;\n    },\n    set: function (e) {\n      if (e != this._min) {\n        this._min = asNumber(e, !0);\n        this._updateAria();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputNumber.prototype, \"max\", {\n    get: function () {\n      return this._max;\n    },\n    set: function (e) {\n      if (e != this._max) {\n        this._max = asNumber(e, !0);\n        this._updateAria();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputNumber.prototype, \"step\", {\n    get: function () {\n      return this._step;\n    },\n    set: function (e) {\n      this._step = asNumber(e, !0);\n      this._updateBtn();\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputNumber.prototype, \"format\", {\n    get: function () {\n      return this._format;\n    },\n    set: function (e) {\n      if (e != this.format) {\n        this._format = asString(e);\n        this.refresh();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputNumber.prototype, \"text\", {\n    get: function () {\n      return this._tbx.value;\n    },\n    set: function (e) {\n      if (e != this.text) {\n        this._oldText = null;\n        this._setText(e);\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputNumber.prototype, \"placeholder\", {\n    get: function () {\n      return this._tbx.placeholder;\n    },\n    set: function (e) {\n      this._tbx.placeholder = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputNumber.prototype, \"showSpinner\", {\n    get: function () {\n      return this._showBtn;\n    },\n    set: function (e) {\n      this._showBtn = asBoolean(e);\n      this._updateBtn();\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputNumber.prototype, \"repeatButtons\", {\n    get: function () {\n      return !this._rptUp.disabled;\n    },\n    set: function (e) {\n      this._rptUp.disabled = this._rptDn.disabled = !asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  InputNumber.prototype.selectAll = function () {\n    var e = this._tbx;\n    setSelectionRange(e, 0, e.value.length);\n  };\n  InputNumber.prototype.clamp = function (e) {\n    return clamp(e, this.min, this.max);\n  };\n  InputNumber.prototype.onTextChanged = function (e) {\n    this.textChanged.raise(this, e);\n    this._updateState();\n  };\n  InputNumber.prototype.onValueChanged = function (e) {\n    this._updateAria();\n    this.valueChanged.raise(this, e);\n  };\n  InputNumber.prototype.dispose = function () {\n    this._rptUp.element = null;\n    this._rptDn.element = null;\n    e.prototype.dispose.call(this);\n  };\n  InputNumber.prototype.onGotFocus = function (t) {\n    this._oldValue = this.value;\n    if (!this.isTouching) {\n      this._tbx.focus();\n      this.selectAll();\n    }\n    e.prototype.onGotFocus.call(this, t);\n  };\n  InputNumber.prototype.onLostFocus = function (t) {\n    if (this._composing) {\n      this._composing = !1;\n      this._setText(this.text);\n    }\n    if (this._isEditable()) {\n      var i = this.clamp(this.value);\n      if (i == this.value || this.onInvalidInput(new CancelEventArgs())) {\n        var n = Globalize.format(i, this.format);\n        this._setText(n);\n      }\n    }\n    e.prototype.onLostFocus.call(this, t);\n  };\n  InputNumber.prototype.refresh = function (t) {\n    void 0 === t && (t = !0);\n    e.prototype.refresh.call(this, t);\n    if (this.hostElement) {\n      this._updateSymbols();\n      var i = Globalize.format(this.value, this.format);\n      this._setText(i);\n    }\n  };\n  InputNumber.prototype._isEditable = function () {\n    return !this.isReadOnly && !this.isDisabled;\n  };\n  InputNumber.prototype._updateSymbols = function () {\n    var e = culture.Globalize.numberFormat,\n      t = Globalize._parseNumericFormat(this.format);\n    this._chrDec = e[\".\"] || \".\";\n    this._chrTho = e[\",\"] || \",\";\n    this._chrNeg = e[\"-\"] || \"-\";\n    this._chrPls = e[\"+\"] || \"+\";\n    this._chrPct = e[\"%\"] || \"%\";\n    this._chrCur = t.curr || e.currency.symbol || \"$\";\n    this._fmtSpc = t.spec;\n    this._fmtPrc = t.prec;\n    this._rxSym = new RegExp(\"^[%+\\\\-() \\\\\" + this._chrDec + \"\\\\\" + this._chrCur + \"\\\\\" + this._chrNeg + \"\\\\\" + this._chrPls + \"\\\\\" + this._chrPct + \"]*$\");\n    this._rxNeg = new RegExp(\"^\\\\s*(\\\\-|\\\\\" + this._chrNeg + \")|([^e](\\\\-|\\\\\" + this._chrNeg + \")|\\\\()\");\n  };\n  InputNumber.prototype._isNumeric = function (e, t) {\n    var i = e == this._chrDec || e >= \"0\" && e <= \"9\",\n      n = \"x\" == this._fmtSpc;\n    !i && n && (i = e >= \"a\" && e <= \"f\" || e >= \"A\" && e <= \"F\");\n    i || t || n || (i = e == this._chrPls || e == this._chrNeg || \"(\" == e || \")\" == e);\n    return i;\n  };\n  InputNumber.prototype._getInputRange = function (e) {\n    for (var t = [0, 0], i = this.text, n = !1, o = 0; o < i.length; o++) if (this._isNumeric(i[o], e)) {\n      if (!n) {\n        t[0] = o;\n        n = !0;\n      }\n      t[1] = o + 1;\n    }\n    return t;\n  };\n  InputNumber.prototype._flipSign = function () {\n    var e = this._getSelStartDigits();\n    this.value *= -1;\n    this._setSelStartDigits(e);\n  };\n  InputNumber.prototype._getSelStartDigits = function () {\n    for (var e = 0, t = this._tbx.selectionStart, i = this._tbx.value, n = 0; n < i.length && n < t; n++) this._isNumeric(i[n], !0) && e++;\n    return e;\n  };\n  InputNumber.prototype._setSelStartDigits = function (e) {\n    for (var t = this._tbx.value, i = 0; i < t.length && e >= 0; i++) if (this._isNumeric(t[i], !0)) {\n      if (!e) {\n        setSelectionRange(this._tbx, i);\n        break;\n      }\n      e--;\n    } else if (!e) {\n      setSelectionRange(this._tbx, i);\n      break;\n    }\n  };\n  InputNumber.prototype._increment = function (e) {\n    if (e) {\n      var t = this.clamp(isNumber(this.value) ? this.value + e : 0),\n        i = Globalize.format(t, this.format, !1, !1);\n      this._setText(i);\n    }\n  };\n  InputNumber.prototype._updateBtn = function () {\n    var e = this.showSpinner && !!this.step,\n      t = e;\n    setCss([this._btnUp, this._btnDn], {\n      display: e ? \"\" : \"none\"\n    });\n    toggleClass(this.hostElement, \"wj-input-show-spinner\", e);\n    enable(this._btnUp, t);\n    enable(this._btnDn, t);\n    this._updateAria();\n  };\n  InputNumber.prototype._setText = function (e, t, i) {\n    void 0 === t && (t = !1);\n    void 0 === i && (i = !1);\n    if (!this._composing) {\n      var n = this._tbx,\n        o = this._chrDec,\n        s = this._rxNeg.test(e),\n        r = this._delKey,\n        a = this.containsFocus();\n      e && this._rxSym.test(e) && a && (e = this.isRequired || !r ? (s ? \"-0\" : \"0\") + (e.indexOf(o) > -1 ? o : \"\") : \"\");\n      this._delKey = !1;\n      r && 0 == this.value && !this.isRequired && (e = \"\");\n      if (!e) {\n        if (!this.isRequired || i) {\n          n.value = \"\";\n          if (null != this._value) {\n            this._value = null;\n            this.onValueChanged();\n          }\n          if (this._oldText) {\n            this._oldText = e;\n            this.onTextChanged();\n          }\n          this._updateBtn();\n          return;\n        }\n        e = \"0\";\n      }\n      var l = e.indexOf(o),\n        h = this._format || (l > -1 ? \"n2\" : \"n0\"),\n        u = Globalize.parseFloat(e, h);\n      isFinite(u) || (u = this.clamp(u));\n      if (isNaN(u)) this.onInvalidInput(new CancelEventArgs()) ? n.value = this._oldText : this.focus();else {\n        var c = a && l > -1 ? 2 : null,\n          p = Globalize.format(u, h, !1, t, c);\n        s && u >= 0 && !r && (p = this._chrNeg + p);\n        a && l > -1 && \"g\" == this._fmtSpc && 0 != this._fmtPrc && (p = e).indexOf(o) < 0 && (p += o);\n        if (n.value != p) {\n          n.value = p;\n          u = Globalize.parseFloat(p, h);\n        }\n        if (u != this._value) {\n          this._value = u;\n          this.onValueChanged();\n        }\n        if (this.text != this._oldText) {\n          this._oldText = this.text;\n          this.onTextChanged();\n        }\n        this._updateBtn();\n        this._updateState();\n      }\n    }\n  };\n  InputNumber.prototype._keypress = function (e) {\n    if (!e.defaultPrevented && !this._composing && this._isEditable() && e.charCode && !e.ctrlKey && !e.metaKey && e.keyCode != Key.Enter) {\n      var t = this._tbx,\n        i = String.fromCharCode(e.charCode);\n      if (this._isNumeric(i, !1)) {\n        var n = t.maxLength;\n        if (n > -1 && t.value.length >= n && t.selectionEnd == t.selectionStart) {\n          e.preventDefault();\n          return;\n        }\n        var o = this._getInputRange(!0),\n          s = t.selectionStart,\n          r = t.selectionEnd;\n        if (s < o[0] && r < t.value.length) {\n          r = Math.max(r, o[0]);\n          setSelectionRange(t, o[0], r);\n        }\n        if (s >= o[1]) {\n          var a = null != this._fmtPrc ? this._fmtPrc : 2,\n            l = t.value.indexOf(this._chrDec);\n          l > -1 && s - l > a && e.preventDefault();\n        }\n      } else e.preventDefault();\n      switch (i) {\n        case \"-\":\n        case this._chrNeg:\n          if (this.clamp(-1) >= 0) this.value < 0 && this._flipSign();else if (this.value && t.selectionStart == t.selectionEnd) this._flipSign();else if (this.clamp(-1) < 0) {\n            t.value = this._chrNeg;\n            setSelectionRange(t, 1);\n          }\n          e.preventDefault();\n          break;\n        case \"+\":\n        case this._chrPls:\n          this.value < 0 && this._flipSign();\n          e.preventDefault();\n          break;\n        case \".\":\n        case this._chrDec:\n          if (0 == this._fmtPrc) e.preventDefault();else {\n            var h = t.value.indexOf(this._chrDec);\n            if (h > -1) {\n              t.selectionStart <= h && h++;\n              setSelectionRange(t, h);\n              e.preventDefault();\n            }\n          }\n      }\n      if (!e.defaultPrevented && isIE()) {\n        var u = t.value;\n        if ((s = t.selectionStart) == (r = t.selectionEnd)) {\n          t.value = u.substr(0, s) + i + u.substr(r);\n          setSelectionRange(t, s + 1);\n          e.preventDefault();\n          this._input();\n        }\n      }\n    }\n  };\n  InputNumber.prototype._keydown = function (e) {\n    var t = this;\n    this._delKey = !1;\n    if (!e.defaultPrevented && !this._composing) {\n      var i = hasClass(this._tbx, \"wj-grid-ime\");\n      if (!i || e.keyCode == Key.Back || e.keyCode == Key.Delete) {\n        var n = this._tbx,\n          o = n.value,\n          s = n.selectionStart,\n          r = n.selectionEnd;\n        switch (e.keyCode) {\n          case 65:\n            if (e.ctrlKey) {\n              setTimeout(function () {\n                t.selectAll();\n              });\n              e.preventDefault();\n            }\n            break;\n          case Key.Up:\n          case Key.Down:\n            if (this.step && this._isEditable()) {\n              this._increment(this.step * (e.keyCode == Key.Up ? 1 : -1));\n              setTimeout(function () {\n                t.selectAll();\n              });\n              e.preventDefault();\n            }\n            break;\n          case Key.Back:\n            this._delKey = !0;\n            if (r - s < 2 && this._isEditable()) {\n              var a = o[r - 1];\n              if (a == this._chrDec || a == this._chrPct || a == this._chrTho || \")\" == a) {\n                setTimeout(function () {\n                  r = a == t._chrPct ? t._getInputRange(!0)[1] : r - 1;\n                  setSelectionRange(n, r);\n                });\n                e.preventDefault();\n              }\n            }\n            break;\n          case Key.Delete:\n            this._delKey = !0;\n            if (r - s < 2 && this._isEditable()) if (\"0\" == o && 1 == s) setSelectionRange(n, 0);else {\n              var l = o[s];\n              if (l == this._chrDec || l == this._chrPct) {\n                setTimeout(function () {\n                  setSelectionRange(n, s + 1);\n                });\n                e.preventDefault();\n              }\n            }\n            break;\n          case Key.Escape:\n            this.value = this._oldValue;\n            this.selectAll();\n        }\n        i && this._delKey && this._isEditable() && this._setText(null, !1, !0);\n      }\n    }\n  };\n  InputNumber.prototype._input = function () {\n    var e = this;\n    this._composing ? this._fromKb = !0 : setTimeout(function () {\n      var t = e._tbx,\n        i = t.value,\n        n = i.indexOf(e._chrDec),\n        o = t.selectionStart,\n        s = e._getSelStartDigits();\n      \"p\" == e._fmtSpc && i.length && i.indexOf(e._chrPct) < 0 && (i += e._chrPct);\n      e._setText(i, e._fromKb);\n      e._fromKb = !0;\n      if (e.containsFocus()) {\n        var r = t.value,\n          a = r.indexOf(e._chrDec),\n          l = e._getInputRange(!0);\n        if (i == e._chrNeg + e._chrDec && a > -1) {\n          setSelectionRange(t, a + 1);\n          return;\n        }\n        if (i[0] == e._chrNeg && r[0] != e._chrNeg) {\n          1 == r.length ? setSelectionRange(t, 1) : e._setSelStartDigits(s);\n          return;\n        }\n        i ? i == e._chrDec && a > -1 ? o = a + 1 : o <= n && a > -1 || n < 0 && a < 0 ? o += r.length - i.length : n < 0 && a > -1 && (o = a) : o = a > -1 ? a : l[1];\n        o = clamp(o, l[0], l[1]);\n        setSelectionRange(t, o);\n      }\n    });\n  };\n  InputNumber.prototype._clickSpinner = function (e) {\n    var t = this;\n    if (!e.defaultPrevented && this._isEditable() && this.step) {\n      this._increment(this.step * (contains(this._btnUp, e.target) ? 1 : -1));\n      this.isTouching || setTimeout(function () {\n        return t.selectAll();\n      });\n    }\n  };\n  InputNumber.prototype._updateAria = function () {\n    var e = this.hostElement;\n    if (e) {\n      setAttribute(e, \"aria-valuemin\", this.min);\n      setAttribute(e, \"aria-valuemax\", this.max);\n      setAttribute(e, \"aria-valuenow\", this.value);\n      enable(this._btnDn, null == this.min || this.value > this.min);\n      enable(this._btnUp, null == this.max || this.value < this.max);\n    }\n  };\n  InputNumber.controlTemplate = '<div class=\"wj-template\"><div class=\"wj-input\"><div class=\"wj-input-group\"><span wj-part=\"btn-dec\" class=\"wj-input-group-btn\" tabindex=\"-1\"><button class=\"wj-btn wj-btn-default\" tabindex=\"-1\">-</button></span><input type=\"tel\" wj-part=\"input\" class=\"wj-form-control wj-numeric\"/><span wj-part=\"btn-inc\" class=\"wj-input-group-btn\" tabindex=\"-1\"><button class=\"wj-btn wj-btn-default\" tabindex=\"-1\">+</button></span></div></div></div>';\n  return InputNumber;\n}(Control);\nexport { InputNumber };\nvar InputMask = function (e) {\n  __extends(InputMask, e);\n  function InputMask(t, i) {\n    var n = e.call(this, t) || this;\n    n._fullEdit = !1;\n    n.valueChanged = new Event();\n    var o = n.getTemplate();\n    n.applyTemplate(\"wj-control wj-content wj-inputmask\", o, {\n      _tbx: \"input\"\n    }, \"input\");\n    if (\"INPUT\" == n._orgTag) {\n      var s = n._tbx.getAttribute(\"value\");\n      s && (n.value = s);\n    }\n    n._msk = new _MaskProvider(n._tbx);\n    n.isRequired = !0;\n    n.initialize(i);\n    n.addEventListener(n._tbx, \"input\", function () {\n      n.onValueChanged();\n    });\n    n.addEventListener(n._tbx, \"blur\", n._commitText.bind(n));\n    n.addEventListener(n._tbx, \"keydown\", function (e) {\n      e.keyCode == Key.Enter && n._commitText();\n    });\n    return n;\n  }\n  Object.defineProperty(InputMask.prototype, \"inputElement\", {\n    get: function () {\n      return this._tbx;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputMask.prototype, \"inputType\", {\n    get: function () {\n      return this._tbx.type;\n    },\n    set: function (e) {\n      this._tbx.type = asString(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputMask.prototype, \"value\", {\n    get: function () {\n      return this._tbx.value;\n    },\n    set: function (e) {\n      if (e != this.value) {\n        this._tbx.value = asString(e);\n        e = this._msk._applyMask();\n        this._tbx.value = e;\n        this.onValueChanged();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputMask.prototype, \"rawValue\", {\n    get: function () {\n      return this._msk.getRawValue();\n    },\n    set: function (e) {\n      e != this.rawValue && (this.value = asString(e));\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputMask.prototype, \"mask\", {\n    get: function () {\n      return this._msk.mask || \"\";\n    },\n    set: function (e) {\n      var t = this.value;\n      this._msk.mask = asString(e);\n      this.value != t && this.onValueChanged();\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputMask.prototype, \"promptChar\", {\n    get: function () {\n      return this._msk.promptChar;\n    },\n    set: function (e) {\n      var t = this.value;\n      this._msk.promptChar = e;\n      this.value != t && this.onValueChanged();\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputMask.prototype, \"overwriteMode\", {\n    get: function () {\n      return this._msk.overwriteMode;\n    },\n    set: function (e) {\n      this._msk.overwriteMode = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputMask.prototype, \"placeholder\", {\n    get: function () {\n      return this._tbx.placeholder;\n    },\n    set: function (e) {\n      this._tbx.placeholder = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputMask.prototype, \"maskFull\", {\n    get: function () {\n      return this._msk.maskFull;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputMask.prototype, \"isRequired\", {\n    get: function () {\n      return this._tbx.required;\n    },\n    set: function (e) {\n      this._tbx.required = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputMask.prototype, \"isReadOnly\", {\n    get: function () {\n      return this._tbx.readOnly;\n    },\n    set: function (e) {\n      this._tbx.readOnly = asBoolean(e);\n      toggleClass(this.hostElement, \"wj-state-readonly\", this.isReadOnly);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  InputMask.prototype.selectAll = function () {\n    var e = this._msk.getMaskRange();\n    setSelectionRange(this._tbx, e[0], e[1] + 1);\n  };\n  InputMask.prototype.onValueChanged = function (e) {\n    if (this.value != this._oldValue) {\n      this._oldValue = this.value;\n      this.valueChanged.raise(this, e);\n    }\n    this._updateState();\n  };\n  InputMask.prototype._commitText = function () {\n    (this.rawValue || this.isRequired) && (this.maskFull || this.onInvalidInput(new CancelEventArgs()));\n    this._updateState();\n  };\n  InputMask.prototype.dispose = function () {\n    this._msk.input = null;\n    e.prototype.dispose.call(this);\n  };\n  InputMask.prototype.refresh = function (t) {\n    void 0 === t && (t = !0);\n    e.prototype.refresh.call(this, t);\n    this.hostElement && this._msk.refresh();\n  };\n  InputMask.prototype._isGridImeEnabled = function () {\n    var e = this._tbx.closest(\".wj-flexgrid\");\n    return !(!e || !e[\"$WJ-CTRL\"]._imeHdl);\n  };\n  InputMask.prototype.onGotFocus = function (t) {\n    e.prototype.onGotFocus.call(this, t);\n    this._isGridImeEnabled() && !this._fullEdit || this.selectAll();\n  };\n  InputMask.controlTemplate = '<div class=\"wj-input\"><div class=\"wj-input-group\"><input wj-part=\"input\" class=\"wj-form-control\"/></div></div>';\n  return InputMask;\n}(Control);\nexport { InputMask };\nvar ColorPicker = function (e) {\n  __extends(ColorPicker, e);\n  function ColorPicker(t, i) {\n    var n = e.call(this, t) || this;\n    n._hsb = [.5, 1, 1];\n    n._alpha = 1;\n    n.valueChanged = new Event();\n    var o = n.getTemplate();\n    n.applyTemplate(\"wj-control wj-content wj-colorpicker\", o, {\n      _eSB: \"div-sb\",\n      _eHue: \"div-hue\",\n      _eAlpha: \"div-alpha\",\n      _ePreview: \"div-pv\",\n      _ePal: \"div-pal\",\n      _eText: \"div-text\"\n    });\n    n._palette = \"#FFF,#000,#F00,#FFC000,#FFFF00,#92D050,#00B050,#00B0F0,#0070C0,#7030A0\".split(\",\");\n    n._updatePalette();\n    n._eHue.style.backgroundImage = \"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAD4CAIAAACi6hsPAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAAGvSURBVDhPXdBPaM9xHMfxz4pWaxcmtoOhpdXSVpiyHWxqmVpDjaU5rK34XfypjTJ/p+ZPay6jhsOsRrKwaJElf9IQq03WIkv4FeMwMq221tfje1ByeFzfvd7PEKWGEKWTQRZLySWfVRRTQjmVbKWGOhLsZT+HaeY0bbTTQSfdXOcWffTzmAFeMcwoYyT5ygS/mA5hNgphip98J8kHRnnNSwZ4yH1uc4OrdHGR87RximYO0cgedlLLdqqoYAPrWMtKVrCcJSxiPmnMJUQp/Bsyk2xyyKOAQooopYwKtlDNDur5G7SBJo7RQiv/B+2hl3s84CkvGGKEOOYnxolj/mYmhBmDJ5ngCx95xxsGecYj4pB3iENeoZMO2mmlhaMcpIE4ZII6aqhmM3HMMkooopB88sghm0wySCeVlCjMCVFIYx4LWUwOeRSwhmLWU84mqqihll3sppEmjnOSs5zjEl1c4yZ99POE5wwxwns+840fTDFLFKaZZIJxkozxlmEGGSC+GF++Sy89dHOZC8Rr4lVnOMERDrCPBPXEX22jko2UEn+/mnxyWUYWC0gnNUQh/AEc0HJs6cex0gAAAABJRU5ErkJggg==)\";\n    n._eHue.style.backgroundSize = \"contain\";\n    if (navigator.appVersion.indexOf(\"MSIE 9\") > -1) {\n      n._eSB.children[0].style.filter = \"progid:DXImageTransform.Microsoft.gradient(startColorstr=#ffffffff,endColorstr=#00ffffff,GradientType=1)\";\n      n._eSB.children[1].style.filter = \"progid:DXImageTransform.Microsoft.gradient(startColorstr=#00000000,endColorstr=#ff000000,GradientType=0)\";\n    }\n    o = ColorPicker._tplCursor;\n    n._cSB = createElement(o);\n    n._cHue = createElement(o);\n    n._cHue.style.width = \"100%\";\n    n._cAlpha = createElement(o);\n    n._cAlpha.style.height = \"100%\";\n    n._eSB.appendChild(n._cSB);\n    n._eHue.appendChild(n._cHue);\n    n._eAlpha.appendChild(n._cAlpha);\n    var s = n.addEventListener.bind(n),\n      r = n.removeEventListener.bind(n),\n      a = document;\n    s(n.hostElement, \"mousedown\", function (e) {\n      s(a, \"mousemove\", mouseMove);\n      s(a, \"mouseup\", mouseUp);\n      n._mouseDown(e);\n    });\n    s(n.hostElement, \"touchstart\", function (e) {\n      s(a, \"touchmove\", mouseMove);\n      s(a, \"touchend\", mouseUp);\n      n._mouseDown(e);\n    });\n    var mouseMove = function (e) {\n        n._mouseMove(e);\n      },\n      mouseUp = function (e) {\n        r(a, \"mousemove\", mouseMove);\n        r(a, \"mouseup\", mouseUp);\n        r(a, \"touchmove\", mouseMove);\n        r(a, \"touchend\", mouseUp);\n        n._mouseUp(e);\n      };\n    s(n.hostElement, \"click\", function (e) {\n      var t = e.target;\n      if (t && \"DIV\" == t.tagName && contains(n._ePal, t)) {\n        var i = t.style.backgroundColor;\n        i && (n.value = new Color(i).toString());\n      }\n    });\n    n.value = \"#ffffff\";\n    n.initialize(i);\n    n._updatePanels();\n    return n;\n  }\n  Object.defineProperty(ColorPicker.prototype, \"showAlphaChannel\", {\n    get: function () {\n      return \"none\" != this._eAlpha.parentElement.style.display;\n    },\n    set: function (e) {\n      this._eAlpha.parentElement.style.display = asBoolean(e) ? \"\" : \"none\";\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ColorPicker.prototype, \"showColorString\", {\n    get: function () {\n      return \"none\" != this._eText.style.display;\n    },\n    set: function (e) {\n      this._eText.style.display = asBoolean(e) ? \"\" : \"none\";\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ColorPicker.prototype, \"value\", {\n    get: function () {\n      return this._value;\n    },\n    set: function (e) {\n      if (e != this.value) {\n        e = asString(e);\n        var t = Color.fromString(e);\n        if (t) {\n          this._value = e;\n          this._eText.innerText = e;\n          var i = t.getHsb();\n          if (this._hsb[0] != i[0] || this._hsb[1] != i[1] || this._hsb[2] != i[2] || this._alpha != t.a) {\n            if (0 == i[2]) {\n              i[0] = this._hsb[0];\n              i[1] = this._hsb[1];\n            } else 0 == i[1] && (i[0] = this._hsb[0]);\n            this._hsb = i;\n            this._alpha = t.a;\n            this._updatePanels();\n            this.onValueChanged();\n          }\n        }\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ColorPicker.prototype, \"palette\", {\n    get: function () {\n      return this._palette;\n    },\n    set: function (e) {\n      if ((e = (e = asArray(e)).slice(0, 10)).every(function (e) {\n        return null != Color.fromString(e);\n      })) {\n        this._palette = e;\n        this._updatePalette();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  ColorPicker.prototype.onValueChanged = function (e) {\n    this._updatePanels();\n    this.valueChanged.raise(this, e);\n  };\n  ColorPicker.prototype._mouseDown = function (e) {\n    this._htDown = this._getTargetPanel(e);\n    if (this._htDown) {\n      e.preventDefault();\n      this.focus();\n      this._mouseMove(e);\n    }\n  };\n  ColorPicker.prototype._mouseMove = function (e) {\n    var t = e.touches ? e.touches[0] : e,\n      i = this._htDown;\n    if (i) {\n      var n = i.getBoundingClientRect(),\n        o = this._hsb;\n      if (i == this._eHue) o[0] = clamp((t.clientY - n.top) / n.height, 0, .99);else if (i == this._eSB) {\n        o[1] = clamp((t.clientX - n.left) / n.width, 0, 1);\n        o[2] = clamp(1 - (t.clientY - n.top) / n.height, 0, 1);\n      } else i == this._eAlpha && (this._alpha = clamp((t.clientX - n.left) / n.width, 0, 1));\n      this._updateColor();\n    }\n  };\n  ColorPicker.prototype._mouseUp = function (e) {\n    this._htDown = null;\n  };\n  ColorPicker.prototype._updateColor = function () {\n    var e = Color.fromHsb(this._hsb[0], this._hsb[1], this._hsb[2], this._alpha);\n    this.value = e.toString();\n    this._updatePanels();\n  };\n  ColorPicker.prototype._updatePalette = function () {\n    var e = new Color(\"#fff\"),\n      t = new Color(\"#000\");\n    this._ePal.innerHTML = \"\";\n    for (var i = 0; i < this._palette.length; i++) {\n      var n = createElement('<div style=\"float:left;width:10%;box-sizing:border-box;padding:1px\">'),\n        o = new Color(this._palette[i]),\n        s = o.getHsb();\n      n.appendChild(this._makePalEntry(o, 4));\n      for (var r = 0; r < 5; r++) {\n        if (0 == s[1]) {\n          var a = .1 * r + (s[2] > .5 ? .05 : .55);\n          o = Color.interpolate(e, t, a);\n        } else o = Color.fromHsb(s[0], .1 + .2 * r, 1 - .1 * r);\n        n.appendChild(this._makePalEntry(o, 0));\n      }\n      this._ePal.appendChild(n);\n    }\n  };\n  ColorPicker.prototype._makePalEntry = function (e, t) {\n    var i = document.createElement(\"div\");\n    setCss(i, {\n      cursor: \"pointer\",\n      backgroundColor: e.toString(),\n      marginBottom: t || \"\"\n    });\n    i.innerHTML = \"&nbsp\";\n    return i;\n  };\n  ColorPicker.prototype._updatePanels = function () {\n    var e = Color.fromHsb(this._hsb[0], 1, 1, 1),\n      t = Color.fromHsb(this._hsb[0], this._hsb[1], this._hsb[2], 1);\n    this._eSB.style.backgroundColor = e.toString();\n    this._eAlpha.style.background = \"linear-gradient(to right, transparent 0%, \" + t.toString() + \" 100%)\";\n    navigator.appVersion.indexOf(\"MSIE 9\") > -1 && (this._eAlpha.style.filter = \"progid:DXImageTransform.Microsoft.gradient(startColorstr=#00000000,endColorstr=\" + t.toString() + \", GradientType = 1)\");\n    this._ePreview.style.backgroundColor = this.value;\n    this._cHue.style.top = (100 * this._hsb[0]).toFixed(0) + \"%\";\n    this._cSB.style.left = (100 * this._hsb[1]).toFixed(0) + \"%\";\n    this._cSB.style.top = (100 - 100 * this._hsb[2]).toFixed(0) + \"%\";\n    this._cAlpha.style.left = (100 * this._alpha).toFixed(0) + \"%\";\n  };\n  ColorPicker.prototype._getTargetPanel = function (e) {\n    var t = e.target;\n    return contains(this._eSB, t) ? this._eSB : contains(this._eHue, t) ? this._eHue : contains(this._eAlpha, t) ? this._eAlpha : null;\n  };\n  ColorPicker.controlTemplate = '<div style=\"position:relative;width:100%;height:100%\"><div style=\"float:left;width:50%;height:100%;box-sizing:border-box;padding:2px\"><div wj-part=\"div-pal\"><div style=\"float:left;width:10%;box-sizing:border-box;padding:2px\"><div style=\"background-color:black;width:100%\">&nbsp;</div><div style=\"height:6px\"></div></div></div><div wj-part=\"div-text\" style=\"position:absolute;bottom:0px;display:none\"></div></div><div style=\"float:left;width:50%;height:100%;box-sizing:border-box;padding:2px\"><div wj-part=\"div-sb\" class=\"wj-colorbox\" style=\"float:left;width:89%;height:89%\"><div style=\"position:absolute;width:100%;height:100%;background:linear-gradient(to right, white 0%,transparent 100%)\"></div><div style=\"position:absolute;width:100%;height:100%;background:linear-gradient(to top, black 0%,transparent 100%)\"></div></div><div style=\"float:left;width:1%;height:89%\"></div><div style=\"float:left;width:10%;height:89%\"><div wj-part=\"div-hue\" class=\"wj-colorbox\"></div></div><div style=\"float:left;width:89%;height:1%\"></div><div style=\"float:left;width:89%;height:10%\"><div style=\"width:100%;height:100%;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAAAcSURBVBhXY/iPBBYgAWpKQGkwgMqDAdUk/v8HAM7Mm6GatDUYAAAAAElFTkSuQmCC)\"><div wj-part=\"div-alpha\" class=\"wj-colorbox\"></div></div></div><div style=\"float:left;width:1%;height:10%\"></div><div style=\"float:left;width:10%;height:10%\"><div wj-part=\"div-pv\" class=\"wj-colorbox\" style=\"position:static\"></div></div></div></div>';\n  ColorPicker._tplCursor = '<div style=\"position:absolute;left:50%;top:50%;width:7px;height:7px;transform:translate(-50%,-50%);border:2px solid #f0f0f0;border-radius:50px;box-shadow:0px 0px 4px 2px #0f0f0f\"></div>';\n  return ColorPicker;\n}(Control);\nexport { ColorPicker };\nvar CollectionViewNavigator = function (e) {\n  __extends(CollectionViewNavigator, e);\n  function CollectionViewNavigator(t, i) {\n    var n = e.call(this, t) || this;\n    n._view = null;\n    n._byPage = !1;\n    n._fmt = \"{current:n0} / {count:n0}\";\n    var o = n.getTemplate();\n    n.applyTemplate(\"wj-control wj-content wj-pager wj-collectionview-navigator\", o, {\n      _btnFirst: \"btn-first\",\n      _btnPrev: \"btn-prev\",\n      _txtCurr: \"txt-curr\",\n      _btnNext: \"btn-next\",\n      _btnLast: \"btn-last\"\n    }, \"input\");\n    n._rptNext = new _ClickRepeater(n._btnNext.querySelector(\"button\"));\n    n._rptPrev = new _ClickRepeater(n._btnPrev.querySelector(\"button\"));\n    n.addEventListener(n.hostElement, \"click\", n._click.bind(n));\n    n.initialize(i);\n    n._update();\n    return n;\n  }\n  Object.defineProperty(CollectionViewNavigator.prototype, \"cv\", {\n    get: function () {\n      return this._view;\n    },\n    set: function (e) {\n      if (e != this._view) {\n        var t = this._view;\n        if (t) {\n          t.collectionChanged.removeHandler(this._collectionChanged);\n          t.currentChanged.removeHandler(this._currentChanged);\n        }\n        t = this._view = asType(e, \"ICollectionView\", !0);\n        this._update();\n        if (t) {\n          t.collectionChanged.addHandler(this._collectionChanged, this);\n          t.currentChanged.addHandler(this._currentChanged, this);\n        }\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(CollectionViewNavigator.prototype, \"byPage\", {\n    get: function () {\n      return this._byPage;\n    },\n    set: function (e) {\n      if (e != this._byPage) {\n        this._byPage = asBoolean(e);\n        this._update();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(CollectionViewNavigator.prototype, \"headerFormat\", {\n    get: function () {\n      return this._fmt;\n    },\n    set: function (e) {\n      if (e != this._fmt) {\n        this._fmt = asString(e);\n        this._update();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(CollectionViewNavigator.prototype, \"repeatButtons\", {\n    get: function () {\n      return !this._rptNext.disabled;\n    },\n    set: function (e) {\n      this._rptNext.disabled = this._rptPrev.disabled = !asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  CollectionViewNavigator.prototype._update = function () {\n    var e = this._view,\n      t = this._byPage,\n      i = e ? t ? e.pageIndex : e.currentPosition : 0,\n      n = e ? t ? e.pageCount : e.itemCount : 0;\n    enable(this._btnFirst, e && i > 0);\n    enable(this._btnPrev, e && i > 0);\n    enable(this._txtCurr, null != e);\n    enable(this._btnNext, e && i < n - 1);\n    enable(this._btnLast, e && i < n - 1);\n    this._txtCurr.value = format(this._fmt, {\n      current: e ? i + 1 : 0,\n      count: e ? n : 0,\n      currentItem: e ? e.currentPosition + 1 : 0,\n      itemCount: e ? e.itemCount : 0,\n      currentPage: e ? e.pageIndex + 1 : 0,\n      pageCount: e ? e.pageCount : 0\n    });\n  };\n  CollectionViewNavigator.prototype._currentChanged = function () {\n    this._update();\n  };\n  CollectionViewNavigator.prototype._collectionChanged = function () {\n    this._update();\n  };\n  CollectionViewNavigator.prototype._click = function (e) {\n    var t = e.target,\n      i = this._view,\n      n = this._byPage;\n    if (i) {\n      contains(this._btnFirst, t) ? n ? i.moveToFirstPage() : i.moveCurrentToFirst() : contains(this._btnPrev, t) ? n ? i.moveToPreviousPage() : i.moveCurrentToPrevious() : contains(this._btnNext, t) ? n ? i.moveToNextPage() : i.moveCurrentToNext() : contains(this._btnLast, t) && (n ? i.moveToLastPage() : i.moveCurrentToLast());\n      e.preventDefault();\n    }\n  };\n  CollectionViewNavigator.controlTemplate = '<div class=\"wj-input-group\"><span wj-part=\"btn-first\" class=\"wj-input-group-btn\"><button class=\"wj-btn wj-btn-default\" tabindex=\"-1\"><span class=\"wj-glyph-step-backward\"></span></button></span><span wj-part=\"btn-prev\" class=\"wj-input-group-btn\"> <button class=\"wj-btn wj-btn-default\" tabindex=\"-1\"><span class=\"wj-glyph-left\"></span> </button></span><input wj-part=\"txt-curr\" class=\"wj-form-control\" readonly><span wj-part=\"btn-next\" class=\"wj-input-group-btn\"><button class=\"wj-btn wj-btn-default\" tabindex=\"-1\"><span class=\"wj-glyph-right\"></span></button></span><span wj-part=\"btn-last\" class=\"wj-input-group-btn\"><button class=\"wj-btn wj-btn-default\" tabindex=\"-1\"><span class=\"wj-glyph-step-forward\"></span></button></span></div>';\n  return CollectionViewNavigator;\n}(Control);\nexport { CollectionViewNavigator };\nvar ListBox = function (e) {\n  __extends(ListBox, e);\n  function ListBox(t, i) {\n    var n = e.call(this, t, null, !0) || this;\n    n._cv = null;\n    n._itemFormatter = null;\n    n._pathDisplay = new Binding(\"\");\n    n._pathValue = new Binding(\"\");\n    n._pathChecked = new Binding(\"\");\n    n._html = !1;\n    n._shGroups = !1;\n    n._checkedItems = [];\n    n._itemRole = \"option\";\n    n._caseSensitive = !1;\n    n._vThreshold = ListBox._VTHRESH;\n    n._isVirtual = !1;\n    n._children = [];\n    n._clientHeight = -1;\n    n._itemHeight = 30;\n    n._itemsAbove = -1;\n    n._itemsBelow = -1;\n    n._eSizer = document.createElement(\"div\");\n    n._ePadTop = document.createElement(\"div\");\n    n._ePadBot = document.createElement(\"div\");\n    n._checking = !1;\n    n._ignoredItemChangedEvents = !1;\n    n._search = \"\";\n    n._fmtItemHandlers = 0;\n    n._itemCount = 0;\n    n._oldSel = null;\n    n._container = null;\n    n._oldSelectedIndex = -1;\n    n.selectedIndexChanged = new Event();\n    n.itemsChanged = new Event();\n    n.loadingItems = new Event();\n    n.loadedItems = new Event();\n    n.itemChecked = new Event();\n    n.checkedItemsChanged = new Event();\n    n.formatItem = new Event(function () {\n      n.invalidate();\n    });\n    n.applyTemplate(\"wj-control wj-content wj-listbox\", null, null);\n    var o = n.hostElement;\n    setAttribute(o, \"role\", \"listbox\", !0);\n    \"SELECT\" == n._orgTag && n._initFromSelect(n.hostElement);\n    n.addEventListener(o, \"click\", n._click.bind(n));\n    n.addEventListener(o, \"keydown\", n._keydown.bind(n));\n    n.addEventListener(o, \"keypress\", n._keypress.bind(n));\n    n.addEventListener(o, \"wheel\", function (e) {\n      if (o.scrollHeight > o.offsetHeight && (e.deltaY < 0 && 0 == o.scrollTop || e.deltaY > 0 && o.scrollTop + o.offsetHeight >= o.scrollHeight)) {\n        e.preventDefault();\n        e.stopPropagation();\n        e.stopImmediatePropagation();\n      }\n    });\n    [n._eSizer, n._ePadTop, n._ePadBot].forEach(function (e) {\n      e.tabIndex = -1;\n      setAttribute(e, \"aria-hidden\", !0);\n      setCss(e, {\n        pointerEvents: \"none\",\n        opacity: \"0\"\n      });\n    });\n    n.initialize(i);\n    n._updateViewRange();\n    n.hostElement.addEventListener(\"scroll\", function (e) {\n      n._updateViewRange();\n    });\n    return n;\n  }\n  Object.defineProperty(ListBox.prototype, \"itemsSource\", {\n    get: function () {\n      return this._items;\n    },\n    set: function (e) {\n      if (this._items != e) {\n        if (this._cv) {\n          this._cv.currentChanged.removeHandler(this._cvCurrentChanged, this);\n          this._cv.collectionChanged.removeHandler(this._cvCollectionChanged, this);\n          this._cv = null;\n        }\n        this._items = e;\n        this._cv = asCollectionView(e);\n        if (null != this._cv) {\n          this._cv.currentChanged.addHandler(this._cvCurrentChanged, this);\n          this._cv.collectionChanged.addHandler(this._cvCollectionChanged, this);\n        }\n        this._populateList();\n        this.onItemsChanged();\n        this.onSelectedIndexChanged();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ListBox.prototype, \"collectionView\", {\n    get: function () {\n      return this._cv;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ListBox.prototype, \"virtualizationThreshold\", {\n    get: function () {\n      return this._vThreshold;\n    },\n    set: function (e) {\n      if (e != this._vThreshold) {\n        var t = this._getVirtual();\n        this._vThreshold = asNumber(e, !1, !0);\n        t != this._getVirtual() && this._populateList();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ListBox.prototype, \"showGroups\", {\n    get: function () {\n      return this._shGroups;\n    },\n    set: function (e) {\n      if (e != this._shGroups) {\n        this._shGroups = asBoolean(e);\n        this._populateList();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ListBox.prototype, \"isContentHtml\", {\n    get: function () {\n      return this._html;\n    },\n    set: function (e) {\n      if (e != this._html) {\n        this._html = asBoolean(e);\n        this._populateList();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ListBox.prototype, \"itemFormatter\", {\n    get: function () {\n      return this._itemFormatter;\n    },\n    set: function (e) {\n      if (e != this._itemFormatter) {\n        this._itemFormatter = asFunction(e);\n        this._populateList();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ListBox.prototype, \"displayMemberPath\", {\n    get: function () {\n      return this._pathDisplay.path;\n    },\n    set: function (e) {\n      if (e != this.displayMemberPath) {\n        this._pathDisplay.path = asString(e);\n        this._populateList();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ListBox.prototype, \"selectedValuePath\", {\n    get: function () {\n      return this._pathValue.path;\n    },\n    set: function (e) {\n      this._pathValue.path = asString(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ListBox.prototype, \"checkedMemberPath\", {\n    get: function () {\n      return this._pathChecked.path;\n    },\n    set: function (e) {\n      if (e != this.checkedMemberPath) {\n        this._pathChecked.path = asString(e);\n        this._populateList();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ListBox.prototype, \"caseSensitiveSearch\", {\n    get: function () {\n      return this._caseSensitive;\n    },\n    set: function (e) {\n      this._caseSensitive = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ListBox.prototype, \"itemRole\", {\n    get: function () {\n      return this._itemRole;\n    },\n    set: function (e) {\n      if (e != this.itemRole) {\n        this._itemRole = asString(e);\n        this._populateList();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  ListBox.prototype.getDisplayValue = function (e) {\n    var t = null;\n    if (e > -1 && hasItems(this._cv)) {\n      t = this._cv.items[e];\n      this.displayMemberPath && (t = this._pathDisplay.getValue(t));\n    }\n    var i = null != t ? t.toString() : \"\";\n    this._itemFormatter && (i = this._itemFormatter(e, i));\n    return i;\n  };\n  ListBox.prototype.getDisplayText = function (e) {\n    var t = this._getChild(e);\n    return null != t ? t.textContent : \"\";\n  };\n  ListBox.prototype.isItemEnabled = function (e) {\n    var t = this._getChild(e);\n    return null != t && !t.hasAttribute(\"disabled\") && !hasClass(t, \"wj-state-disabled\") && !hasClass(t, \"wj-separator\");\n  };\n  Object.defineProperty(ListBox.prototype, \"selectedIndex\", {\n    get: function () {\n      return this._cv ? this._cv.currentPosition : -1;\n    },\n    set: function (e) {\n      if (this._cv) {\n        this._oldSelectedIndex = this._cv.currentPosition;\n        this._cv.moveCurrentToPosition(asNumber(e));\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ListBox.prototype, \"selectedItem\", {\n    get: function () {\n      return this._cv ? this._cv.currentItem : null;\n    },\n    set: function (e) {\n      this._cv && this._cv.moveCurrentTo(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ListBox.prototype, \"selectedValue\", {\n    get: function () {\n      var e = this.selectedItem;\n      e && this.selectedValuePath && (e = this._pathValue.getValue(e));\n      return e;\n    },\n    set: function (e) {\n      var t = this._cv,\n        i = t ? t.items : null,\n        n = this.selectedValuePath,\n        o = -1;\n      if (i) {\n        for (var s = 0; s < i.length; s++) {\n          var r = i[s],\n            a = n ? this._pathValue.getValue(r) : r;\n          if (a === e || DateTime.equals(a, e)) {\n            o = s;\n            break;\n          }\n          if (this.isContentHtml && isString(a) && a.indexOf(\"<\") > -1 && toPlainText(a) === e) {\n            o = s;\n            break;\n          }\n        }\n        this.selectedIndex = o;\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ListBox.prototype, \"maxHeight\", {\n    get: function () {\n      var e = this.hostElement,\n        t = e ? parseFloat(e.style.maxHeight) : null;\n      return isNaN(t) ? null : t;\n    },\n    set: function (e) {\n      var t = this.hostElement;\n      if (t) {\n        e = asNumber(e, !0);\n        t.style.maxHeight = null == e ? \"\" : e + \"px\";\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  ListBox.prototype.showSelection = function (e) {\n    void 0 === e && (e = this.containsFocus());\n    var t = this.hostElement,\n      i = this._children,\n      n = this._getSelectedElement(!1),\n      o = new Rect(0, 0, 0, 0);\n    if (n != this._oldSel) {\n      this._updateItemAttributes(n, !0);\n      this._updateItemAttributes(this._oldSel, !1);\n      this._oldSel = n;\n    }\n    n instanceof HTMLElement ? o = this._getBoundingClientRect(n) : this._children.length > 0 && (o = this._getBoundingClientRect(this._getChild(0)));\n    var s = this._getBoundingClientRect(t),\n      r = 0;\n    if (this._shGroups) {\n      r = this._itemHeight;\n      if (!this._isVirtual) {\n        var a = i[0];\n        a.offsetHeight && hasClass(a, \"wj-header\") && (r = a.offsetHeight);\n      }\n    }\n    o.bottom > s.bottom ? t.scrollTop += o.bottom - s.bottom : o.top < s.top + r && (t.scrollTop -= s.top + r - o.top);\n    this._updateViewRange();\n    n = this._getSelectedElement(!0);\n    if (e) {\n      (n && !contains(n, getActiveElement()) ? n : t).focus();\n    }\n    t.tabIndex = n ? -1 : this._orgTabIndex;\n  };\n  ListBox.prototype.loadList = function () {\n    this._populateList();\n  };\n  ListBox.prototype.getItemChecked = function (e) {\n    var t = this._cv.items[e],\n      i = this._pathChecked;\n    if (isObject(t) && i.path) return i.getValue(t);\n    var n = this._getCheckbox(e);\n    return !!n && n.checked;\n  };\n  ListBox.prototype.setItemChecked = function (e, t) {\n    this._setItemChecked(e, t, !0);\n  };\n  ListBox.prototype.toggleItemChecked = function (e) {\n    this.setItemChecked(e, !this.getItemChecked(e));\n  };\n  Object.defineProperty(ListBox.prototype, \"checkedItems\", {\n    get: function () {\n      return this._checkedItems;\n    },\n    set: function (e) {\n      var t = asArray(e, !1);\n      if (!this._arrayEquals(t, this._checkedItems)) {\n        this._updateCheckedList(t);\n        if (!this._arrayEquals(t, this._checkedItems)) {\n          this._checkedItems = t;\n          this.onCheckedItemsChanged();\n        }\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  ListBox.prototype.indexOf = function (e) {\n    return (e = closest(e, \".wj-listbox-item\")) ? e[ListBox._DIDX_KEY] : -1;\n  };\n  ListBox.prototype.onSelectedIndexChanged = function (e) {\n    this.selectedIndexChanged.raise(this, e);\n  };\n  ListBox.prototype.onItemsChanged = function (e) {\n    this.itemsChanged.raise(this, e);\n  };\n  ListBox.prototype.onLoadingItems = function (e) {\n    this.loadingItems.raise(this, e);\n  };\n  ListBox.prototype.onLoadedItems = function (e) {\n    this.loadedItems.raise(this, e);\n  };\n  ListBox.prototype.onItemChecked = function (e) {\n    this.itemChecked.raise(this, e);\n  };\n  ListBox.prototype.onCheckedItemsChanged = function (e) {\n    this.checkedItemsChanged.raise(this, e);\n  };\n  ListBox.prototype.onFormatItem = function (e) {\n    this.formatItem.raise(this, e);\n  };\n  ListBox.prototype.refresh = function (t) {\n    void 0 === t && (t = !0);\n    e.prototype.refresh.call(this, t);\n    if (this.hostElement) {\n      var i = this._cv ? this._cv.items.length : 0,\n        n = this.formatItem.handlerCount;\n      if (i != this._itemCount || n != this._fmtItemHandlers) {\n        this._fmtItemHandlers = n;\n        this._populateList();\n      } else this._updateViewRange();\n    }\n  };\n  ListBox.prototype._updateCheckedList = function (e) {\n    var t = this,\n      i = this._cv,\n      n = this._pathChecked,\n      o = new Map();\n    if (n && i) {\n      var s = i.sourceCollection;\n      if (s && s.length) {\n        isObject(s[0]) || (n = null);\n        e.forEach(function (e) {\n          return o.set(e, !0);\n        });\n        this._checking = !0;\n        var r = [];\n        s.forEach(function (e) {\n          var t = o.has(e);\n          t && r.push(e);\n          n && n.setValue(e, t);\n        });\n        this._checking = !1;\n        e = r;\n      }\n      i.items.forEach(function (e, i) {\n        t._setItemChecked(i, o.has(e), !1);\n      });\n    }\n  };\n  ListBox.prototype._getBoundingClientRect = function (e) {\n    if (!e.offsetHeight) {\n      var t = this.indexOf(e),\n        i = this.hostElement;\n      if (t > -1 && i) {\n        t = this._getElementIndex(t);\n        var n = i.getBoundingClientRect();\n        return new Rect(0, n.top - i.scrollTop + t * this._itemHeight, n.width, this._itemHeight);\n      }\n    }\n    return Rect.fromBoundingRect(e.getBoundingClientRect());\n  };\n  ListBox.prototype._updateItemAttributes = function (e, t) {\n    if (e) {\n      var i = this.checkedMemberPath ? this._getCheckbox(this.indexOf(e)) : null,\n        n = i ? i.checked : null;\n      toggleClass(e, \"wj-state-selected\", t);\n      setAttribute(e, \"aria-selected\", this._getAriaSelected(t, n));\n      e.tabIndex = t ? this._orgTabIndex : -1;\n    }\n  };\n  ListBox.prototype._getCheckedItems = function () {\n    var e = this,\n      t = this._cv,\n      i = this._pathChecked,\n      n = [];\n    t && i && i.path && (n = t.sourceCollection.filter(function (n, o) {\n      if (t.filter && !t.filter(n)) return !1;\n      if (isObject(n)) return i.getValue(n);\n      var s = t.items[o] == n ? o : t.items.indexOf(n);\n      return e.getItemChecked(s);\n    }));\n    return n;\n  };\n  ListBox.prototype._arrayEquals = function (e, t) {\n    if (e == t) return !0;\n    if (!e || !t || e.length != t.length) return !1;\n    for (var i = 0; i < e.length; i++) if (e[i] !== t[i]) return !1;\n    return !0;\n  };\n  ListBox.prototype._getChild = function (e) {\n    e = this._getElementIndex(e);\n    return this._children[e];\n  };\n  ListBox.prototype._getElementIndex = function (e) {\n    if (this._shGroups) for (var t = this._children, i = 0; i <= e && i < t.length; i++) {\n      var n = t[i];\n      hasClass(n, \"wj-header\") && e++;\n    }\n    return e;\n  };\n  ListBox.prototype._setItemChecked = function (e, t, i) {\n    void 0 === i && (i = !0);\n    var n = this._cv.items[e],\n      o = this._pathChecked,\n      s = !1,\n      r = this.selectedIndex,\n      a = this._checking;\n    if (isObject(n) && o.path) {\n      if (!!o.getValue(n) != t) {\n        var l = tryCast(this._cv, \"IEditableCollectionView\");\n        s = !0;\n        this._checking = !0;\n        if (l) {\n          l.editItem(n);\n          o.setValue(n, t);\n          l.commitEdit();\n        } else {\n          o.setValue(n, t);\n          l.refresh();\n        }\n        this._checking = a;\n      }\n    } else if (i) {\n      var h = this._checkedItems.indexOf(n);\n      (t && h < 0 || !t && h >= 0) && (s = !0);\n    }\n    var u = this._getCheckbox(e);\n    if (u) {\n      u.checked = t;\n      var c = closest(u, \".wj-listbox-item\");\n      if (c) {\n        toggleClass(c, \"wj-state-checked\", t);\n        setAttribute(c, \"aria-selected\", !!t || null);\n      }\n    }\n    if (i) {\n      if (s) {\n        this._checkedItems = this._checkedItemsUpdate(n, t);\n        this.onItemChecked();\n        this.onCheckedItemsChanged();\n      }\n      r != this.selectedIndex && this.onSelectedIndexChanged();\n    }\n    return s;\n  };\n  ListBox.prototype._checkedItemsUpdate = function (e, t) {\n    var i = this._cv.sourceCollection,\n      n = this._checkedItems,\n      o = 0;\n    if (t) {\n      for (var s = 0; s < i.length; s++) {\n        var r = i[s];\n        if (r === n[o] && o < n.length) o++;else if (r === e) return n.slice(0, o).concat([e]).concat(n.slice(o));\n      }\n      return n;\n    }\n    var a = n.indexOf(e);\n    return n.slice(0, a).concat(n.slice(a + 1));\n  };\n  ListBox.prototype._cvCollectionChanged = function () {\n    if (!this._checking) {\n      this._populateList();\n      this.onItemsChanged();\n    }\n  };\n  ListBox.prototype._cvCurrentChanged = function () {\n    if (!this._checking) {\n      this.showSelection();\n      this._ignoredItemChangedEvents || this.onSelectedIndexChanged();\n    }\n  };\n  ListBox.prototype._populateList = function () {\n    var e = this.hostElement,\n      t = this._cv;\n    this._itemCount = t ? t.items.length : 0;\n    this._isVirtual = this._getVirtual();\n    this._oldSel = null;\n    this._itemsAbove = -1;\n    this._itemsBelow = -1;\n    if (e) {\n      var i = this.containsFocus(),\n        n = void 0;\n      this.onLoadingItems();\n      var o = this._children = [];\n      e.textContent = \"\";\n      if (t) {\n        var s = 0,\n          r = void 0,\n          a = [];\n        if (this._shGroups && t.groups && t.groups.length) {\n          n = {};\n          for (var l = 0; l < t.groups.length; l++) {\n            var h = t.groups[l];\n            n[s] = h;\n            r = this._createHeaderItem(h);\n            a.push(r);\n            for (var u = 0; u < h.items.length; u++, s++) {\n              r = this._createItem(s);\n              a.push(r);\n            }\n          }\n        } else for (u = 0; u < t.items.length; u++, s++) {\n          r = this._createItem(s);\n          a.push(r);\n        }\n        var c = this._isVirtual ? document.createElement(\"div\") : e,\n          p = 0;\n        c.innerHTML = a.join(\"\");\n        for (u = 0; u < c.children.length; u++) {\n          var d = c.children[u];\n          p == t.currentPosition && (this._oldSel = d);\n          d[ListBox._DIDX_KEY] = d.className.indexOf(\"wj-header\") < 0 ? p++ : -1;\n          o.push(d);\n        }\n      }\n      if (this.formatItem.hasHandlers && t) {\n        s = 0;\n        var f = t.items;\n        for (d = new FormatItemEventArgs(0, null, null), u = 0; u < o.length; u++) {\n          d._item = o[u];\n          if (this._shGroups && hasClass(d._item, \"wj-header\")) {\n            d._index = -1;\n            d._data = n[s];\n          } else {\n            d._index = s;\n            d._data = f[s++];\n          }\n          this.onFormatItem(d);\n        }\n      }\n      if (this._isVirtual) {\n        var _ = this._getCanvasContext(),\n          m = null,\n          g = 0;\n        for (u = 0; u < o.length; u++) {\n          r = o[u];\n          var b = _.measureText(r.textContent);\n          if (b.width > g) {\n            m = r;\n            g = b.width;\n          }\n        }\n        if (m) {\n          var y = !1,\n            v = e.style.display,\n            x = e.style.position;\n          if (!e.parentElement) {\n            y = !0;\n            (this._container || document.body).appendChild(e);\n            setCss(e, {\n              display: \"\",\n              position: \"absolute\"\n            });\n          }\n          e.appendChild(m);\n          var w = m.style.whiteSpace;\n          m.style.whiteSpace = \"nowrap\";\n          this._ePadTop.style.width = m.offsetWidth + \"px\";\n          this._itemHeight = m.offsetHeight || this._itemHeight;\n          m.style.whiteSpace = w;\n          this._eSizer.style.height = o.length * this._itemHeight + \"px\";\n          e.appendChild(this._eSizer);\n          this._clientHeight = e.clientHeight;\n          removeChild(this._eSizer);\n          if (y) {\n            removeChild(e);\n            setCss(e, {\n              display: v,\n              position: x\n            });\n          }\n          removeChild(m);\n        } else this._ePadTop.style.width = \"\";\n        this._updateViewRange();\n      }\n      this.checkedItems = this._getCheckedItems();\n      var C = this._getSelectedElement(!0);\n      if (i) {\n        (C || e).focus();\n      } else C && this.showSelection();\n      e.tabIndex = C ? -1 : this._orgTabIndex;\n      this.onLoadedItems();\n    }\n  };\n  ListBox.prototype._getCanvasContext = function () {\n    var e = document.createElement(\"canvas\").getContext(\"2d\"),\n      t = getComputedStyle(this.hostElement);\n    t.fontSize && t.fontFamily && (e.font = t.fontSize + \" \" + t.fontFamily.split(\",\")[0]);\n    return e;\n  };\n  ListBox.prototype._getVirtual = function () {\n    if (this._itemCount <= this._vThreshold) return !1;\n    var e = this.hostElement;\n    if (e) {\n      var t = getComputedStyle(e);\n      if (parseInt(t.columnCount) > 1 || t.display.indexOf(\"flex\") > -1 || t.display.indexOf(\"grid\") > -1) return !1;\n    }\n    return !0;\n  };\n  ListBox.prototype._getMaxSupportedCssHeight = function () {\n    var e = 265e5;\n    isIE() ? e = 15e5 : isFirefox() && (e = 175e5);\n    return e;\n  };\n  ListBox.prototype._updateViewRange = function () {\n    var e = this.hostElement,\n      t = this._itemHeight,\n      i = this._children;\n    if (!(e && e.parentElement && this._isVirtual && i)) return !1;\n    var n = e.scrollTop;\n    assert(t * i.length < this._getMaxSupportedCssHeight(), \"The number of items (\" + i.length + \") exceeds the maximum number of items (\" + Math.floor(this._getMaxSupportedCssHeight() / t) + \") allowed for this browser.\");\n    var o = Math.max(e.clientHeight, this._clientHeight),\n      s = Math.floor(n / t),\n      r = Math.min(i.length, Math.ceil((n + o) / t) - s),\n      a = Math.max(0, i.length - s - r);\n    if (s == this._itemsAbove && a == this._itemsBelow) return !1;\n    this._itemsAbove = s;\n    this._itemsBelow = a;\n    var l = document.createDocumentFragment(),\n      h = this.containsFocus();\n    this._ePadTop.style.height = s * t + \"px\";\n    l.appendChild(this._ePadTop);\n    if (this.showGroups && !hasClass(i[s], \"wj-header\")) for (var u = s; u >= 0; u--) if (hasClass(i[u], \"wj-header\")) {\n      l.appendChild(i[u]);\n      break;\n    }\n    for (u = s; u <= s + r && u < i.length; u++) l.appendChild(i[u]);\n    this._ePadBot.style.height = a * t + \"px\";\n    l.appendChild(this._ePadBot);\n    e.textContent = \"\";\n    e.appendChild(l);\n    var c = (s + r + a) * t - e.scrollHeight;\n    this._ePadBot.style.height = this._ePadBot.offsetHeight - c + \"px\";\n    var p = this._getSelectedElement(!0);\n    if (h) {\n      (p || e).focus({\n        preventScroll: !0\n      });\n    }\n    e.tabIndex = p ? -1 : this._orgTabIndex;\n    return !0;\n  };\n  ListBox.prototype._getSelectedElement = function (e) {\n    var t = this.selectedIndex,\n      i = this._getElementIndex(t),\n      n = i > -1 ? this._children[i] : null;\n    e && n && !n.offsetHeight && (n = null);\n    return n;\n  };\n  ListBox.prototype._handleResize = function () {\n    this._updateViewRange();\n  };\n  ListBox.prototype._createItem = function (e) {\n    var t = this._cv.items[e],\n      i = e == this._cv.currentPosition,\n      n = this.getDisplayValue(e);\n    1 != this._html && (n = escapeHtml(n));\n    var o = null;\n    if (this.checkedMemberPath) {\n      o = !1;\n      isObject(t) ? o = !!this._pathChecked.getValue(t) : this._checkedItems && (o = this._checkedItems.indexOf(t) > -1);\n      n = '<label><input type=\"checkbox\" tabindex=\"-1\"' + (o ? \" checked\" : \"\") + \"><span></span> \" + n + \"</label>\";\n    }\n    var s = \"wj-listbox-item\";\n    i && (s += \" wj-state-selected\");\n    o && (s += \" wj-state-checked\");\n    if (this._html) {\n      var r = [\"wj-separator\", \"wj-state-disabled\"];\n      if (n.indexOf(r[0]) > -1 || n.indexOf(r[1]) > -1) {\n        var a = createElement(n);\n        r.forEach(function (e) {\n          hasClass(a, e) && (s += \" \" + e);\n        });\n      }\n    }\n    return '<div class=\"' + s + '\" role=\"' + this.itemRole + '\" ' + (this._getAriaSelected(i, o) ? 'aria-selected=\"true\" ' : \"\") + 'tabindex=\"' + (i && !this.isDisabled ? this._orgTabIndex : -1) + '\">' + n + \"</div>\";\n  };\n  ListBox.prototype._getAriaSelected = function (e, t) {\n    return !!(null != t ? t : e) || null;\n  };\n  ListBox.prototype._createHeaderItem = function (e) {\n    return '<div class=\"wj-listbox-item wj-header wj-state-disabled\" role=\"presentation\" tabindex=\"-1\">' + escapeHtml(e.name) + \"</div>\";\n  };\n  ListBox.prototype._click = function (e) {\n    if (0 == e.button && !e.defaultPrevented) {\n      var t = this.indexOf(e.target);\n      if (t > -1) {\n        this.selectedIndex = t;\n        if (this.checkedMemberPath) {\n          var i = this._getCheckbox(t),\n            n = closest(i, \".wj-listbox-item\");\n          if (e.target == i || e.target == n) {\n            n.focus({\n              preventScroll: !0\n            });\n            this.setItemChecked(t, i.checked);\n          }\n        } else {\n          (n = closest(e.target, \".wj-listbox-item\")).focus({\n            preventScroll: !0\n          });\n        }\n      }\n    }\n  };\n  ListBox.prototype._keydown = function (e) {\n    var t = this.selectedIndex;\n    if (!e.defaultPrevented) {\n      if (65 == e.keyCode && (e.ctrlKey || e.metaKey)) {\n        var i = this.collectionView;\n        if (this.checkedMemberPath && hasItems(i)) {\n          this.checkedItems = this.checkedItems.length != i.items.length ? i.items : [];\n          e.preventDefault();\n          return;\n        }\n      }\n      if (!(e.ctrlKey || e.shiftKey || e.altKey || e.metaKey)) switch (e.keyCode) {\n        case Key.Down:\n          e.preventDefault();\n          this._selectNext();\n          break;\n        case Key.Up:\n          e.preventDefault();\n          this._selectPrev();\n          break;\n        case Key.Home:\n          e.preventDefault();\n          this._selectFirst();\n          break;\n        case Key.End:\n          e.preventDefault();\n          this._selectLast();\n          break;\n        case Key.PageDown:\n          e.preventDefault();\n          this._selectNextPage();\n          break;\n        case Key.PageUp:\n          e.preventDefault();\n          this._selectPrevPage();\n          break;\n        case Key.Space:\n          if (this.checkedMemberPath && t > -1) {\n            var n = this._getCheckbox(t);\n            if (n && this.isItemEnabled(t)) {\n              this.setItemChecked(t, !n.checked);\n              e.preventDefault();\n            }\n          }\n      }\n    }\n  };\n  ListBox.prototype._keypress = function (e) {\n    var t = this;\n    if (!e.defaultPrevented && !(e.target instanceof HTMLInputElement) && (e.charCode > 32 || 32 == e.charCode && this._search)) {\n      e.preventDefault();\n      this._search += String.fromCharCode(e.charCode);\n      this._toSearch && clearTimeout(this._toSearch);\n      this._toSearch = setTimeout(function () {\n        t._toSearch = null;\n        t._search = \"\";\n      }, Control._SEARCH_DELAY);\n      var i = this._findNext();\n      if (i < 0 && this._search.length > 1) {\n        this._search = this._search[this._search.length - 1];\n        i = this._findNext();\n      }\n      i > -1 && (this.selectedIndex = i);\n    }\n  };\n  ListBox.prototype._selectNext = function () {\n    for (var e = this.selectedIndex + 1; e < this._children.length; e++) if (this.isItemEnabled(e)) {\n      this.selectedIndex = e;\n      return !0;\n    }\n    return !1;\n  };\n  ListBox.prototype._selectPrev = function () {\n    for (var e = this.selectedIndex - 1; e >= 0; e--) if (this.isItemEnabled(e)) {\n      this.selectedIndex = e;\n      return !0;\n    }\n    return !1;\n  };\n  ListBox.prototype._selectFirst = function () {\n    for (var e = 0; e < this._children.length; e++) if (this.isItemEnabled(e)) {\n      this.selectedIndex = e;\n      return !0;\n    }\n    return !1;\n  };\n  ListBox.prototype._selectLast = function () {\n    for (var e = this._children.length - 1; e >= 0; e--) if (this.isItemEnabled(e)) {\n      this.selectedIndex = e;\n      return !0;\n    }\n    return !1;\n  };\n  ListBox.prototype._selectNextPage = function () {\n    var e = this.hostElement.offsetHeight,\n      t = this._children,\n      i = this._cv ? this._cv.items.length : 0,\n      n = 0;\n    if (e > 0) for (var o = this.selectedIndex + 1; o < i; o++) {\n      var s = t[o].scrollHeight || this._itemHeight;\n      if (n + s > e && this.isItemEnabled(o)) {\n        this.selectedIndex = o;\n        return !0;\n      }\n      n += s;\n    }\n    return this._selectLast();\n  };\n  ListBox.prototype._selectPrevPage = function () {\n    var e = this.hostElement.offsetHeight,\n      t = this._children,\n      i = 0;\n    if (e > 0) for (var n = this.selectedIndex - 1; n > 0; n--) {\n      var o = t[n].scrollHeight || this._itemHeight;\n      if (i + o > e && this.isItemEnabled(n)) {\n        this.selectedIndex = n;\n        return !0;\n      }\n      i += o;\n    }\n    return this._selectFirst();\n  };\n  ListBox.prototype._findNext = function () {\n    if (this.hostElement) {\n      var e = this._children.length,\n        t = this.selectedIndex;\n      (t < 0 || 1 == this._search.length) && t++;\n      var i = this._search,\n        n = this.caseSensitiveSearch;\n      n || (i = i.toLowerCase());\n      for (var o = 0; o < e; o++) {\n        var s = (t + o) % e;\n        if (this.isItemEnabled(s)) {\n          var r = this.getDisplayText(s).trim();\n          n || (r = r.toLowerCase());\n          if (0 == r.indexOf(i)) return s;\n        }\n      }\n    }\n    return -1;\n  };\n  ListBox.prototype._getCheckbox = function (e) {\n    var t = this._children;\n    e = this._getElementIndex(e);\n    return this.hostElement && e > -1 && e < t.length ? t[e].querySelector(\"input[type=checkbox]\") : null;\n  };\n  ListBox.prototype._initFromSelect = function (e) {\n    for (var t = e.children, i = [], n = -1, o = 0; o < t.length; o++) {\n      var s = t[o];\n      if (\"OPTION\" == s.tagName) {\n        s.hasAttribute(\"selected\") && (n = i.length);\n        s.innerHTML ? i.push({\n          hdr: s.innerHTML,\n          val: s.getAttribute(\"value\"),\n          cmdParam: s.getAttribute(\"cmd-param\")\n        }) : i.push({\n          hdr: '<div class=\"wj-separator\"></div>'\n        });\n        e.removeChild(s);\n        o--;\n      }\n    }\n    if (i) {\n      this.displayMemberPath = \"hdr\";\n      this.selectedValuePath = \"val\";\n      this.itemsSource = i;\n      this.selectedIndex = n;\n    }\n  };\n  ListBox.prototype._setIsDisabled = function (t) {\n    e.prototype._setIsDisabled.call(this, t);\n    this._updateTabIndex();\n  };\n  ListBox.prototype._setTabOrder = function (t) {\n    e.prototype._setTabOrder.call(this, t);\n    this.isDisabled || this._updateTabIndex();\n  };\n  ListBox.prototype._updateTabIndex = function () {\n    var e = this.hostElement,\n      t = this._getSelectedElement(!0);\n    if (t) {\n      t.tabIndex = this.isDisabled ? -1 : this._orgTabIndex;\n      e.tabIndex = -1;\n    } else e.tabIndex = this.isDisabled ? -1 : this._orgTabIndex;\n  };\n  ListBox._DIDX_KEY = \"$WJ-DIDX\";\n  ListBox._VTHRESH = Number.MAX_VALUE / 2;\n  return ListBox;\n}(Control);\nexport { ListBox };\nvar FormatItemEventArgs = function (e) {\n  __extends(FormatItemEventArgs, e);\n  function FormatItemEventArgs(t, i, n) {\n    var o = e.call(this) || this;\n    o._index = asNumber(t);\n    o._data = i;\n    o._item = asType(n, HTMLElement, !0);\n    return o;\n  }\n  Object.defineProperty(FormatItemEventArgs.prototype, \"index\", {\n    get: function () {\n      return this._index;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(FormatItemEventArgs.prototype, \"data\", {\n    get: function () {\n      return this._data;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(FormatItemEventArgs.prototype, \"item\", {\n    get: function () {\n      return this._item;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  return FormatItemEventArgs;\n}(EventArgs);\nexport { FormatItemEventArgs };\n_addCultureInfo(\"MultiSelectListBox\", {\n  filterPlaceholder: \"Filter\",\n  selectAll: \"Select All\"\n});\nvar MultiSelectListBox = function (e) {\n  __extends(MultiSelectListBox, e);\n  function MultiSelectListBox(t, i) {\n    var n = e.call(this, t) || this;\n    n._selectAllLabel = null;\n    n._filterPlaceholder = null;\n    n._filterText = \"\";\n    n._checkOnFilter = !0;\n    n._delay = Control._SEARCH_DELAY;\n    n.checkedItemsChanged = new Event();\n    n.selectedIndexChanged = new Event();\n    var o = n.getTemplate();\n    n.applyTemplate(\"wj-control wj-content wj-multiselectlistbox\", o, {\n      _selectAll: \"select-all\",\n      _filter: \"filter\",\n      _lbHost: \"list-box\"\n    });\n    n._selectAll.style.display = \"none\";\n    n._filter.style.display = \"none\";\n    n._lbx = new ListBox(n._lbHost, {\n      checkedMemberPath: MultiSelectListBox._DEF_CHECKED_PATH,\n      loadedItems: function () {\n        return n._updateCheckAllCheckbox();\n      },\n      checkedItemsChanged: function (e) {\n        return n.onCheckedItemsChanged(e);\n      },\n      selectedIndexChanged: function () {\n        return n.onSelectedIndexChanged();\n      }\n    });\n    n._cbSelectAll = n._selectAll.querySelector(\"input[type=checkbox]\");\n    n._spSelectAll = n._selectAll.querySelector(\"label>span\");\n    var s = culture.MultiSelectListBox;\n    setText(n._spSelectAll, s.selectAll);\n    n._filter.placeholder = s.filterPlaceholder;\n    n.initialize(i);\n    n.addEventListener(n._filter, \"input\", function () {\n      if (n._filter.value != n._filterText) {\n        n._filterText = n._filter.value;\n        n._toSearch && clearTimeout(n._toSearch);\n        n._toSearch = setTimeout(function () {\n          n._toSearch = null;\n          n._applyFilter();\n        }, n.delay);\n      }\n    });\n    n.addEventListener(n._cbSelectAll, \"click\", function (e) {\n      var t = n._lbx.collectionView;\n      hasItems(t) && (n.checkedItems = e.target.checked ? t.items : []);\n    });\n    n.addEventListener(n.hostElement, \"keydown\", function (e) {\n      var t = n.showFilterInput ? n._filter : null,\n        i = n._lbx;\n      if (t && e.keyCode == Key.F3) {\n        setSelectionRange(t, 0, t.value.length);\n        e.preventDefault();\n      }\n      if (getActiveElement() == t) {\n        var o = !e.altKey;\n        switch (e.keyCode) {\n          case Key.Escape:\n          case Key.F4:\n            o = !1;\n        }\n        o && e.stopPropagation();\n      }\n      if (!i.containsFocus()) switch (e.keyCode) {\n        case Key.Up:\n        case Key.Down:\n          n._lbx.focus();\n          var s = i.selectedIndex + (e.keyCode == Key.Up ? -1 : 1);\n          i.selectedIndex = Math.max(0, s);\n          e.preventDefault();\n      }\n    }, !0);\n    n.hostElement.tabIndex = -1;\n    n._lbx.tabOrder = n._orgTabIndex;\n    return n;\n  }\n  Object.defineProperty(MultiSelectListBox.prototype, \"itemsSource\", {\n    get: function () {\n      return this._lbx.itemsSource;\n    },\n    set: function (e) {\n      this._lbx.itemsSource = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelectListBox.prototype, \"collectionView\", {\n    get: function () {\n      return this._lbx.collectionView;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelectListBox.prototype, \"virtualizationThreshold\", {\n    get: function () {\n      return this._lbx.virtualizationThreshold;\n    },\n    set: function (e) {\n      this._lbx.virtualizationThreshold = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelectListBox.prototype, \"displayMemberPath\", {\n    get: function () {\n      return this._lbx.displayMemberPath;\n    },\n    set: function (e) {\n      this._lbx.displayMemberPath = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelectListBox.prototype, \"isContentHtml\", {\n    get: function () {\n      return this._lbx.isContentHtml;\n    },\n    set: function (e) {\n      this._lbx.isContentHtml = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelectListBox.prototype, \"caseSensitiveSearch\", {\n    get: function () {\n      return this._lbx.caseSensitiveSearch;\n    },\n    set: function (e) {\n      this._lbx.caseSensitiveSearch = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelectListBox.prototype, \"delay\", {\n    get: function () {\n      return this._delay;\n    },\n    set: function (e) {\n      this._delay = asNumber(e, !1, !0);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelectListBox.prototype, \"showGroups\", {\n    get: function () {\n      return this._lbx.showGroups;\n    },\n    set: function (e) {\n      this._lbx.showGroups = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelectListBox.prototype, \"checkOnFilter\", {\n    get: function () {\n      return this._checkOnFilter;\n    },\n    set: function (e) {\n      if (e != this.checkOnFilter) {\n        this._checkOnFilter = asBoolean(e);\n        this.checkedItems = [];\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelectListBox.prototype, \"selectedIndex\", {\n    get: function () {\n      return this._lbx.selectedIndex;\n    },\n    set: function (e) {\n      this._lbx.selectedIndex = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelectListBox.prototype, \"listBox\", {\n    get: function () {\n      return this._lbx;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelectListBox.prototype, \"showFilterInput\", {\n    get: function () {\n      return \"\" == this._filter.style.display;\n    },\n    set: function (e) {\n      if (e != this.showFilterInput) {\n        this._filter.style.display = asBoolean(e) ? \"\" : \"none\";\n        if (!this.showFilterInput) {\n          this._filter.value = \"\";\n          this._applyFilter();\n        }\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelectListBox.prototype, \"filterInputPlaceholder\", {\n    get: function () {\n      return this._filterPlaceholder;\n    },\n    set: function (e) {\n      if (e != this._filterPlaceholder) {\n        this._filterPlaceholder = asString(e);\n        this.refresh();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelectListBox.prototype, \"showSelectAllCheckbox\", {\n    get: function () {\n      return \"\" == this._selectAll.style.display;\n    },\n    set: function (e) {\n      this._selectAll.style.display = asBoolean(e) ? \"\" : \"none\";\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelectListBox.prototype, \"selectAllLabel\", {\n    get: function () {\n      return this._selectAllLabel;\n    },\n    set: function (e) {\n      if (e != this._selectAllLabel) {\n        this._selectAllLabel = asString(e);\n        this.refresh();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelectListBox.prototype, \"checkedMemberPath\", {\n    get: function () {\n      var e = this.listBox.checkedMemberPath;\n      return e != MultiSelectListBox._DEF_CHECKED_PATH ? e : null;\n    },\n    set: function (e) {\n      e = asString(e);\n      this.listBox.checkedMemberPath = e || MultiSelectListBox._DEF_CHECKED_PATH;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelectListBox.prototype, \"checkedItems\", {\n    get: function () {\n      return this.listBox.checkedItems;\n    },\n    set: function (e) {\n      this.listBox.checkedItems = asArray(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  MultiSelectListBox.prototype.onCheckedItemsChanged = function (e) {\n    var t = this;\n    this._updateCheckAllCheckbox();\n    this.checkedItemsChanged.raise(this, e);\n    \"object\" == typeof e._items[0] && (this.checkedMemberPath || MultiSelectListBox._DEF_CHECKED_PATH) in e._items[0] && setTimeout(function () {\n      t._lbx._updateCheckedList(t.checkedItems);\n    }, 0);\n  };\n  MultiSelectListBox.prototype.onSelectedIndexChanged = function (e) {\n    this.selectedIndexChanged.raise(this, e);\n  };\n  MultiSelectListBox.prototype.refresh = function (t) {\n    void 0 === t && (t = !0);\n    e.prototype.refresh.call(this, t);\n    if (this.hostElement) {\n      var i = culture.MultiSelectListBox;\n      this._filter.placeholder = null != this._filterPlaceholder ? this._filterPlaceholder : i.filterPlaceholder;\n      this._spSelectAll && setText(this._spSelectAll, null != this._selectAllLabel ? this._selectAllLabel : i.selectAll);\n      this._updateCheckAllCheckbox();\n    }\n  };\n  MultiSelectListBox.prototype.dispose = function () {\n    this.listBox.dispose();\n    e.prototype.dispose.call(this);\n  };\n  MultiSelectListBox.prototype._applyFilter = function () {\n    var e = this,\n      t = this._lbx,\n      i = t.collectionView,\n      n = this._filter.value,\n      o = n ? new RegExp(escapeRegExp(n), t.caseSensitiveSearch ? \"\" : \"i\") : null,\n      s = this.displayMemberPath,\n      r = s ? new Binding(s) : null,\n      a = this.checkOnFilter ? null : this.checkedItems;\n    i.filter = function (t) {\n      if (null != o) {\n        if (a && a.indexOf(t) > -1) return !0;\n        r && (t = r.getValue(t));\n        e.isContentHtml && (t = toPlainText(t));\n        return null != t && o.test(t.toString());\n      }\n      return !0;\n    };\n    t.selectedIndex = Math.max(0, t.selectedIndex);\n    this._checkOnFilter && (this.checkedItems = o ? i.items : []);\n  };\n  MultiSelectListBox.prototype._updateCheckAllCheckbox = function () {\n    var e = this._lbx.collectionView,\n      t = this._cbSelectAll;\n    if (hasItems(e)) {\n      var i = e.items.length,\n        n = this.checkedItems.length;\n      setChecked(t, n == i || 0 != n && null);\n      t.disabled = !1;\n    } else {\n      setChecked(t, !1);\n      t.checked = !1;\n      t.disabled = !0;\n    }\n  };\n  MultiSelectListBox.prototype._setIsDisabled = function (t) {\n    e.prototype._setIsDisabled.call(this, t);\n    this.hostElement.tabIndex = -1;\n    this.isDisabled ? this._lbx.tabOrder = -1 : this._lbx.tabOrder = this._orgTabIndex;\n  };\n  MultiSelectListBox.prototype._setTabOrder = function (e) {\n    this._orgTabIndex = e;\n    this._lbx.tabOrder = e;\n  };\n  MultiSelectListBox.prototype.tryForceClearDelayAndFilter = function () {\n    var e = this;\n    if (this._toSearch) {\n      var t = this._delay;\n      this._filterText = this._filter.value;\n      this._toSearch && clearTimeout(this._toSearch);\n      this._toSearch = setTimeout(function () {\n        e._toSearch = null;\n        e._applyFilter();\n      }, 0);\n      this._delay = t;\n    }\n  };\n  MultiSelectListBox.prototype.onLostFocus = function () {\n    this.tryForceClearDelayAndFilter();\n    e.prototype.onLostFocus.call(this);\n  };\n  MultiSelectListBox._DEF_CHECKED_PATH = \"$checked\";\n  MultiSelectListBox.controlTemplate = '<div class=\"wj-template wj-listbox\"><input wj-part=\"filter\" class=\"wj-form-control\" tabindex=\"-1\"><div wj-part=\"select-all\" class=\"wj-header wj-select-all wj-listbox-item\"><label><input type=\"checkbox\" tabindex=\"-1\"> <span></span></label></div><div wj-part=\"list-box\"/></div>';\n  return MultiSelectListBox;\n}(Control);\nexport { MultiSelectListBox };\n_addCultureInfo(\"Calendar\", {\n  ariaLabels: {\n    calendar: \"Calendar\",\n    monthView: \"Month View\",\n    yearView: \"Year View\",\n    prvMo: \"Previous Month\",\n    today: \"Select Today\",\n    nxtMo: \"Next Month\",\n    prvYr: \"Previous Year\",\n    currMo: \"Current Month\",\n    nxtYr: \"Next Year\"\n  }\n});\nexport var DateSelectionMode;\n!function (e) {\n  e[e.None = 0] = \"None\";\n  e[e.Day = 1] = \"Day\";\n  e[e.Month = 2] = \"Month\";\n  e[e.Range = 3] = \"Range\";\n}(DateSelectionMode || (DateSelectionMode = {}));\nexport var ShowMonthPicker;\n!function (e) {\n  e[e.None = 0] = \"None\";\n  e[e.FirstMonth = 1] = \"FirstMonth\";\n  e[e.LastMonth = 2] = \"LastMonth\";\n  e[e.FirstAndLastMonths = 3] = \"FirstAndLastMonths\";\n  e[e.AllMonths = 4] = \"AllMonths\";\n  e[e.Outside = 5] = \"Outside\";\n}(ShowMonthPicker || (ShowMonthPicker = {}));\nvar Calendar = function (e) {\n  __extends(Calendar, e);\n  function Calendar(t, i) {\n    var n = e.call(this, t) || this;\n    n._yrPicker = !0;\n    n._mtPicker = ShowMonthPicker.FirstMonth;\n    n._wksBefore = 0;\n    n._wksAfter = 0;\n    n._rngMin = 0;\n    n._rngMax = 0;\n    n._min = null;\n    n._max = null;\n    n._readOnly = !1;\n    n._handleWheel = !0;\n    n._fdw = null;\n    n._selMode = DateSelectionMode.Day;\n    n._tmYrHidden = 0;\n    n._fmtYrMo = \"y\";\n    n._fmtYr = \"yyyy\";\n    n._fmtDayHdr = \"ddd\";\n    n._fmtDay = \"d \";\n    n._fmtMonths = \"MMM\";\n    n.valueChanged = new Event();\n    n.rangeEndChanged = new Event();\n    n.rangeChanged = new Event();\n    n.displayMonthChanged = new Event();\n    n.formatItem = new Event(function () {\n      n.invalidate();\n    });\n    n._value = n._rngEnd = DateTime.newDate();\n    n._month = n._getMonth(n._value);\n    n._cals = [n];\n    n._createChildren();\n    n._createYearPicker();\n    var o = n.hostElement,\n      s = n.addEventListener.bind(n);\n    s(o, \"keydown\", n._keydown.bind(n));\n    s(o, \"click\", n._click.bind(n));\n    n._rptUp = new _ClickRepeater(n._btnPrv);\n    n._rptDn = new _ClickRepeater(n._btnNxt);\n    n.addEventListener(o, \"wheel\", function (e) {\n      if (n.handleWheel && !e.defaultPrevented && !n.isReadOnly && n.containsFocus()) {\n        e.deltaY < 0 ? n._btnPrv.click() : n._btnNxt.click();\n        e.preventDefault();\n      }\n    });\n    n.initialize(i);\n    n.refresh(!0);\n    return n;\n  }\n  Object.defineProperty(Calendar.prototype, \"value\", {\n    get: function () {\n      return this._value;\n    },\n    set: function (e) {\n      if (e !== this._value) {\n        this._clearingRangeEnd = !DateTime.equals(this._value, e);\n        this.rangeEnd = null;\n        this._clearingRangeEnd = !1;\n        e = asDate(e, !0);\n        e = this._clamp(e);\n        if (this._valid(e) || null == e) {\n          this.ensureVisible(e || new Date());\n          if (!DateTime.equals(this._value, e)) {\n            this._value = e;\n            this.invalidate(!1);\n            this.onValueChanged();\n          }\n        }\n        if (!this.value) {\n          var t = this.min,\n            i = this.max,\n            n = this.displayMonth;\n          i && i < n ? this.ensureVisible(i) : t && t > n && this.ensureVisible(t);\n        }\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"rangeEnd\", {\n    get: function () {\n      return this._rngEnd;\n    },\n    set: function (e) {\n      e = asDate(e, !0);\n      if ((e = this._clamp(e)) && this._value && this._rngMode()) {\n        e < this._value && (e = this._value);\n        var t = this._rngMin,\n          i = this._rngMax;\n        if (t && t > 0 || i && i > 0) {\n          var n = this._value,\n            o = Math.ceil((e.getTime() - n.getTime()) / 864e5) + 1;\n          t && t > 0 && o < t && (e = DateTime.addDays(n, t - 1));\n          i && i > 0 && o > i && (e = DateTime.addDays(n, i - 1));\n        }\n      }\n      if ((this._valid(e) || null == e) && !DateTime.equals(this._rngEnd, e)) {\n        this._rngEnd = e;\n        this.ensureVisible(e);\n        this.invalidate(!1);\n        this._clearingRangeEnd || this.onRangeEndChanged();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"rangeMin\", {\n    get: function () {\n      return this._rngMin;\n    },\n    set: function (e) {\n      if ((e = asNumber(e, !0, !0)) != this._rngMin) {\n        this._rngMin = e;\n        this._syncProp(this, \"rangeMin\");\n        this._rngMode() && this._rngEnd && (this.rangeEnd = this._rngEnd);\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"rangeMax\", {\n    get: function () {\n      return this._rngMax;\n    },\n    set: function (e) {\n      if ((e = asNumber(e, !0, !0)) != this._rngMax) {\n        this._rngMax = e;\n        this._syncProp(this, \"rangeMax\");\n        this._rngMode() && this._rngEnd && (this.rangeEnd = this._rngEnd);\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"min\", {\n    get: function () {\n      return this._min;\n    },\n    set: function (e) {\n      if ((e = asDate(e, !0)) != this.min) {\n        this._min = e;\n        this._syncProp(this, \"min\");\n        this.refresh();\n        !this.value && e && e > this.displayMonth && this.ensureVisible(e);\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"max\", {\n    get: function () {\n      return this._max;\n    },\n    set: function (e) {\n      if ((e = asDate(e, !0)) != this.max) {\n        this._max = e;\n        this._syncProp(this, \"max\");\n        this.refresh();\n        !this.value && e && e < this.displayMonth && this.ensureVisible(e);\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"selectionMode\", {\n    get: function () {\n      return this._selMode;\n    },\n    set: function (e) {\n      var t = DateSelectionMode;\n      if ((e = asEnum(e, t)) != this._selMode) {\n        this._selMode = e;\n        this._mthMode() && (this.monthView = !1);\n        this._rngEnd = e == t.Range ? this._value : null;\n        this.refresh();\n        this._syncProp(this, \"selectionMode\");\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"isReadOnly\", {\n    get: function () {\n      return this._readOnly;\n    },\n    set: function (e) {\n      this._readOnly = asBoolean(e);\n      toggleClass(this.hostElement, \"wj-state-readonly\", this.isReadOnly);\n      this._syncProp(this, \"isReadOnly\");\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"handleWheel\", {\n    get: function () {\n      return this._handleWheel;\n    },\n    set: function (e) {\n      this._handleWheel = asBoolean(e);\n      this._syncProp(this, \"handleWheel\");\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"repeatButtons\", {\n    get: function () {\n      return !this._rptUp.disabled;\n    },\n    set: function (e) {\n      this._rptUp.disabled = this._rptDn.disabled = !asBoolean(e);\n      this._syncProp(this, \"repeatButtons\");\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"showYearPicker\", {\n    get: function () {\n      return this._yrPicker;\n    },\n    set: function (e) {\n      if (e != this._yrPicker) {\n        this._yrPicker = asBoolean(e);\n        this._syncProp(this, \"showYearPicker\");\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"showMonthPicker\", {\n    get: function () {\n      return this._mtPicker;\n    },\n    set: function (e) {\n      if (e != this._mtPicker) {\n        var t = ShowMonthPicker;\n        isBoolean(e) && (e = e ? t.FirstMonth : t.None);\n        this._mtPicker = asEnum(e, t);\n        toggleClass(this.hostElement, \"wj-btns-outside\", this._getShowMonthPicker() == t.Outside);\n        this.refresh();\n        this._syncProp(this, \"showMonthPicker\");\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"firstDayOfWeek\", {\n    get: function () {\n      return this._fdw;\n    },\n    set: function (e) {\n      if (e != this._fdw) {\n        if ((e = asNumber(e, !0)) && (e > 6 || e < 0)) throw \"firstDayOfWeek must be between 0 and 6 (Sunday to Saturday).\";\n        this._fdw = e;\n        this.refresh();\n        this._syncProp(this, \"firstDayOfWeek\");\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"displayMonth\", {\n    get: function () {\n      return this._month;\n    },\n    set: function (e) {\n      e = asDate(e);\n      e = this._getMonth(e);\n      var t = this._getDisplayMonthRange();\n      t.to && e > t.to && (e = t.to);\n      t.from && e < t.from && (e = t.from);\n      if (!DateTime.equals(this.displayMonth, e)) {\n        this._month = e;\n        this.invalidate(!0);\n        this.onDisplayMonthChanged();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"monthCount\", {\n    get: function () {\n      var e = this.hostElement;\n      return e ? e.querySelectorAll(\".wj-calendar\").length + 1 : 0;\n    },\n    set: function (e) {\n      var t = this,\n        i = this.hostElement;\n      if (e != this.monthCount && i) {\n        var n = i.querySelectorAll(\".wj-calendar\");\n        e = asInt(e, !1);\n        assert(e > 0, \"monthCount must be >= 1.\");\n        assert(1 == e || !closest(i.parentElement, \".wj-calendar\"), \"Only top-level calendars can set monthCount.\");\n        for (var o = 0; o < n.length; o++) {\n          var s = n[o];\n          removeChild(s);\n          this._getCalendar(s).dispose();\n        }\n        this._cals = [this];\n        for (o = 1; o < e; o++) {\n          (s = new Calendar(document.createElement(\"div\"), {\n            itemFormatter: this.itemFormatter,\n            itemValidator: this.itemValidator,\n            formatItem: function (e, i) {\n              return t.onFormatItem(i);\n            }\n          }))._selMode = this._selMode;\n          s._value = this._value;\n          s._rngEnd = this._rngEnd;\n          for (var r in this) if (!/^(_.*|constructor|displayMonth|monthCount|hostElement|rightToLeft|isUpdating|isTouching)$/.test(r)) {\n            var a = this[r];\n            isFunction(a) || a instanceof Event || (s[r] = a);\n          }\n          this._cals.push(s);\n          i.appendChild(s.hostElement);\n        }\n        toggleClass(i, \"wj-calendar-multimonth\", e > 1);\n        this._syncProp(this, \"displayMonth\");\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"formatYearMonth\", {\n    get: function () {\n      return this._fmtYrMo;\n    },\n    set: function (e) {\n      if (e != this._fmtYrMo) {\n        this._fmtYrMo = asString(e);\n        this._syncProp(this, \"formatYearMonth\");\n        this.invalidate();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"formatDayHeaders\", {\n    get: function () {\n      return this._fmtDayHdr;\n    },\n    set: function (e) {\n      if (e != this._fmtDayHdr) {\n        this._fmtDayHdr = asString(e);\n        this._syncProp(this, \"formatDayHeaders\");\n        this.invalidate();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"formatDays\", {\n    get: function () {\n      return this._fmtDay;\n    },\n    set: function (e) {\n      if (e != this._fmtDay) {\n        this._fmtDay = asString(e);\n        this._syncProp(this, \"formatDays\");\n        this.invalidate();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"formatYear\", {\n    get: function () {\n      return this._fmtYr;\n    },\n    set: function (e) {\n      if (e != this._fmtYr) {\n        this._fmtYr = asString(e);\n        this._syncProp(this, \"formatYear\");\n        this.invalidate();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"formatMonths\", {\n    get: function () {\n      return this._fmtMonths;\n    },\n    set: function (e) {\n      if (e != this._fmtMonths) {\n        this._fmtMonths = asString(e);\n        this._syncProp(this, \"formatMonths\");\n        this.invalidate();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"showHeader\", {\n    get: function () {\n      return \"none\" != this._tbHdr.style.display;\n    },\n    set: function (e) {\n      if (e != this.showHeader) {\n        this._tbHdr.style.display = asBoolean(e) ? \"\" : \"none\";\n        this._syncProp(this, \"showHeader\");\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"monthView\", {\n    get: function () {\n      return \"none\" != this._tbMth.style.display;\n    },\n    set: function (e) {\n      if (e != this.monthView) {\n        this._tbMth.style.display = e ? \"\" : \"none\";\n        this._tbYr.style.display = e ? \"none\" : \"\";\n        this.refresh();\n        var t = culture.Calendar.ariaLabels;\n        setAriaLabel(this._btnPrv, e ? t.prvMo : t.prvYr);\n        setAriaLabel(this._btnTdy, e ? t.today : t.currMo);\n        setAriaLabel(this._btnNxt, e ? t.nxtMo : t.nxtYr);\n        setAriaLabel(this._btnMth, e ? t.monthView : t.yearView);\n        this._syncProp(this, \"monthView\");\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"weeksBefore\", {\n    get: function () {\n      return this._wksBefore;\n    },\n    set: function (e) {\n      if (e != this._wksBefore) {\n        this._wksBefore = Math.floor(asNumber(e, !1, !0));\n        this._syncProp(this, \"weeksBefore\");\n        this.invalidate();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"weeksAfter\", {\n    get: function () {\n      return this._wksAfter;\n    },\n    set: function (e) {\n      if (e != this._wksAfter) {\n        this._wksAfter = Math.floor(asNumber(e, !1, !0));\n        this._syncProp(this, \"weeksAfter\");\n        this.invalidate();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"itemFormatter\", {\n    get: function () {\n      return this._itemFormatter;\n    },\n    set: function (e) {\n      if (e != this._itemFormatter) {\n        this._itemFormatter = asFunction(e);\n        this._syncProp(this, \"itemFormatter\");\n        this.invalidate();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Calendar.prototype, \"itemValidator\", {\n    get: function () {\n      return this._itemValidator;\n    },\n    set: function (e) {\n      if (e != this._itemValidator) {\n        this._itemValidator = asFunction(e);\n        this._syncProp(this, \"itemValidator\");\n        this.invalidate();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Calendar.prototype.hitTest = function (e) {\n    var t = e instanceof MouseEvent ? e.target : e instanceof Element ? e : null;\n    assert(null != t, \"MouseEvent or Element expected\");\n    return t ? t[Calendar._DATE_KEY] : null;\n  };\n  Calendar.prototype.ensureVisible = function (e) {\n    if (null != e) {\n      var t = this._getCalendars(),\n        i = t.indexOf(this),\n        n = t[0],\n        o = t[t.length - 1];\n      e < n.displayMonth ? this.displayMonth = DateTime.addMonths(this._getMonth(e), i) : e > o.displayMonth && (this.displayMonth = DateTime.addMonths(this._getMonth(e), i - t.length + 1));\n    }\n  };\n  Calendar.prototype.onValueChanged = function (e) {\n    this.valueChanged.raise(this, e);\n    this._syncProp(this, \"value\");\n  };\n  Calendar.prototype.onRangeEndChanged = function (e) {\n    this.rangeEndChanged.raise(this, e);\n    this._syncProp(this, \"rangeEnd\");\n    this._value && this._rngEnd && this.onRangeChanged(e);\n  };\n  Calendar.prototype.onRangeChanged = function (e) {\n    this.rangeChanged.raise(this, e);\n  };\n  Calendar.prototype.onDisplayMonthChanged = function (e) {\n    this.displayMonthChanged.raise(this, e);\n    this._syncProp(this, \"displayMonth\");\n  };\n  Calendar.prototype.onFormatItem = function (e) {\n    this.formatItem.raise(this, e);\n  };\n  Calendar.prototype._containsFocusImpl = function (t) {\n    return e.prototype._containsFocusImpl.call(this, t) || this._lbYears._containsFocusImpl(t);\n  };\n  Calendar.prototype.dispose = function () {\n    this._rptUp.element = null;\n    this._rptDn.element = null;\n    this._lbYears.dispose();\n    e.prototype.dispose.call(this);\n  };\n  Calendar.prototype.refresh = function (t) {\n    void 0 === t && (t = !0);\n    var i = this.hostElement,\n      n = this.containsFocus();\n    if (i) {\n      e.prototype.refresh.call(this, t);\n      t && this._updateContent();\n      this._updateSelection();\n      var o = this._getDisplayMonthRange(),\n        s = this.displayMonth;\n      enable(this._btnPrv, null == o.from || s > o.from);\n      enable(this._btnNxt, null == o.to || s < o.to);\n      if (n) {\n        var r = (this.monthView ? this._tbMth : this._tbYr).querySelector(\"td.wj-state-selected\") || i;\n        r && r.focus();\n      }\n      var a = this._getCalendars();\n      a.length > 1 && this == a[0] && a.forEach(function (e, i) {\n        i > 0 && e.refresh(t);\n      });\n    }\n  };\n  Calendar.prototype._getShowMonthPicker = function () {\n    var e = ShowMonthPicker,\n      t = this._getCalendars(),\n      i = t.indexOf(this),\n      n = this.showMonthPicker;\n    switch (n) {\n      case e.FirstMonth:\n      case e.Outside:\n        return 0 == i ? n : 0;\n      case e.LastMonth:\n        return i == t.length - 1 ? n : 0;\n      case e.FirstAndLastMonths:\n        return 0 == i || i == t.length - 1 ? n : 0;\n      case e.AllMonths:\n        return n;\n    }\n    return 0;\n  };\n  Calendar.prototype._getDisplayMonthRange = function () {\n    var e = {\n      from: null,\n      to: null\n    };\n    if (this.min || this.max) {\n      var t = this._getCalendars(),\n        i = t.indexOf(this),\n        n = this._mthMode() ? DateTime.addYears : DateTime.addMonths;\n      this.min && (e.from = n(this._getMonth(this.min), i));\n      this.max && (e.to = n(this._getMonth(this.max), i - t.length + 1));\n    }\n    return e;\n  };\n  Calendar.prototype._getCalendar = function (e) {\n    return Control.getControl(e);\n  };\n  Calendar.prototype._getCalendars = function () {\n    var e = closest(this.hostElement, \".wj-calendar-multimonth\");\n    return (e ? this._getCalendar(e) : this)._cals;\n  };\n  Calendar.prototype._syncProp = function (e, t) {\n    var i = this;\n    if (!this._syncing) {\n      var n = this._getCalendars();\n      if (n && n.length > 1) {\n        var o = e[t],\n          s = this._mthMode() ? DateTime.addYears : DateTime.addMonths;\n        \"displayMonth\" == t && (o = s(o, -n.indexOf(e)));\n        n[0].deferUpdate(function () {\n          i._syncing = !0;\n          n.forEach(function (n, r) {\n            if (n != e) {\n              var a = n.displayMonth;\n              n[t] = \"displayMonth\" == t ? s(o, r) : o;\n              if (\"value\" == t) {\n                n.displayMonth = a;\n                i._rngMode() && (n.rangeEnd = null);\n              }\n            }\n          });\n          i._syncing = !1;\n        });\n      }\n    }\n  };\n  Calendar.prototype._updateContent = function () {\n    var e = this.displayMonth,\n      t = Globalize.format,\n      i = DateTime,\n      n = this._getShowMonthPicker();\n    setText(this._spMth, t(e, this._fmtYrMo));\n    var o = this._btnMth.querySelector(\".wj-glyph-down\");\n    o && (o.style.display = this._mthMode() || !n ? \"none\" : \"\");\n    var s = closest(this._btnTdy, \".wj-btn-group\");\n    s && (s.style.display = n ? \"\" : \"none\");\n    for (var r = null != this._fdw ? this._fdw : Globalize.getFirstDayOfWeek(), a = i.addDays(e, -(e.getDay() - r + 7) % 7), l = i.monthLast(e), h = this._tbMth.querySelectorAll(\"td\"), u = 0; u < 7 && u < h.length; u++) {\n      var c = i.addDays(a, u);\n      setText(h[u], t(c, this._fmtDayHdr));\n    }\n    var p = this._tbMth.querySelectorAll(\"tr\");\n    for (u = 1; u < p.length; u++) removeChild(p[u]);\n    var d = i.addDays(a, -7 * this._wksBefore);\n    for (u = 0; u < this._wksBefore; u++) d = this._addWeek(d, \"wj-week-before\");\n    for (; d <= l;) d = this._addWeek(d);\n    for (u = 0; u < this._wksAfter; u++) d = this._addWeek(d, \"wj-week-after\");\n    (h = this._tbYr.querySelectorAll(\"td\")).length && setText(h[0], t(e, this._fmtYr));\n    for (u = 1; u < h.length; u++) {\n      d = i.newDate(e.getFullYear(), u - 1, 1);\n      var f = h[u],\n        _ = !this._monthInValidRange(d);\n      f[Calendar._DATE_KEY] = d;\n      setText(f, t(d, this._fmtMonths));\n      toggleClass(f, \"wj-state-disabled\", _);\n      setAriaLabel(f, Globalize.format(d, \"MMMM yyyy\"));\n    }\n  };\n  Calendar.prototype._updateSelection = function () {\n    for (var e = Calendar._DATE_KEY, t = DateTime, i = this._tbMth.querySelectorAll(\"td\"), n = 7; n < i.length; n++) {\n      var o = (u = i[n])[e],\n        s = this.value,\n        r = this.rangeEnd,\n        a = this._selMode && null != s && t.sameDate(o, s),\n        l = this._selMode && null != s && t.sameDate(o, r),\n        h = this._selMode && null != s && o > s && null != r && o <= r;\n      toggleClass(u, \"wj-state-selected\", a);\n      toggleClass(u, \"wj-state-multi-selected\", h);\n      toggleClass(u, \"wj-state-last-selected\", l);\n      setAttribute(u, \"aria-selected\", !!a || null);\n      this._customizeCell(n, o, u);\n    }\n    i = this._tbYr.querySelectorAll(\"td\");\n    for (n = 0; n < i.length; n++) {\n      var u;\n      o = (u = i[n])[e], a = this._sameMonth(o, this.value);\n      toggleClass(u, \"wj-state-selected\", a);\n      setAttribute(u, \"aria-selected\", !!a || null);\n    }\n  };\n  Calendar.prototype._addWeek = function (e, t) {\n    for (var i = this._createElement(\"tr\", this._tbMth, t), n = DateTime, o = 0; o < 7; o++) {\n      var s = this._createElement(\"td\", i),\n        r = n.addDays(e, o);\n      s[Calendar._DATE_KEY] = r;\n      setText(s, Globalize.format(r, this._fmtDay));\n      setAriaLabel(s, Globalize.format(r, \"D\"));\n      var a = !this._valid(r),\n        l = r.getDay(),\n        h = r.getMonth() != this.displayMonth.getMonth();\n      toggleClass(s, \"wj-day-today\", n.sameDate(r, n.newDate()));\n      toggleClass(s, \"wj-day-weekend\", 0 == l || 6 == l);\n      toggleClass(s, \"wj-day-othermonth\", h || !this._inValidRange(r) || a);\n      toggleClass(s, \"wj-state-invalid\", a);\n    }\n    return n.addDays(e, 7);\n  };\n  Calendar.prototype._customizeCell = function (e, t, i) {\n    isFunction(this.itemFormatter) && this.itemFormatter(t, i);\n    if (this.formatItem.hasHandlers) {\n      var n = new FormatItemEventArgs(e, t, i);\n      this.onFormatItem(n);\n    }\n  };\n  Calendar.prototype._canChangeValue = function () {\n    return !this._readOnly && this._selMode != DateSelectionMode.None;\n  };\n  Calendar.prototype._valid = function (e) {\n    return !(!isDate(e) || !DateTime.sameDate(e, this._clamp(e))) && (!isFunction(this.itemValidator) || this.itemValidator(e));\n  };\n  Calendar.prototype._inValidRange = function (e) {\n    var t = DateTime.fromDateTime;\n    return !(this.min && e < t(this.min, e)) && !(this.max && e > t(this.max, e));\n  };\n  Calendar.prototype._monthInValidRange = function (e) {\n    if (this.min || this.max) {\n      var t = e.getFullYear(),\n        i = e.getMonth(),\n        n = DateTime,\n        o = n.newDate(t, i, 1),\n        s = n.newDate(t, i + 1, 0);\n      if (this.min && this.min > s) return !1;\n      if (this.max && this.max < o) return !1;\n    }\n    return !0;\n  };\n  Calendar.prototype._sameMonth = function (e, t) {\n    return isDate(e) && isDate(t) && e.getMonth() == t.getMonth() && e.getFullYear() == t.getFullYear();\n  };\n  Calendar.prototype._getValidDate = function (e, t) {\n    if (isDate(e)) for (var i = e.getFullYear(), n = e.getMonth() + (t ? 0 : 1), o = t ? 1 : 0, s = DateTime, r = s.newDate(i, n, o), a = t ? 1 : -1, l = 0; l < 31; l++) {\n      if (this._valid(r)) return r;\n      r = s.addDays(r, a);\n    }\n    return null;\n  };\n  Calendar.prototype._clamp = function (e) {\n    if (e) {\n      var t = DateTime.fromDateTime;\n      if (this.min) {\n        var i = t(this.min, e);\n        e < i && (e = i);\n      }\n      if (this.max) {\n        var n = t(this.max, e);\n        e > n && (e = n);\n      }\n    }\n    return e;\n  };\n  Calendar.prototype._createChildren = function () {\n    var e = this.getTemplate();\n    this.applyTemplate(\"wj-control wj-calendar\", e, {\n      _tbHdr: \"tbl-header\",\n      _btnMth: \"btn-month\",\n      _spMth: \"span-month\",\n      _btnPrv: \"btn-prev\",\n      _btnTdy: \"btn-today\",\n      _btnNxt: \"btn-next\",\n      _tbMth: \"tbl-month\",\n      _tbYr: \"tbl-year\"\n    });\n    this._tbYr.style.display = \"none\";\n    var t = culture.Calendar.ariaLabels;\n    setAriaLabel(this._tbMth, t.calendar);\n    setAriaLabel(this._tbYr, t.calendar);\n    setAriaLabel(this._btnPrv, t.calendar);\n    setAriaLabel(this._btnMth, t.monthView);\n    setAriaLabel(this._btnPrv, t.prvMo);\n    setAriaLabel(this._btnTdy, t.today);\n    setAriaLabel(this._btnNxt, t.nxtMo);\n    for (var i = this._createElement(\"tr\", this._tbMth, \"wj-header\"), n = 0; n < 7; n++) this._createElement(\"td\", i);\n    i = this._createElement(\"tr\", this._tbYr, \"wj-header\");\n    this._createElement(\"td\", i).setAttribute(\"colspan\", \"4\");\n    for (var o = 0; o < 3; o++) {\n      i = this._createElement(\"tr\", this._tbYr);\n      for (var s = 0; s < 4; s++) this._createElement(\"td\", i);\n    }\n  };\n  Calendar.prototype._createYearPicker = function () {\n    var e = this,\n      t = this.hostElement,\n      i = this._createElement(\"div\", null, \"wj-dropdown-panel wj-yearpicker\");\n    i.tabIndex = this._orgTabIndex;\n    this._lbYears = new ListBox(i, {\n      lostFocus: function (t) {\n        hidePopup(i);\n        e._tmYrHidden = Date.now();\n        e.removeEventListener(window, \"touchstart\");\n        if (t.selectedIndex > -1) {\n          var n = DateTime.clone(e.displayMonth);\n          n.setFullYear(t.selectedIndex + t.itemsSource[0]);\n          e.displayMonth = n;\n        }\n      }\n    });\n    this.addEventListener(i, \"keydown\", function (i) {\n      switch (i.keyCode) {\n        case Key.Enter:\n          t.focus();\n          break;\n        case Key.Escape:\n          e._lbYears.selectedIndex = -1;\n          t.focus();\n      }\n      i.defaultPrevented && i.stopPropagation();\n    });\n    this.addEventListener(i, \"click\", function (e) {\n      t.focus();\n    });\n  };\n  Calendar.prototype._createElement = function (e, t, i) {\n    var n = document.createElement(e);\n    i && addClass(n, i);\n    t && t.appendChild(n);\n    return n;\n  };\n  Calendar.prototype._click = function (e) {\n    var t = this;\n    if (!e.defaultPrevented && 0 == e.button) {\n      var i = !1,\n        n = e.target;\n      if (contains(this._btnMth, n) && !this._mthMode() && this._getShowMonthPicker()) {\n        this.monthView = !this.monthView;\n        i = !0;\n      } else if (contains(this._btnPrv, n)) {\n        this._navigate(-1);\n        i = !0;\n      } else if (contains(this._btnNxt, n)) {\n        this._navigate(1);\n        i = !0;\n      } else if (contains(this._btnTdy, n)) {\n        this._navigate(0);\n        i = !0;\n      }\n      if (n && !i && this._yrPicker && contains(this._tbYr, n) && closest(n, \".wj-header\")) {\n        if (Date.now() - this._tmYrHidden < 600) {\n          e.preventDefault();\n          return;\n        }\n        for (var o = this.displayMonth.getFullYear(), s = this.min ? this.min.getFullYear() : o - 100, r = this.max ? this.max.getFullYear() : o + 100, a = [], l = s; l <= r; l++) a.push(l);\n        var h = this._lbYears,\n          u = h.hostElement,\n          c = closest(n, \".wj-header\"),\n          p = this.hostElement,\n          d = closest(p, \".wj-inputdate-dropdown\") || p;\n        h.itemsSource = a;\n        h.selectedIndex = o - a[0];\n        setAttribute(u, \"dir\", this.rightToLeft ? \"rtl\" : null);\n        setCss(u, {\n          minWidth: \"\",\n          width: c.offsetWidth\n        });\n        showPopup(u, c, !1, !1, d);\n        requestAnimationFrame(function () {\n          h.showSelection(!0);\n        });\n        this.addEventListener(window, \"touchstart\", function (e) {\n          if (!contains(u, e.target)) {\n            hidePopup(u);\n            t._tmYrHidden = Date.now();\n            t.removeEventListener(window, \"touchstart\");\n          }\n        });\n        e.preventDefault();\n        return;\n      }\n      if (n && !i) {\n        var f = closest(n, \"td\");\n        if (f) {\n          var _ = this.hitTest(f),\n            m = DateTime.fromDateTime;\n          if (this.monthView) {\n            if (_ && this._canChangeValue()) {\n              var g = m(_, this._value);\n              this._inValidRange(g) && this._valid(g) && (this._rngMode() && this.value && !this.rangeEnd && g >= this.value ? this.rangeEnd = g : this.value = g);\n              i = !0;\n            }\n          } else if (_) {\n            this.displayMonth = _;\n            if (this._mthMode()) {\n              if (this._canChangeValue()) {\n                g = m(this.displayMonth, this.value);\n                this._inValidRange(g) && (this.value = g);\n              }\n            } else this.monthView = !0;\n            i = !0;\n          }\n        }\n      }\n      if (i) {\n        e.preventDefault();\n        this.focus();\n      }\n    }\n  };\n  Calendar.prototype._keydown = function (e) {\n    if (!e.defaultPrevented) {\n      if (e.altKey) switch (e.keyCode) {\n        case Key.Up:\n        case Key.Down:\n          return;\n        case Key.End:\n          this._navigate(0);\n          e.preventDefault();\n          return;\n      }\n      if (!(e.ctrlKey || e.metaKey || e.shiftKey && !this._rngMode())) {\n        var t = this._getKeyCode(e),\n          i = 0,\n          n = 0,\n          o = !0;\n        if (this.monthView) switch (t) {\n          case Key.Left:\n            i = -1;\n            break;\n          case Key.Right:\n            i = 1;\n            break;\n          case Key.Up:\n            i = -7;\n            break;\n          case Key.Down:\n            i = 7;\n            break;\n          case Key.PageDown:\n            n = e.altKey ? 12 : 1;\n            break;\n          case Key.PageUp:\n            n = e.altKey ? -12 : -1;\n            break;\n          case Key.Home:\n          case Key.End:\n            if (this._canChangeValue() && !e.shiftKey) {\n              var s = this.value || this.displayMonth;\n              if (a = this._getValidDate(s, t == Key.Home)) {\n                this.value = DateTime.fromDateTime(a, this.value);\n                this._rngEnd = null;\n              }\n            }\n            break;\n          default:\n            o = !1;\n        } else switch (t) {\n          case Key.Left:\n            n = -1;\n            break;\n          case Key.Right:\n            n = 1;\n            break;\n          case Key.Up:\n            n = -4;\n            break;\n          case Key.Down:\n            n = 4;\n            break;\n          case Key.PageDown:\n            n = e.altKey ? 120 : 12;\n            break;\n          case Key.PageUp:\n            n = e.altKey ? -120 : -12;\n            break;\n          case Key.Home:\n            n = this.value ? -this.value.getMonth() : 0;\n            break;\n          case Key.End:\n            n = this.value ? 11 - this.value.getMonth() : 0;\n            break;\n          case Key.Enter:\n            this._mthMode() ? o = !1 : this.monthView = !0;\n            break;\n          default:\n            o = !1;\n        }\n        if (this._canChangeValue() && (i || n)) {\n          var r = e.shiftKey && null != this.rangeEnd ? this.rangeEnd : this.value,\n            a = DateTime;\n          if (r) {\n            r = a.addDays(r, i);\n            r = a.addMonths(r, n);\n          } else r = this._getValidDate(new Date(), !0);\n          if (n && !this._valid(r)) {\n            s = r.getMonth();\n            for (var l = 1; l < 31 && !this._valid(r); l++) {\n              var h = a.addDays(r, +l),\n                u = a.addDays(r, -l);\n              this._valid(h) && h.getMonth() == s ? r = h : this._valid(u) && u.getMonth() == s && (r = u);\n            }\n          }\n          for (l = 0; l < 31 && !this._valid(r); l++) r = a.addDays(r, i > 0 || n > 0 ? 1 : -1);\n          e.shiftKey && r > this.value ? this.rangeEnd = r : this.value = r;\n        }\n        o && e.preventDefault();\n      }\n    }\n  };\n  Calendar.prototype._getMonth = function (e) {\n    var t = DateTime;\n    e = e || t.newDate();\n    return t.newDate(e.getFullYear(), e.getMonth(), 1);\n  };\n  Calendar.prototype._mthMode = function () {\n    return this.selectionMode == DateSelectionMode.Month;\n  };\n  Calendar.prototype._rngMode = function () {\n    return this.selectionMode == DateSelectionMode.Range;\n  };\n  Calendar.prototype._navigate = function (e) {\n    var t = this.monthView,\n      i = this.displayMonth,\n      n = DateTime;\n    switch (e) {\n      case 0:\n        var o = n.newDate();\n        this._canChangeValue() && (this.value = t ? n.fromDateTime(o, this.value) : this._getMonth(o));\n        i = this._getMonth(o);\n        break;\n      case 1:\n        i = n.addMonths(i, t ? 1 : 12);\n        break;\n      case -1:\n        i = n.addMonths(i, t ? -1 : -12);\n    }\n    this.displayMonth = i;\n  };\n  Calendar.prototype._setTabOrder = function (t) {\n    e.prototype._setTabOrder.call(this, t);\n    this._lbYears.tabOrder = this._orgTabIndex;\n  };\n  Calendar._DATE_KEY = \"$WJ-DATE\";\n  Calendar.controlTemplate = '<div class=\"wj-content wj-calendar-outer\"><div wj-part=\"tbl-header\" class=\"wj-calendar-header\"><div wj-part=\"btn-month\" class=\"wj-month-select\" role=\"button\"><span wj-part=\"span-month\"></span> <span class=\"wj-glyph-down\"></span></div><div class=\"wj-btn-group\"><button wj-part=\"btn-prev\" class=\"wj-btn wj-btn-default\" tabindex=\"-1\"><span class=\"wj-glyph-left\"></span></button><button wj-part=\"btn-today\" class=\"wj-btn wj-btn-default\" tabindex=\"-1\"><span class=\"wj-glyph-circle\"></span></button><button wj-part=\"btn-next\" class=\"wj-btn wj-btn-default\" tabindex=\"-1\"><span class=\"wj-glyph-right\"></span></button></div></div><table wj-part=\"tbl-month\" class=\"wj-calendar-month\" role=\"grid\"></table><table wj-part=\"tbl-year\" class=\"wj-calendar-year\" role=\"grid\"></table></div>';\n  return Calendar;\n}(Control);\nexport { Calendar };\n_addCultureInfo(\"DropDown\", {\n  ariaLabels: {\n    tgl: \"Toggle Dropdown\"\n  }\n});\nexport var ClickAction;\n!function (e) {\n  e[e.Select = 0] = \"Select\";\n  e[e.Open = 1] = \"Open\";\n  e[e.Toggle = 2] = \"Toggle\";\n}(ClickAction || (ClickAction = {}));\nvar _Edges,\n  DropDown = function (e) {\n    __extends(DropDown, e);\n    function DropDown(t, i) {\n      var n = e.call(this, t) || this;\n      n._clickAction = ClickAction.Select;\n      n._showBtn = !0;\n      n._autoExpand = !0;\n      n._animate = !1;\n      n._internalSettingText = !1;\n      n._oldText = \"\";\n      n.textChanged = new Event();\n      n.isDroppedDownChanging = new Event();\n      n.isDroppedDownChanged = new Event();\n      var o = n.getTemplate();\n      n.applyTemplate(\"wj-control wj-content wj-dropdown\", o, {\n        _tbx: \"input\",\n        _btn: \"btn\",\n        _dropDown: \"dropdown\"\n      }, \"input\");\n      n._dropDown.style.display = \"none\";\n      var s = culture.DropDown.ariaLabels;\n      setAriaLabel(n._btn.querySelector(\"button\"), s.tgl);\n      var r = n._elRef = n._tbx;\n      disableAutoComplete(r);\n      n._createDropDown();\n      n._updateBtn();\n      var a = n.hostElement;\n      addClass(a, \"wj-state-collapsed\");\n      n.addEventListener(window, \"resize\", function () {\n        n.isDroppedDown && n.invalidate();\n      });\n      var l = n.dropDown,\n        h = n.addEventListener.bind(n),\n        u = n._updateFocusState.bind(n);\n      h(l, \"blur\", u, !0);\n      h(l, \"focus\", u);\n      var c = n._keydown.bind(n);\n      h(a, \"keydown\", c);\n      h(l, \"keydown\", c);\n      var p = n._keypress.bind(n);\n      h(a, \"keypress\", p, !0);\n      h(l, \"keypress\", p, !0);\n      h(r, \"input\", n._input.bind(n));\n      h(r, \"blur\", function () {\n        n._commitText(!0);\n      }, !0);\n      h(r, \"click\", function () {\n        n._autoExpand && n._expandSelection();\n      });\n      h(r, \"mousedown\", function (e) {\n        switch (n._clickAction) {\n          case ClickAction.Open:\n            if (!n.isDroppedDown) {\n              e.preventDefault();\n              n.focus();\n              n.isDroppedDown = !0;\n            }\n            break;\n          case ClickAction.Toggle:\n            e.preventDefault();\n            n.focus();\n            n.isDroppedDown = !n.isDroppedDown;\n        }\n      });\n      h(n._btn, \"mousedown\", function (e) {\n        n._btnclick(e);\n      });\n      removeChild(l);\n      isIE() && n._elRef == n._tbx && h(a, \"mouseup\", function (e) {\n        if (!e.defaultPrevented && 0 == e.button && hasClass(e.target, \"wj-btn\")) {\n          var t = getActiveElement();\n          t && t != e.target && setTimeout(function () {\n            t.focus();\n          });\n        }\n      });\n      isIE9() && h(r, \"keyup\", function () {\n        n._setText(n.text, !1);\n      });\n      h(l, \"click\", n._dropDownClick.bind(n));\n      return n;\n    }\n    Object.defineProperty(DropDown.prototype, \"text\", {\n      get: function () {\n        return this._tbx.value;\n      },\n      set: function (e) {\n        this._trimText && \"string\" == typeof e && (e = e.trim());\n        if (e != this.text) {\n          this._setText(e, !0);\n          this._commitText();\n        }\n      },\n      enumerable: !0,\n      configurable: !0\n    });\n    Object.defineProperty(DropDown.prototype, \"inputElement\", {\n      get: function () {\n        return this._tbx;\n      },\n      enumerable: !0,\n      configurable: !0\n    });\n    Object.defineProperty(DropDown.prototype, \"inputType\", {\n      get: function () {\n        return this._tbx.type;\n      },\n      set: function (e) {\n        this._tbx.type = asString(e);\n      },\n      enumerable: !0,\n      configurable: !0\n    });\n    Object.defineProperty(DropDown.prototype, \"isReadOnly\", {\n      get: function () {\n        return this._tbx.readOnly;\n      },\n      set: function (e) {\n        this._tbx.readOnly = asBoolean(e);\n        toggleClass(this.hostElement, \"wj-state-readonly\", this.isReadOnly);\n        this.isReadOnly && this._toogleDropDown(!1);\n      },\n      enumerable: !0,\n      configurable: !0\n    });\n    Object.defineProperty(DropDown.prototype, \"isRequired\", {\n      get: function () {\n        return this._tbx.required;\n      },\n      set: function (e) {\n        this._tbx.required = asBoolean(\"boolean\" == typeof e ? e : this.isRequired);\n      },\n      enumerable: !0,\n      configurable: !0\n    });\n    Object.defineProperty(DropDown.prototype, \"placeholder\", {\n      get: function () {\n        return this._tbx.placeholder;\n      },\n      set: function (e) {\n        this._tbx.placeholder = e;\n      },\n      enumerable: !0,\n      configurable: !0\n    });\n    Object.defineProperty(DropDown.prototype, \"clickAction\", {\n      get: function () {\n        return this._clickAction;\n      },\n      set: function (e) {\n        this._clickAction = asEnum(e, ClickAction);\n      },\n      enumerable: !0,\n      configurable: !0\n    });\n    Object.defineProperty(DropDown.prototype, \"isDroppedDown\", {\n      get: function () {\n        var e = this._dropDown;\n        return e && \"none\" != e.style.display;\n      },\n      set: function (e) {\n        var t = this.hostElement,\n          i = this._dropDown,\n          n = this.containsFocus();\n        if (t && i && (e = asBoolean(e) && !this.isDisabled && !this.isReadOnly && t.offsetWidth > 0) != this.isDroppedDown && this.onIsDroppedDownChanging(new CancelEventArgs())) {\n          this._toogleDropDown(e);\n          n && (this.isTouching && this.showDropDownButton ? t.focus() : this.selectAll());\n          this._updateFocusState();\n          toggleClass(t, \"wj-state-collapsed\", !this.isDroppedDown);\n          this.onIsDroppedDownChanged();\n        }\n      },\n      enumerable: !0,\n      configurable: !0\n    });\n    DropDown.prototype._toogleDropDown = function (e) {\n      var t = this,\n        i = this.hostElement,\n        n = this._dropDown;\n      if (e) {\n        this._minWidthDropdown = n.style.minWidth;\n        n.style.display = \"\";\n        this._updateDropDown();\n        this.addEventListener(window, \"touchstart\", function (e) {\n          for (var n = e.target; n;) {\n            if (n == i) return;\n            n = n[Control._OWNR_KEY] || n.parentNode;\n          }\n          Control._touching = !0;\n          t.isDroppedDown = !1;\n          Control._touching = !1;\n        });\n      } else {\n        this.removeEventListener(window, \"touchstart\");\n        hidePopup(n);\n        n.style.minWidth = this._minWidthDropdown;\n      }\n    };\n    Object.defineProperty(DropDown.prototype, \"dropDown\", {\n      get: function () {\n        return this._dropDown;\n      },\n      enumerable: !0,\n      configurable: !0\n    });\n    Object.defineProperty(DropDown.prototype, \"dropDownCssClass\", {\n      get: function () {\n        return this._cssClass;\n      },\n      set: function (e) {\n        if (e != this._cssClass) {\n          removeClass(this._dropDown, this._cssClass);\n          this._cssClass = asString(e);\n          addClass(this._dropDown, this._cssClass);\n        }\n      },\n      enumerable: !0,\n      configurable: !0\n    });\n    Object.defineProperty(DropDown.prototype, \"showDropDownButton\", {\n      get: function () {\n        return this._showBtn;\n      },\n      set: function (e) {\n        this._showBtn = asBoolean(e);\n        this._updateBtn();\n      },\n      enumerable: !0,\n      configurable: !0\n    });\n    Object.defineProperty(DropDown.prototype, \"autoExpandSelection\", {\n      get: function () {\n        return this._autoExpand;\n      },\n      set: function (e) {\n        this._autoExpand = asBoolean(e);\n      },\n      enumerable: !0,\n      configurable: !0\n    });\n    Object.defineProperty(DropDown.prototype, \"isAnimated\", {\n      get: function () {\n        return this._animate;\n      },\n      set: function (e) {\n        this._animate = asBoolean(e);\n      },\n      enumerable: !0,\n      configurable: !0\n    });\n    DropDown.prototype.selectAll = function () {\n      var e = this._tbx;\n      this._elRef == e && setSelectionRange(e, 0, this.text.length);\n      this.containsFocus() || this.focus();\n    };\n    DropDown.prototype.onTextChanged = function (e) {\n      this.textChanged.raise(this, e);\n      this._updateState();\n    };\n    DropDown.prototype.onIsDroppedDownChanging = function (e) {\n      this.isDroppedDownChanging.raise(this, e);\n      return !e.cancel;\n    };\n    DropDown.prototype.onIsDroppedDownChanged = function (e) {\n      this.isDroppedDownChanged.raise(this, e);\n    };\n    DropDown.prototype.onGotFocus = function (t) {\n      this.isTouching || contains(this._dropDown, getActiveElement()) || this.selectAll();\n      e.prototype.onGotFocus.call(this, t);\n    };\n    DropDown.prototype.onLostFocus = function (t) {\n      this._commitText();\n      this.isDroppedDown = !1;\n      e.prototype.onLostFocus.call(this, t);\n    };\n    DropDown.prototype._containsFocusImpl = function (t) {\n      return e.prototype._containsFocusImpl.call(this, t) || this.isDroppedDown && contains(this._dropDown, t);\n    };\n    DropDown.prototype.dispose = function () {\n      this.isDroppedDown = !1;\n      var t = this._dropDown;\n      if (t) {\n        this._dropDown = null;\n        removeChild(t);\n        var i = Control.getControl(t);\n        i && i.dispose();\n      }\n      e.prototype.dispose.call(this);\n    };\n    DropDown.prototype.refresh = function (t) {\n      void 0 === t && (t = !0);\n      e.prototype.refresh.call(this, t);\n      var i = this.hostElement;\n      if (i && i.offsetHeight && this.isDroppedDown) {\n        var n = getActiveElement();\n        this.isAnimated && \"\" != this._dropDown.style.opacity || showPopup(this._dropDown, i, !1, !1, null == this.dropDownCssClass);\n        n instanceof HTMLElement && n != getActiveElement() && n.focus();\n      }\n    };\n    DropDown.prototype._handleResize = function () {\n      this.isDroppedDown && this.refresh();\n    };\n    DropDown.prototype._dropDownClick = function (e) {\n      e.stopPropagation();\n    };\n    DropDown.prototype._expandSelection = function () {\n      var e = this._tbx,\n        t = e.value,\n        i = e.selectionStart,\n        n = e.selectionEnd;\n      if (t && i == n) {\n        var o = this._getCharType(t, i);\n        if (o > -1) {\n          for (; n < t.length && this._getCharType(t, n) == o; n++);\n          for (; i > 0 && this._getCharType(t, i - 1) == o; i--);\n          i != n && setSelectionRange(e, i, n);\n        }\n      }\n    };\n    DropDown.prototype._getCharType = function (e, t) {\n      var i = e[t];\n      return i >= \"0\" && i <= \"9\" ? 0 : i >= \"a\" && i <= \"z\" || i >= \"A\" && i <= \"Z\" ? 1 : -1;\n    };\n    DropDown.prototype._keydown = function (e) {\n      if (!e.defaultPrevented && !this._isHiddenEditor()) {\n        switch (e.keyCode) {\n          case Key.Tab:\n          case Key.Escape:\n          case Key.Enter:\n            if (this.isDroppedDown) {\n              this.isDroppedDown = !1;\n              e.keyCode == Key.Tab || this.containsFocus() || this.focus();\n              e.preventDefault();\n            }\n            break;\n          case Key.F4:\n          case Key.Up:\n          case Key.Down:\n            if (e.keyCode == Key.F4 || e.altKey) {\n              var t = this.hostElement;\n              if (t && t.offsetHeight) {\n                this.isDroppedDown = !this.isDroppedDown;\n                e.preventDefault();\n              }\n            }\n        }\n        if (!e.defaultPrevented && e.keyCode == Key.Escape && isIE()) {\n          var i = this._tbx;\n          if (e.target == i) {\n            var n = i.value;\n            i.value = n + \" \";\n            i.value = n;\n          }\n        }\n      }\n    };\n    DropDown.prototype._isHiddenEditor = function () {\n      return hasClass(this._tbx, \"wj-grid-ime\");\n    };\n    DropDown.prototype._keypress = function (e) {\n      \"AltLeft\" != e.code && \"AltRight\" != e.code || e.preventDefault();\n    };\n    DropDown.prototype._input = function (e) {\n      this._setText(this.text, !1);\n    };\n    DropDown.prototype._btnclick = function (e) {\n      if (!e.defaultPrevented && 0 == e.button) {\n        e.preventDefault();\n        this.isTouching ? this._containsFocus() || this.hostElement.focus() : this.focus();\n        this.isDroppedDown = !this.isDroppedDown;\n      }\n    };\n    DropDown.prototype._setText = function (e, t) {\n      (e = (e || \"\").toString()) != this._tbx.value && (this._tbx.value = e);\n      if (e != this._oldText) {\n        this._oldText = e;\n        this._internalSettingText || this.onTextChanged();\n      }\n      this._updateState();\n    };\n    DropDown.prototype._updateBtn = function () {\n      this._btn.style.display = this._showBtn ? \"\" : \"none\";\n    };\n    DropDown.prototype._createDropDown = function () {};\n    DropDown.prototype._commitText = function (e) {};\n    DropDown.prototype._updateDropDown = function () {\n      if (this.isDroppedDown) {\n        this._commitText();\n        var e = this.dropDown;\n        setAttribute(e, \"dir\", this.rightToLeft ? \"rtl\" : null);\n        showPopup(e, this.hostElement, !1, this._animate, null == this.dropDownCssClass);\n      }\n    };\n    DropDown.controlTemplate = '<div class=\"wj-template\"><div class=\"wj-input\"><div class=\"wj-input-group wj-input-btn-visible\"><input wj-part=\"input\" type=\"text\" class=\"wj-form-control\"><span wj-part=\"btn\" class=\"wj-input-group-btn\"><button class=\"wj-btn wj-btn-default\" tabindex=\"-1\"><span class=\"wj-glyph-down\"></span></button></span></div></div><div wj-part=\"dropdown\" class=\"wj-content wj-dropdown-panel\"></div></div>';\n    return DropDown;\n  }(Control);\nexport { DropDown };\nexport var PopupTrigger;\n!function (e) {\n  e[e.None = 0] = \"None\";\n  e[e.ClickOwner = 1] = \"ClickOwner\";\n  e[e.ClickPopup = 2] = \"ClickPopup\";\n  e[e.Click = 3] = \"Click\";\n  e[e.BlurOwner = 4] = \"BlurOwner\";\n  e[e.BlurPopup = 8] = \"BlurPopup\";\n  e[e.Blur = 12] = \"Blur\";\n  e[e.ClickOrBlur = 15] = \"ClickOrBlur\";\n  e[e.DownOwner = 16] = \"DownOwner\";\n  e[e.DownPopup = 32] = \"DownPopup\";\n  e[e.Down = 48] = \"Down\";\n  e[e.EnterOwner = 64] = \"EnterOwner\";\n  e[e.EnterPopup = 128] = \"EnterPopup\";\n  e[e.Enter = 192] = \"Enter\";\n  e[e.LeaveOwner = 256] = \"LeaveOwner\";\n  e[e.LeavePopup = 512] = \"LeavePopup\";\n  e[e.Leave = 768] = \"Leave\";\n}(PopupTrigger || (PopupTrigger = {}));\n!function (e) {\n  e[e.None = 0] = \"None\";\n  e[e.Left = 1] = \"Left\";\n  e[e.Top = 2] = \"Top\";\n  e[e.Right = 4] = \"Right\";\n  e[e.Bottom = 8] = \"Bottom\";\n  e[e.LeftTop = 3] = \"LeftTop\";\n  e[e.RightTop = 6] = \"RightTop\";\n  e[e.RightBottom = 12] = \"RightBottom\";\n  e[e.LeftBottom = 9] = \"LeftBottom\";\n}(_Edges || (_Edges = {}));\nvar Popup = function (e) {\n  __extends(Popup, e);\n  function Popup(t, i) {\n    var n = e.call(this, t) || this;\n    n._owner = null;\n    n._modal = !1;\n    n._position = PopupPosition.BelowLeft;\n    n._showTrigger = PopupTrigger.ClickOwner;\n    n._hideTrigger = PopupTrigger.Blur;\n    n._hideAnim = [];\n    n._fadeIn = !0;\n    n._fadeOut = !0;\n    n._removeOnHide = !0;\n    n._draggable = !1;\n    n._resizable = !1;\n    n._result = null;\n    n._resultEnter = null;\n    n._resultSubmit = null;\n    n._callback = null;\n    n._visible = !1;\n    n._ownerClickBnd = n._ownerClick.bind(n);\n    n._ownerDownBnd = n._ownerDown.bind(n);\n    n._ownerBlurBnd = n._ownerBlur.bind(n);\n    n._ownerEnterBnd = n._ownerEnter.bind(n);\n    n._ownerLeaveBnd = n._ownerLeave.bind(n);\n    n._mousedownBnd = n._mousedown.bind(n);\n    n._mousemoveBnd = n._mousemove.bind(n);\n    n._mousedragBnd = n._mousedrag.bind(n);\n    n._mouseupBnd = n._mouseup.bind(n);\n    n._hideBnd = n.hide.bind(n);\n    n._lastShow = 0;\n    n.showing = new Event();\n    n.shown = new Event();\n    n.hiding = new Event();\n    n.hidden = new Event();\n    n.resizing = new Event();\n    n.resized = new Event();\n    n.dragging = new Event();\n    n.dragged = new Event();\n    n.sizeChanging = new Event();\n    n.sizeChanged = new Event();\n    n.positionChanging = new Event();\n    n.positionChanged = new Event();\n    var o = n.hostElement;\n    addClass(o, \"wj-control wj-content wj-popup\");\n    o.getAttribute(\"tabindex\") || (o.tabIndex = 0);\n    hidePopup(o, !1);\n    var s = n.addEventListener.bind(n);\n    s(o, \"compositionstart\", function () {\n      n._composing = !0;\n    });\n    s(o, \"compositionend\", function () {\n      n._composing = !1;\n    });\n    s(window, \"resize\", function () {\n      !n.isVisible || n._dragged || n.isTouching || n.invalidate();\n    });\n    s(o, \"keydown\", function (e) {\n      if (!e.defaultPrevented) {\n        if (e.keyCode == Key.Escape && !n._composing) {\n          e.preventDefault();\n          n.hide();\n        }\n        if (e.keyCode == Key.Enter && !n._composing) {\n          var t = n.dialogResultEnter;\n          if (t) {\n            e.preventDefault();\n            n._validateAndHide(t);\n          }\n        }\n        if (e.keyCode == Key.Tab && n.modal) {\n          e.preventDefault();\n          moveFocus(o, e.shiftKey ? -1 : 1);\n        }\n      }\n    });\n    s(o, \"click\", function (e) {\n      var t = e.target;\n      if (t instanceof HTMLElement) {\n        if (t instanceof HTMLButtonElement && \"submit\" == t.type) {\n          var i = n.hostElement,\n            o = n.dialogResultSubmit;\n          if (i instanceof HTMLFormElement && o && i.reportValidity()) {\n            e.preventDefault();\n            n.hide(o);\n          }\n        }\n        var s = t.className.match(/\\bwj-hide[\\S]*\\b/);\n        if (s && s.length > 0) {\n          e.preventDefault();\n          e.stopPropagation();\n          n.hide(s[0]);\n        }\n      }\n    });\n    var r = n._toggle.bind(n),\n      a = PopupTrigger;\n    n.addEventListener(o, \"click\", function (e) {\n      n._ignoreClick || r(e, a.ClickPopup);\n    }, !0);\n    n.addEventListener(o, \"mousedown\", function (e) {\n      n._ignoreClick = !1;\n      r(e, a.DownPopup);\n    }, !0);\n    n.addEventListener(o, \"mouseenter\", function (e) {\n      e.target == o && r(e, a.EnterPopup);\n    }, !0);\n    n.addEventListener(o, \"mouseleave\", function (e) {\n      e.target == o && r(e, a.LeavePopup);\n    }, !0);\n    n.addEventListener(o, \"blur\", function (e) {\n      n.containsFocus() || r(e, a.BlurPopup);\n    }, !0);\n    s(document, \"wheel\", function (e) {\n      if (n.isVisible && n._modal) {\n        for (var t = e.target; t && t != document.body; t = t.parentElement) if (t.scrollHeight > t.clientHeight) return;\n        e.preventDefault();\n      }\n    });\n    n.initialize(i);\n    return n;\n  }\n  Object.defineProperty(Popup.prototype, \"owner\", {\n    get: function () {\n      return this._owner;\n    },\n    set: function (e) {\n      var t = this._owner;\n      if (t) {\n        this.removeEventListener(t, \"click\");\n        this.removeEventListener(t, \"mousedown\");\n        this.removeEventListener(t, \"mouseenter\");\n        this.removeEventListener(t, \"mouseleave\");\n        this.removeEventListener(t, \"blur\");\n      }\n      if (t = this._owner = null != e ? getElement(e) : null) {\n        this.addEventListener(t, \"click\", this._ownerClickBnd, !0);\n        this.addEventListener(t, \"mousedown\", this._ownerDownBnd, !0);\n        this.addEventListener(t, \"mouseenter\", this._ownerEnterBnd, !0);\n        this.addEventListener(t, \"mouseleave\", this._ownerLeaveBnd, !0);\n        this.addEventListener(t, \"blur\", this._ownerBlurBnd, !0);\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Popup.prototype, \"position\", {\n    get: function () {\n      return this._position;\n    },\n    set: function (e) {\n      this._position = asEnum(e, PopupPosition);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Popup.prototype, \"content\", {\n    get: function () {\n      return this.hostElement.firstElementChild;\n    },\n    set: function (e) {\n      if (e != this.content) {\n        this.hostElement.innerHTML = \"\";\n        e instanceof HTMLElement && this.hostElement.appendChild(e);\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Popup.prototype, \"showTrigger\", {\n    get: function () {\n      return this._showTrigger;\n    },\n    set: function (e) {\n      this._showTrigger = asEnum(e, PopupTrigger);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Popup.prototype, \"hideTrigger\", {\n    get: function () {\n      return this._hideTrigger;\n    },\n    set: function (e) {\n      this._hideTrigger = asEnum(e, PopupTrigger);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Popup.prototype, \"fadeIn\", {\n    get: function () {\n      return this._fadeIn;\n    },\n    set: function (e) {\n      this._fadeIn = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Popup.prototype, \"fadeOut\", {\n    get: function () {\n      return this._fadeOut;\n    },\n    set: function (e) {\n      this._fadeOut = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Popup.prototype, \"removeOnHide\", {\n    get: function () {\n      return this._removeOnHide;\n    },\n    set: function (e) {\n      if ((e = asBoolean(e)) != this.removeOnHide) {\n        this._removeOnHide = e;\n        if (!this.isVisible) {\n          var t = this.hostElement;\n          if (e) removeChild(t);else if (t && document.body) {\n            t.style.display = \"none\";\n            document.body.appendChild(t);\n          }\n        }\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Popup.prototype, \"modal\", {\n    get: function () {\n      return this._modal;\n    },\n    set: function (e) {\n      this._modal = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Popup.prototype, \"isDraggable\", {\n    get: function () {\n      return this._draggable;\n    },\n    set: function (e) {\n      this._draggable = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Popup.prototype, \"isResizable\", {\n    get: function () {\n      return this._resizable;\n    },\n    set: function (e) {\n      this._resizable = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Popup.prototype, \"dialogResult\", {\n    get: function () {\n      return this._result;\n    },\n    set: function (e) {\n      this._result = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Popup.prototype, \"dialogResultEnter\", {\n    get: function () {\n      return this._resultEnter;\n    },\n    set: function (e) {\n      this._resultEnter = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Popup.prototype, \"dialogResultSubmit\", {\n    get: function () {\n      return this._resultSubmit;\n    },\n    set: function (e) {\n      this._resultSubmit = asString(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Popup.prototype, \"isVisible\", {\n    get: function () {\n      var e = this.hostElement;\n      return this._visible && null != e && e.offsetHeight > 0;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Popup.prototype.show = function (e, t) {\n    var i = this;\n    this._lastShow = Date.now();\n    if (!this.isVisible) {\n      var n = this.hostElement;\n      this.dialogResult = null;\n      this._callback = null;\n      this._oldFocus = null;\n      this._myFocus = null;\n      this._hideAnim.forEach(function (e) {\n        clearInterval(e);\n      });\n      if (this._hideAnim.length > 0) {\n        this._hideAnim.length = 0;\n        if (this._bkDrop) {\n          hidePopup(this._bkDrop, this.removeOnHide);\n          this._bkDrop.style.opacity = \"\";\n        }\n        hidePopup(n, this.removeOnHide);\n        n.style.opacity = \"\";\n      }\n      var o = new CancelEventArgs();\n      if (this.onShowing(o)) {\n        null != e && (this.modal = asBoolean(e));\n        null != t && (this._callback = asFunction(t));\n        this._oldFocus = getActiveElement();\n        showPopup(n, this._owner, this._position, this._fadeIn, !1, this._hideBnd);\n        this._modal && this._showBackdrop();\n        this._composing = !1;\n        this._visible = !0;\n        this.onShown(o);\n        this._clearTimeouts();\n        if (this.modal) {\n          this.addEventListener(window, \"focus\", function () {\n            if (!i.containsFocus()) {\n              var e = i._myFocus;\n              e && e.offsetHeight ? e.focus() : moveFocus(n, 0);\n            }\n          });\n          this.addEventListener(n, \"focusin\", function () {\n            var e = getActiveElement();\n            e && contains(n, e) && (e.tabIndex > -1 || !i._myFocus) && (i._myFocus = e);\n          });\n        }\n        this._resized = this._dragged = this._ignoreClick = !1;\n        this._handleDragResize(!0);\n        this.addEventListener(window, \"touchstart\", function (e) {\n          i._hideTrigger & PopupTrigger.Blur && !contains(n, e.target, !0) && i.hide();\n        });\n        setTimeout(function () {\n          i.addEventListener(window, \"click\", function (e) {\n            i._hideTrigger & PopupTrigger.BlurPopup && i.isDisabled && !contains(n, e.target, !0) && i.hide();\n          });\n        });\n        setTimeout(function () {\n          if (!i.isDisabled && !i.containsFocus() && !i.isTouching) {\n            var e = n.querySelector(\"[autofocus]\");\n            if (e && e.clientHeight > 0 && !e.disabled && e.tabIndex > -1 && !closest(e, \"[disabled],.wj-state-disabled\")) {\n              e.focus();\n              isFunction(e.select) && e.select();\n            } else moveFocus(n, 0);\n          }\n          if (!i.isDisabled && !i.containsFocus()) {\n            n.tabIndex = 0;\n            n.focus();\n          }\n        }, 100);\n      }\n    }\n  };\n  Popup.prototype.hide = function (e) {\n    var t = this;\n    this.removeEventListener(window, \"touchstart\");\n    this.removeEventListener(window, \"click\");\n    if (this.isVisible) {\n      isUndefined(e) || (this.dialogResult = e);\n      var i = new CancelEventArgs(),\n        n = this.hostElement;\n      if (this.onHiding(i)) {\n        this._handleDragResize(!1);\n        for (var o = this.containsFocus() ? this._oldFocus : null, s = n.querySelectorAll(\".wj-control.wj-dropdown\"), r = 0; r < s.length; r++) {\n          var a = Control.getControl(s[r]);\n          a instanceof DropDown && (a.isDroppedDown = !1);\n        }\n        var l = this.removeOnHide,\n          h = this.fadeOut;\n        setTimeout(function () {\n          t._updateState();\n          t.onHidden(i);\n          t._callback && t._callback(t);\n          if (t.hideTrigger & PopupTrigger.LeavePopup) {\n            var e = Control.getControl(closest(t.owner, \".wj-popup\"));\n            if (e instanceof Popup && 0 != (e.hideTrigger & PopupTrigger.Leave)) {\n              var n = Popup._evtHover,\n                o = n ? document.elementFromPoint(n.clientX, n.clientY) : null,\n                s = Control.getControl(closest(o, \".wj-popup\"));\n              s instanceof Popup && !s.isVisible && (o = null);\n              o && contains(e.hostElement, o, !0) || e.hide();\n            }\n          }\n        }, Control._FOCUS_INTERVAL + 50);\n        this._bkDrop && this._hideAnim.push(hidePopup(this._bkDrop, l, h));\n        this._hideAnim.push(hidePopup(n, l, h));\n        this._visible = !1;\n        this._oldFocus = null;\n        this._myFocus = null;\n        this.removeEventListener(window, \"focus\");\n        this.removeEventListener(n, \"focusin\");\n        this.containsFocus() && getActiveElement().blur();\n        this._clearTimeouts();\n        !this.isVisible && o && o.offsetHeight && o.focus();\n      }\n    }\n  };\n  Popup.prototype.onShowing = function (e) {\n    this.showing.raise(this, e);\n    return !e.cancel;\n  };\n  Popup.prototype.onShown = function (e) {\n    this.shown.raise(this, e);\n  };\n  Popup.prototype.onHiding = function (e) {\n    this.hiding.raise(this, e);\n    return !e.cancel;\n  };\n  Popup.prototype.onHidden = function (e) {\n    this._wasVisible = !1;\n    this.hidden.raise(this, e);\n  };\n  Popup.prototype.onResizing = function (e) {\n    this.resizing.raise(this, e);\n    return !e.cancel;\n  };\n  Popup.prototype.onResized = function (e) {\n    this.resized.raise(this, e);\n  };\n  Popup.prototype.onDragging = function (e) {\n    this.dragging.raise(this, e);\n    return !e.cancel;\n  };\n  Popup.prototype.onDragged = function (e) {\n    this.dragged.raise(this, e);\n  };\n  Popup.prototype.onSizeChanging = function (e) {\n    this.sizeChanging.raise(this, e);\n    return !e.cancel;\n  };\n  Popup.prototype.onSizeChanged = function (e) {\n    this.sizeChanged.raise(this, e);\n  };\n  Popup.prototype.onPositionChanging = function (e) {\n    this.positionChanging.raise(this, e);\n    return !e.cancel;\n  };\n  Popup.prototype.onPositionChanged = function (e) {\n    this.positionChanged.raise(this, e);\n  };\n  Popup.prototype.onLostFocus = function (t) {\n    e.prototype.onLostFocus.call(this, t);\n    if (this._hideTrigger & PopupTrigger.BlurPopup && !this.containsFocus()) {\n      var i = document.createEvent(\"Event\");\n      i.initEvent(\"blur\", !0, !0);\n      this._toggle(i, PopupTrigger.BlurPopup);\n    }\n  };\n  Popup.prototype.dispose = function () {\n    this.owner = null;\n    e.prototype.dispose.call(this);\n  };\n  Popup.prototype.refresh = function (t) {\n    void 0 === t && (t = !0);\n    var i = this.hostElement;\n    e.prototype.refresh.call(this, t);\n    if (this.isVisible && !this._refreshing && i) {\n      this._refreshing = !0;\n      for (var n = getActiveElement(), o = this._owner ? this._owner.getBoundingClientRect() : null, s = [], r = i.querySelectorAll(\".wj-dropdown\"), a = 0; a < r.length; a++) {\n        var l = Control.getControl(r[a]);\n        if (l instanceof DropDown && l.isDroppedDown) {\n          s.push(l);\n          l.dropDown.style.display = \"none\";\n        }\n      }\n      showPopup(i, o, this._position);\n      s.forEach(function (e) {\n        e.dropDown.style.display = \"\";\n        e._updateDropDown();\n      });\n      this._modal && n instanceof HTMLElement && n != getActiveElement() && n.focus();\n      this._refreshing = !1;\n    }\n  };\n  Popup.prototype._clearTimeouts = function () {\n    if (this._toShow) {\n      clearTimeout(this._toShow);\n      this._toShow = null;\n    }\n    if (this._toHideLeave) {\n      clearTimeout(this._toHideLeave);\n      this._toHideLeave = null;\n    }\n    if (this._toHideBlur) {\n      clearTimeout(this._toHideBlur);\n      this._toHideBlur = null;\n    }\n  };\n  Popup.prototype._handleDragResize = function (e) {\n    var t = this.hostElement,\n      i = this._draggable ? this._getHeaderElement() : null,\n      n = this.addEventListener.bind(this),\n      o = this.removeEventListener.bind(this),\n      s = this._mousemoveBnd,\n      r = this._mousedownBnd;\n    if (e) {\n      n(t, \"mousemove\", s);\n      n(t, \"mousedown\", r);\n      n(t, \"touchstart\", r);\n      i && (i.style.touchAction = \"none\");\n    } else {\n      this._mousedownEvt = null;\n      this._rcBounds = null;\n      o(t, \"mousemove\", s);\n      o(t, \"mousedown\", r);\n      o(t, \"touchstart\", r);\n      o(document, \"mousemove\", this._mousedragBnd);\n      o(document, \"mouseup\", this._mouseupBnd);\n      i && (i.style.touchAction = \"\");\n    }\n  };\n  Popup.prototype._mousemove = function (e) {\n    if (!this._mousedownEvt) {\n      var t = this.hostElement,\n        i = this._getEdges(t, e),\n        n = \"\",\n        o = _Edges;\n      this._edges = i;\n      this._resizable && (i == o.LeftTop || i == o.RightBottom ? n = \"nwse-resize\" : i == o.LeftBottom || i == o.RightTop ? n = \"nesw-resize\" : i == o.Left || i == o.Right ? n = \"ew-resize\" : i != o.Top && i != o.Bottom || (n = \"ns-resize\"));\n      this._draggable && !n && this._getClosestHeader(e.target) && (n = \"move\");\n      t.style.cursor = n;\n    }\n  };\n  Popup.prototype._mousedown = function (e) {\n    if (!e.defaultPrevented) {\n      var t = e.touches && e.touches.length > 0 ? e.touches[0] : e;\n      this._edges = this._getEdges(this.hostElement, t);\n      if (this._edges || this._draggable && this._getClosestHeader(e.target)) {\n        var i = new CancelEventArgs();\n        if (this._edges ? this.onResizing(i) : this.onDragging(i)) {\n          this._mousedownEvt = t;\n          this._rcBounds = this.hostElement.getBoundingClientRect();\n          var n = this.addEventListener.bind(this),\n            o = document,\n            s = this._mousedragBnd,\n            r = this._mouseupBnd;\n          n(o, \"mousemove\", s);\n          n(o, \"touchmove\", s);\n          n(o, \"mouseup\", r);\n          n(o, \"touchend\", r);\n        }\n      }\n      this._ignoreClick = !1;\n    }\n  };\n  Popup.prototype._mouseup = function () {\n    this._mousedownEvt = null;\n    this._rcBounds = null;\n    var e = this.removeEventListener.bind(this),\n      t = document,\n      i = this._mousedragBnd,\n      n = this._mouseupBnd;\n    e(t, \"mousemove\", i);\n    e(t, \"touchmove\", i);\n    e(t, \"mouseup\", n);\n    e(t, \"touchend\", n);\n    this._resized ? this.onResized() : this._dragged && this.onDragged();\n    this._resized = this._dragged = this._ignoreClick = !1;\n  };\n  Popup.prototype._mousedrag = function (e) {\n    if (!e.defaultPrevented) {\n      var t = this.hostElement,\n        i = this._mousedownEvt,\n        n = e.touches && e.touches.length > 0 ? e.touches[0] : e,\n        o = n.clientX - i.clientX,\n        s = n.clientY - i.clientY,\n        r = this._rcBounds,\n        a = this._edges,\n        l = Popup._SZ_MIN,\n        h = Rect.fromBoundingRect(r);\n      if (a) {\n        if (a & _Edges.Left) {\n          h.left = r.left + o + (n.pageX - n.clientX);\n          h.width = Math.max(r.width - o, l);\n        } else if (a & _Edges.Right) {\n          h.left = r.left;\n          h.width = Math.max(r.width + o, l);\n        }\n        if (a & _Edges.Top) {\n          h.top = r.top + s + (n.pageY - n.clientY);\n          h.height = Math.max(r.height - s, l);\n        } else if (a & _Edges.Bottom) {\n          h.top = r.top;\n          h.height = Math.max(r.height + s, l);\n        }\n        if (this.onSizeChanging(new PopupBoundsChangingEventArgs(h))) {\n          setCss(t, {\n            left: h.left,\n            top: h.top,\n            width: h.width,\n            height: h.height\n          });\n          this._resized = this._dragged = this._ignoreClick = !0;\n          this.onSizeChanged();\n        }\n        if (!window.ResizeObserver) for (var u = this.hostElement.children, c = 0; c < u.length; c++) Control.invalidateAll(u[c]);\n      } else if (this._draggable && (this._dragged || Math.abs(o) + Math.abs(s) > Popup._DRAG_THRESHOLD)) {\n        h.left = Math.max(r.left + o + (n.pageX - n.clientX), 50 - r.width);\n        h.top = Math.max(r.top + s + (n.pageY - n.clientY), 0);\n        if (this.onPositionChanging(new PopupBoundsChangingEventArgs(h))) {\n          setCss(t, {\n            left: h.left,\n            top: h.top\n          });\n          this._dragged = this._ignoreClick = !0;\n          this.onPositionChanged();\n        }\n      }\n    }\n  };\n  Popup.prototype._getEdges = function (e, t) {\n    var i = 0;\n    if (this._resizable) {\n      var n = e.getBoundingClientRect(),\n        o = Popup._SZ_EDGE;\n      t.clientX - n.left < o && (i |= _Edges.Left);\n      t.clientY - n.top < o && (i |= _Edges.Top);\n      n.right - t.clientX < o && (i |= _Edges.Right);\n      n.bottom - t.clientY < o && (i |= _Edges.Bottom);\n    }\n    return i;\n  };\n  Popup.prototype._ownerClick = function (e) {\n    this._toggle(e, PopupTrigger.ClickOwner);\n  };\n  Popup.prototype._ownerDown = function (e) {\n    this._wasVisible = this.isVisible;\n    this._toggle(e, PopupTrigger.DownOwner);\n  };\n  Popup.prototype._ownerBlur = function (e) {\n    contains(this._owner, getActiveElement()) || this._toggle(e, PopupTrigger.BlurOwner);\n  };\n  Popup.prototype._ownerEnter = function (e) {\n    e.target == this._owner && this._toggle(e, PopupTrigger.EnterOwner);\n  };\n  Popup.prototype._ownerLeave = function (e) {\n    e.target == this._owner && this._toggle(e, PopupTrigger.LeaveOwner);\n  };\n  Popup.prototype._toggle = function (e, t) {\n    var i = this;\n    e instanceof MouseEvent && (Popup._evtHover = e);\n    if (!(\"mouseenter\" == e.type && Date.now() - this._lastShow < 300 || e.defaultPrevented)) {\n      var n = 0 != (this._hideTrigger & t),\n        o = 0 != (this._showTrigger & t),\n        s = PopupTrigger;\n      (n || o) && this._clearTimeouts();\n      n && this.isVisible && (t & s.Leave ? this._toHideLeave = setTimeout(function () {\n        var e = Popup._evtHover,\n          t = e ? document.elementFromPoint(e.clientX, e.clientY) : null;\n        t && contains(i.hostElement, t, !0) || i.hide();\n      }, Control._LEAVE_DELAY) : t & s.Blur ? this._toHideBlur = setTimeout(function () {\n        i.containsFocus() || contains(i._owner, getActiveElement()) || i.hide();\n      }, Control._FOCUS_INTERVAL + 50) : this.hide());\n      o && t != s.ClickPopup && (this._wasVisible || (t & s.Enter ? this._toShow = setTimeout(function () {\n        i.show();\n      }, Control._HOVER_DELAY) : this.show()));\n    }\n  };\n  Popup.prototype._getHeaderElement = function () {\n    var e = this.hostElement;\n    return e.querySelector(\".wj-dialog-header\") || e.querySelector(\".modal-header\");\n  };\n  Popup.prototype._getClosestHeader = function (e) {\n    return closest(e, \".wj-dialog-header\") || closest(e, \".modal-header\");\n  };\n  Popup.prototype._showBackdrop = function () {\n    var e = this;\n    if (!this._bkDrop) {\n      this._bkDrop = document.createElement(\"div\");\n      this._bkDrop.tabIndex = -1;\n      addClass(this._bkDrop, \"wj-popup-backdrop\");\n      this.addEventListener(this._bkDrop, \"mousedown\", function (t) {\n        t.preventDefault();\n        t.stopPropagation();\n        e.hostElement.focus();\n        e.hideTrigger & PopupTrigger.Blur && e.hide();\n      });\n    }\n    setCss(this._bkDrop, {\n      zIndex: Control._POPUP_ZINDEX,\n      display: \"\"\n    });\n    var t = this.hostElement;\n    t.parentElement.insertBefore(this._bkDrop, t);\n  };\n  Popup.prototype._validateAndHide = function (e) {\n    var t = this.hostElement;\n    if (t instanceof HTMLFormElement) t.reportValidity() && this.hide(e);else {\n      var i = this.hostElement.querySelector(\":invalid\");\n      i ? i.focus() : this.hide(e);\n    }\n  };\n  Popup._DRAG_THRESHOLD = 6;\n  Popup._SZ_EDGE = 10;\n  Popup._SZ_MIN = 40;\n  return Popup;\n}(Control);\nexport { Popup };\nvar PopupBoundsChangingEventArgs = function (e) {\n  __extends(PopupBoundsChangingEventArgs, e);\n  function PopupBoundsChangingEventArgs(t) {\n    var i = e.call(this) || this;\n    i._rc = t;\n    return i;\n  }\n  Object.defineProperty(PopupBoundsChangingEventArgs.prototype, \"bounds\", {\n    get: function () {\n      return this._rc;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  return PopupBoundsChangingEventArgs;\n}(CancelEventArgs);\nexport { PopupBoundsChangingEventArgs };\nvar InputDate = function (e) {\n  __extends(InputDate, e);\n  function InputDate(t, i) {\n    var n = e.call(this, t) || this;\n    n._fmt = \"d\";\n    n._sep = \" - \";\n    n._rngs = null;\n    n._showCal = !1;\n    n._clsOnSel = !0;\n    n._handleWheel = !0;\n    n._clicked = !1;\n    n._rangeChanged = !1;\n    n._textInitialized = !1;\n    n.valueChanged = new Event();\n    n.rangeEndChanged = new Event();\n    n.rangeChanged = new Event();\n    addClass(n.hostElement, \"wj-inputdate\");\n    n._msk = new _MaskProvider(n._tbx);\n    isIE9() || (n.inputType = \"tel\");\n    n._tbx.type.match(/^(tel|text|)$/i) || (n.inputType = \"text\");\n    n.addEventListener(n.hostElement, \"wheel\", function (e) {\n      if (n.handleWheel && !e.defaultPrevented && !n.isDroppedDown && n.containsFocus() && null != n.value && n._canChangeValue()) {\n        var t = clamp(-e.deltaY, -1, 1),\n          i = n.value;\n        n.value = n.selectionMode == DateSelectionMode.Month ? DateTime.addMonths(i, t) : DateTime.addDays(i, t);\n        n.selectAll();\n        e.preventDefault();\n      }\n    });\n    var o = n._lbx = new ListBox(document.createElement(\"div\"), {\n        displayMemberPath: \"name\",\n        selectedIndexChanged: function (e) {\n          var t = e.selectedItem,\n            i = DateTime.fromDateTime,\n            o = DateTime.sameDate;\n          if (t && t.from && t.to) {\n            if (!o(t.from, n.value) || !o(t.to, n.rangeEnd)) {\n              var s = n.value;\n              n.value = i(t.from, s);\n              n.rangeEnd = i(t.to, s);\n            }\n            n._selectAll();\n          } else n._cal.hostElement.style.display = \"\";\n        }\n      }),\n      s = n._cal = new Calendar(document.createElement(\"div\")),\n      r = n._dropDown;\n    addClass(r, \"wj-inputdate-dropdown\");\n    r.appendChild(o.hostElement);\n    r.appendChild(s.hostElement);\n    n.addEventListener(r, \"click\", function () {\n      n._clicked = !0;\n      setTimeout(function () {\n        n._clicked = !1;\n      }, 50);\n    }, !0);\n    if (\"INPUT\" == n._orgTag) {\n      var a = n._tbx.getAttribute(\"value\");\n      a && (s.value = s.rangeEnd = Globalize.parseDate(a, \"yyyy-MM-dd\"));\n    }\n    n.isRequired = !0;\n    n._tbx.value = n._oldText = n._getText();\n    n.initialize(i);\n    if (n._textInitialized && n._tbx.value !== n._oldText) {\n      n._oldText = n._tbx.value;\n      n._commitText();\n      n.onTextChanged();\n      n._textInitialized = !1;\n    }\n    n._updateState();\n    s.valueChanged.addHandler(function (e, t) {\n      n._refreshText();\n      n.onValueChanged(t);\n      n._closeOnChange();\n    });\n    s.rangeEndChanged.addHandler(function (e, t) {\n      if (s._rngMode()) {\n        n.onRangeEndChanged(t);\n        n._closeOnChange();\n        s._clearingRangeEnd || n._refreshText();\n      }\n    });\n    s.hostElement.addEventListener(\"click\", function (e) {\n      if (s.selectionMode && !s._rngMode()) {\n        var t = e.target,\n          i = s.hitTest(t);\n        if (DateTime.sameDate(n.value, i) || closest(t, \"[wj-part=btn-today]\")) {\n          n._closeOnChange();\n          n._refreshText();\n        }\n      }\n    });\n    return n;\n  }\n  Object.defineProperty(InputDate.prototype, \"value\", {\n    get: function () {\n      return this._cal.value;\n    },\n    set: function (e) {\n      this._cal.value = e;\n      (this.text || this.isRequired) && this._refreshText();\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"rangeEnd\", {\n    get: function () {\n      return this._cal.rangeEnd;\n    },\n    set: function (e) {\n      this._cal.rangeEnd = e;\n      (this.text || this.isRequired) && this._refreshText();\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"rangeMin\", {\n    get: function () {\n      return this._cal.rangeMin;\n    },\n    set: function (e) {\n      this._cal.rangeMin = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"rangeMax\", {\n    get: function () {\n      return this._cal.rangeMax;\n    },\n    set: function (e) {\n      this._cal.rangeMax = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"text\", {\n    get: function () {\n      return this._tbx.value;\n    },\n    set: function (e) {\n      var t = (e || \"\").toString();\n      if (t != this.text) {\n        t != this._tbx.value && (this._tbx.value = t);\n        t != this._oldText && (this._oldText = t);\n        this._commitText();\n        this.onTextChanged();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"format\", {\n    get: function () {\n      return this._fmt;\n    },\n    set: function (e) {\n      if (e != this.format) {\n        this._fmt = asString(e);\n        this._refreshText();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"separator\", {\n    get: function () {\n      return this._sep;\n    },\n    set: function (e) {\n      if (e != this._sep) {\n        this._sep = asString(e, !1);\n        this.invalidate();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"mask\", {\n    get: function () {\n      return this._msk.mask;\n    },\n    set: function (e) {\n      this._msk.mask = asString(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"closeOnSelection\", {\n    get: function () {\n      return this._clsOnSel;\n    },\n    set: function (e) {\n      this._clsOnSel = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"handleWheel\", {\n    get: function () {\n      return this._handleWheel;\n    },\n    set: function (e) {\n      e = asBoolean(e);\n      this._handleWheel = e;\n      e || (this.calendar.handleWheel = e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"predefinedRanges\", {\n    get: function () {\n      return this._rngs;\n    },\n    set: function (e) {\n      if (this._rngs != e) {\n        assert(null == e || isObject(e), \"Object expected\");\n        this._rngs = e;\n        this._lbx.itemsSource = this._getRanges(e);\n        this.invalidate();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"alwaysShowCalendar\", {\n    get: function () {\n      return this._showCal;\n    },\n    set: function (e) {\n      this._showCal = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"min\", {\n    get: function () {\n      return this._cal.min;\n    },\n    set: function (e) {\n      this._cal.min = asDate(e, !0);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"max\", {\n    get: function () {\n      return this._cal.max;\n    },\n    set: function (e) {\n      this._cal.max = asDate(e, !0);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"repeatButtons\", {\n    get: function () {\n      return this._cal.repeatButtons;\n    },\n    set: function (e) {\n      this._cal.repeatButtons = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"showYearPicker\", {\n    get: function () {\n      return this._cal.showYearPicker;\n    },\n    set: function (e) {\n      this._cal.showYearPicker = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"showMonthPicker\", {\n    get: function () {\n      return this._cal.showMonthPicker;\n    },\n    set: function (e) {\n      this._cal.showMonthPicker = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"showHeader\", {\n    get: function () {\n      return this._cal.showHeader;\n    },\n    set: function (e) {\n      this._cal.showHeader = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"weeksBefore\", {\n    get: function () {\n      return this._cal.weeksBefore;\n    },\n    set: function (e) {\n      this._cal.weeksBefore = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"weeksAfter\", {\n    get: function () {\n      return this._cal.weeksAfter;\n    },\n    set: function (e) {\n      this._cal.weeksAfter = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"selectionMode\", {\n    get: function () {\n      return this._cal.selectionMode;\n    },\n    set: function (e) {\n      if (e != this.selectionMode) {\n        this._cal.selectionMode = e;\n        this._refreshText();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"monthCount\", {\n    get: function () {\n      return this._cal.monthCount;\n    },\n    set: function (e) {\n      this._cal.monthCount = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"calendar\", {\n    get: function () {\n      return this._cal;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"inputElement\", {\n    get: function () {\n      return this._tbx;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"inputType\", {\n    get: function () {\n      return this._tbx.type;\n    },\n    set: function (e) {\n      e.match(/^(tel|text|)$/i) ? this._tbx.type = asString(e) : console.warn(\"invalid input type '\" + e + \"', don't use any input types other than 'tel' or 'text'\");\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"itemValidator\", {\n    get: function () {\n      return this._cal.itemValidator;\n    },\n    set: function (e) {\n      if (e != this.itemValidator) {\n        this._cal.itemValidator = asFunction(e);\n        this.invalidate();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDate.prototype, \"itemFormatter\", {\n    get: function () {\n      return this._cal.itemFormatter;\n    },\n    set: function (e) {\n      this._cal.itemFormatter = asFunction(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  InputDate.prototype.onValueChanged = function (e) {\n    this.valueChanged.raise(this, e);\n  };\n  InputDate.prototype.onRangeEndChanged = function (e) {\n    this.rangeEndChanged.raise(this, e);\n    this.rangeEnd && (this.isDroppedDown ? this._rangeChanged = !0 : this.onRangeChanged(e));\n  };\n  InputDate.prototype.onRangeChanged = function (e) {\n    this._rangeChanged = !1;\n    this.rangeChanged.raise(this, e);\n  };\n  InputDate.prototype.refresh = function (t) {\n    void 0 === t && (t = !0);\n    e.prototype.refresh.call(this, t);\n    if (this.hostElement) {\n      this._msk && this._msk.refresh();\n      this._cal && this._cal.refresh();\n      this._refreshText();\n    }\n  };\n  InputDate.prototype.onIsDroppedDownChanging = function (t) {\n    if (this.isDroppedDown) {\n      (n = this._cal)._rngMode() && n.value && !n.rangeEnd && (n.rangeEnd = n.value);\n    } else {\n      var i = this._lbx,\n        n = this._cal,\n        o = i.collectionView,\n        s = i.hostElement.style,\n        r = n.hostElement.style;\n      if (n._rngMode() && hasItems(o)) {\n        var a = this._updateRangeSelection();\n        s.display = \"\";\n        r.display = !this._showCal && a && a.from && o.items.some(function (e) {\n          return !e.to;\n        }) ? \"none\" : \"\";\n      } else {\n        s.display = \"none\";\n        r.display = \"\";\n      }\n      n._mthMode() || (n.monthView = !0);\n    }\n    return e.prototype.onIsDroppedDownChanging.call(this, t);\n  };\n  InputDate.prototype.onIsDroppedDownChanged = function (t) {\n    e.prototype.onIsDroppedDownChanged.call(this, t);\n    var i = this.containsFocus();\n    if (this.isDroppedDown) {\n      i && (this._tryFocus(this._cal) || this._tryFocus(this._lbx) || this.dropDown.focus());\n      this._lbx.showSelection();\n      this._cal.refresh();\n    } else {\n      this._commitText();\n      this._rangeChanged && this.onRangeChanged();\n    }\n  };\n  InputDate.prototype._updateDropDown = function () {\n    this._commitText();\n    var t = getComputedStyle(this.hostElement);\n    this._dropDown.style.minWidth = 18 * parseFloat(t.fontSize) + \"px\";\n    this._cal.refresh();\n    e.prototype._updateDropDown.call(this);\n  };\n  InputDate.prototype._keydown = function (t) {\n    if (!(t.defaultPrevented || t.altKey || t.ctrlKey || t.metaKey)) {\n      if (this._isHiddenEditor()) return;\n      switch (t.keyCode) {\n        case Key.Enter:\n          this.isDroppedDown ? this._refreshText() : this._commitText();\n          break;\n        case Key.Escape:\n          this.text = this._getText();\n          this.selectAll();\n          break;\n        case Key.Tab:\n          if (this._cal._rngMode()) {\n            var i = this._tbx,\n              n = this._sep,\n              o = i.value,\n              s = o.indexOf(n);\n            if (s > -1) {\n              var r = o.length,\n                a = i.selectionStart,\n                l = i.selectionEnd,\n                h = null;\n              i.selectionEnd <= s && !t.shiftKey ? h = 0 == a && 0 == l : t.shiftKey && i.selectionStart >= s + n.length && (h = a < r || l < r);\n              if (null != h) {\n                h ? setSelectionRange(i, 0, s) : setSelectionRange(i, s + n.length, r);\n                t.preventDefault();\n              }\n            }\n          }\n          break;\n        case Key.Up:\n        case Key.Down:\n          if (!this.isDroppedDown && this.value && this._canChangeValue()) {\n            var u = t.keyCode == Key.Up ? 1 : -1,\n              c = this.selectionMode == DateSelectionMode.Month ? DateTime.addMonths(this.value, u) : DateTime.addDays(this.value, u);\n            this.value = this._fromDateTime(c);\n            this.selectAll();\n            t.preventDefault();\n          }\n      }\n    }\n    e.prototype._keydown.call(this, t);\n  };\n  InputDate.prototype._expandSelection = function () {\n    if (this._cal._rngMode()) {\n      var t = this._tbx,\n        i = t.value,\n        n = t.selectionStart,\n        o = t.selectionEnd,\n        s = this._sep,\n        r = i.indexOf(s);\n      r > -1 && n == o && (o <= r ? setSelectionRange(t, 0, r) : n >= r + s.length && setSelectionRange(t, r + s.length, t.value.length));\n    } else e.prototype._expandSelection.call(this);\n  };\n  InputDate.prototype._refreshText = function () {\n    var e = this._getText();\n    if (e != this.text || e !== this._oldText) {\n      this._tbx.value = this._oldText = e;\n      this.onTextChanged();\n    }\n  };\n  InputDate.prototype._selectAll = function () {\n    this.isDroppedDown || !this.containsFocus() || this.isTouching || this.selectAll();\n  };\n  InputDate.prototype._closeOnChange = function () {\n    var e = this;\n    if (this._clsOnSel && this._clicked) {\n      var t = this._cal;\n      (!t._rngMode() || t.value && t.rangeEnd) && setTimeout(function () {\n        e.isDroppedDown = !1;\n      });\n    }\n  };\n  InputDate.prototype._tryFocus = function (e) {\n    var t = e.hostElement;\n    if (t && t.offsetHeight) {\n      t.focus();\n      return !0;\n    }\n    return !1;\n  };\n  InputDate.prototype._clamp = function (e) {\n    return this._cal._clamp(e);\n  };\n  InputDate.prototype._getText = function () {\n    var e = Globalize.format,\n      t = this._fmt,\n      i = e(this.value, t);\n    this._cal._rngMode() && i && (i += this._sep + e(this.rangeEnd, t));\n    return i;\n  };\n  InputDate.prototype._commitText = function (e) {\n    var t = this._tbx.value;\n    if (t != this._getText()) {\n      var i = !1,\n        n = this._fmt,\n        o = this._cal,\n        s = Globalize.parseDate;\n      if (t || this.isRequired) {\n        if (o._rngMode()) {\n          var r = t.split(this._sep);\n          if (2 == r.length && r[0]) {\n            if (l = s(r[0], n, this.value)) {\n              var a = s(r[1], n, this.value);\n              o.value = this._fromDateTime(l);\n              o.rangeEnd = a && a >= l ? this._fromDateTime(a) : l;\n              i = !0;\n            }\n          }\n        } else {\n          var l;\n          if (l = s(t, n, this.value)) {\n            this.value = this._fromDateTime(l);\n            i = !0;\n          }\n        }\n      } else {\n        this.value = this.rangeEnd = null;\n        i = !0;\n      }\n      (i || !this._containsFocus() && this.onInvalidInput(new CancelEventArgs())) && (this.text = this._getText());\n    }\n    e || this._selectAll();\n  };\n  InputDate.prototype._fromDateTime = function (e) {\n    return DateTime.fromDateTime(e, this.value);\n  };\n  InputDate.prototype._canChangeValue = function () {\n    return !this.isReadOnly && !this.isDisabled && this.selectionMode != DateSelectionMode.None;\n  };\n  InputDate.prototype._isValidDate = function (e) {\n    if (e) {\n      if (this._clamp(e) != e) return !1;\n      if (this.itemValidator && !this.itemValidator(e)) return !1;\n    }\n    return !0;\n  };\n  InputDate.prototype._getRanges = function (e) {\n    var t = [];\n    if (isObject(e)) for (var i in e) {\n      var n = e[i];\n      t.push({\n        name: i,\n        from: n ? n[0] : null,\n        to: n ? n[1] : null\n      });\n    }\n    return new CollectionView(t, {\n      currentItem: null\n    });\n  };\n  InputDate.prototype._updateRangeSelection = function () {\n    var e = this._lbx,\n      t = -1;\n    if (hasItems(e.collectionView)) for (var i = this._lbx.collectionView.items, n = DateTime.sameDate, o = 0; o < i.length; o++) {\n      var s = i[o];\n      if (s.from) {\n        if (n(s.from, this.value) && n(s.to, this.rangeEnd)) {\n          t = o;\n          break;\n        }\n      } else t = o;\n    }\n    e.selectedIndex = t;\n    return e.selectedItem;\n  };\n  InputDate.prototype._copy = function (e, t) {\n    if (\"text\" === e) {\n      var i = (t || \"\").toString();\n      if (i !== this.text) {\n        this._tbx.value = i;\n        this._textInitialized = !0;\n      }\n      return !0;\n    }\n    return !1;\n  };\n  return InputDate;\n}(DropDown);\nexport { InputDate };\nvar InputDateRange = function (e) {\n  __extends(InputDateRange, e);\n  function InputDateRange(t, i) {\n    var n = e.call(this, t, {\n      selectionMode: DateSelectionMode.Range,\n      showMonthPicker: \"Outside\",\n      monthCount: 2\n    }) || this;\n    addClass(n.hostElement, \"wj-inputdaterange\");\n    n._tbx.value = n._oldText = n._getText();\n    n.initialize(i);\n    if (n._tbx.value !== n._oldText) {\n      n._oldText = n._tbx.value;\n      n._commitText();\n    }\n    return n;\n  }\n  Object.defineProperty(InputDateRange.prototype, \"selectionMode\", {\n    get: function () {\n      return this.calendar.selectionMode;\n    },\n    set: function (e) {\n      e = asEnum(e, DateSelectionMode);\n      assert(e == DateSelectionMode.Range, 'InputDateRange.selectionMode must be \"Range\"');\n      this.calendar.selectionMode = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  return InputDateRange;\n}(InputDate);\nexport { InputDateRange };\nvar InputColor = function (e) {\n  __extends(InputColor, e);\n  function InputColor(t, i) {\n    var n = e.call(this, t) || this;\n    n._textInitialized = !1;\n    n.valueChanged = new Event();\n    addClass(n.hostElement, \"wj-inputcolor\");\n    n._ePreview = createElement('<div class=\"wj-inputcolorbox\"></div>', n.hostElement.firstElementChild);\n    if (\"INPUT\" == n._orgTag) {\n      n._tbx.type = \"\";\n      n._commitText();\n    }\n    n.value = \"#ffffff\";\n    n.isRequired = !0;\n    n._tbx.value = n._oldText = n.value;\n    n.initialize(i);\n    if (n._textInitialized && n._tbx.value !== n._oldText) {\n      n._oldText = n._tbx.value;\n      n.onTextChanged();\n      n._commitText();\n      n._textInitialized = !1;\n    }\n    n.addEventListener(n._colorPicker.hostElement, \"click\", function (e) {\n      var t = e.target;\n      if (t && \"DIV\" == t.tagName && (closest(t, '[wj-part=\"div-pal\"]') || closest(t, '[wj-part=\"div-pv\"]'))) {\n        t.style.backgroundColor && (n.isDroppedDown = !1);\n      }\n    });\n    return n;\n  }\n  Object.defineProperty(InputColor.prototype, \"value\", {\n    get: function () {\n      return this._value;\n    },\n    set: function (e) {\n      this.text = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputColor.prototype, \"text\", {\n    get: function () {\n      return this._tbx.value;\n    },\n    set: function (e) {\n      if ((e = asString(e)) != this.text && (e || !this.isRequired) && (!e || Color.fromString(e))) {\n        this._setText(e, !0);\n        this._commitText();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputColor.prototype, \"showAlphaChannel\", {\n    get: function () {\n      return this._colorPicker.showAlphaChannel;\n    },\n    set: function (e) {\n      this._colorPicker.showAlphaChannel = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputColor.prototype, \"showColorString\", {\n    get: function () {\n      return this._colorPicker.showColorString;\n    },\n    set: function (e) {\n      this._colorPicker.showColorString = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputColor.prototype, \"palette\", {\n    get: function () {\n      return this._colorPicker.palette;\n    },\n    set: function (e) {\n      this._colorPicker.palette = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputColor.prototype, \"colorPicker\", {\n    get: function () {\n      return this._colorPicker;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  InputColor.prototype.onValueChanged = function (e) {\n    this.valueChanged.raise(this, e);\n  };\n  InputColor.prototype.onIsDroppedDownChanged = function (t) {\n    e.prototype.onIsDroppedDownChanged.call(this, t);\n    this.isDroppedDown && !this.isTouching && this.selectAll();\n  };\n  InputColor.prototype._createDropDown = function () {\n    var e = this;\n    this._colorPicker = new ColorPicker(this._dropDown);\n    setCss(this._dropDown, {\n      minWidth: 420,\n      minHeight: 200\n    });\n    this._colorPicker.valueChanged.addHandler(function () {\n      e.value = e._colorPicker.value;\n    });\n  };\n  InputColor.prototype._keydown = function (t) {\n    if (!t.defaultPrevented) switch (t.keyCode) {\n      case Key.Enter:\n        this._commitText();\n        this.selectAll();\n        break;\n      case Key.Escape:\n        this.text = this.value;\n        this.selectAll();\n    }\n    e.prototype._keydown.call(this, t);\n  };\n  InputColor.prototype._commitText = function () {\n    if (this._value != this.text) {\n      if (!this.isRequired && !this.text) {\n        this._value = this.text;\n        this._ePreview.style.backgroundColor = \"\";\n        this.onValueChanged();\n        return;\n      }\n      if (Color.fromString(this.text)) {\n        var e = this._colorPicker;\n        e.value = this.text;\n        this._value = e.value;\n        this._ePreview.style.backgroundColor = this.value;\n        this.onValueChanged();\n      } else this.onInvalidInput(new CancelEventArgs()) && (this.text = this._value ? this._value : \"\");\n    }\n  };\n  InputColor.prototype._copy = function (e, t) {\n    if (\"text\" === e) {\n      var i = (t || \"\").toString();\n      if (i !== this.text) {\n        this._tbx.value = i;\n        this._textInitialized = !0;\n      }\n      return !0;\n    }\n    return !1;\n  };\n  return InputColor;\n}(DropDown);\nexport { InputColor };\nvar ComboBox = function (e) {\n  __extends(ComboBox, e);\n  function ComboBox(t, i) {\n    var n = e.call(this, t) || this;\n    n._editable = !1;\n    n._trimText = !0;\n    n._handleWheel = !0;\n    n._delKey = 0;\n    n._draggingText = !1;\n    n._pathHdr = new Binding(null);\n    n._bsCollapse = !0;\n    n._fmtItemHandlers = 0;\n    n._emptyValueAction = !1;\n    n._oldIndexToBeRestoredOnBlur = null;\n    n._restoreComboboxTbxVal = !1;\n    n._isWheel = !1;\n    n.itemsSourceChanged = new Event();\n    n.selectedIndexChanged = new Event();\n    var o = n.hostElement;\n    addClass(o, \"wj-combobox\");\n    n.dropDown.id = getUniqueId(o.id + \"_dropdown\");\n    n.autoExpandSelection = !1;\n    var s = n._tbx;\n    n.addEventListener(s, \"compositionstart\", function () {\n      n._composing = !0;\n    });\n    n.addEventListener(s, \"compositionend\", function () {\n      n._composing = !1;\n      n._setText(n.text, !0);\n    });\n    n.addEventListener(s, \"drag\", function () {\n      n._draggingText = !0;\n    });\n    n.addEventListener(o, \"wheel\", n._wheel.bind(n));\n    \"SELECT\" == n._orgTag && n._lbx._initFromSelect(o);\n    var r = n._lbx;\n    r.loadedItems.addHandler(function (e) {\n      n.selectedIndex > -1 && (n.selectedIndex = r.selectedIndex);\n    });\n    n.isRequired = !0;\n    n.initialize(i);\n    return n;\n  }\n  Object.defineProperty(ComboBox.prototype, \"itemsSource\", {\n    get: function () {\n      return this._lbx.itemsSource;\n    },\n    set: function (e) {\n      if (this._lbx.itemsSource != e) {\n        this._lbx.itemsSource = e;\n        this.onItemsSourceChanged();\n      }\n      this._updateBtn();\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ComboBox.prototype, \"collectionView\", {\n    get: function () {\n      return this._lbx.collectionView;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ComboBox.prototype, \"virtualizationThreshold\", {\n    get: function () {\n      return this._lbx.virtualizationThreshold;\n    },\n    set: function (e) {\n      this._lbx.virtualizationThreshold = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ComboBox.prototype, \"showGroups\", {\n    get: function () {\n      return this._lbx.showGroups;\n    },\n    set: function (e) {\n      this._lbx.showGroups = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ComboBox.prototype, \"displayMemberPath\", {\n    get: function () {\n      return this._lbx.displayMemberPath;\n    },\n    set: function (e) {\n      this._lbx.displayMemberPath = e;\n      var t = this.getDisplayText();\n      this.text != t && this._setText(t, !0);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ComboBox.prototype, \"headerPath\", {\n    get: function () {\n      return this._pathHdr.path;\n    },\n    set: function (e) {\n      this._pathHdr.path = asString(e);\n      var t = this.getDisplayText();\n      this.text != t && this._setText(t, !0);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ComboBox.prototype, \"selectedValuePath\", {\n    get: function () {\n      return this._lbx.selectedValuePath;\n    },\n    set: function (e) {\n      this._lbx.selectedValuePath = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ComboBox.prototype, \"isContentHtml\", {\n    get: function () {\n      return this._lbx.isContentHtml;\n    },\n    set: function (e) {\n      if (e != this.isContentHtml) {\n        this._lbx.isContentHtml = asBoolean(e);\n        var t = this.getDisplayText();\n        this.text != t && this._setText(t, !0);\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ComboBox.prototype, \"caseSensitiveSearch\", {\n    get: function () {\n      return this._lbx.caseSensitiveSearch;\n    },\n    set: function (e) {\n      this._lbx.caseSensitiveSearch = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ComboBox.prototype, \"trimText\", {\n    get: function () {\n      return this._trimText;\n    },\n    set: function (e) {\n      if (e != this._trimText) {\n        this._trimText = asBoolean(e);\n        this.invalidate();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ComboBox.prototype, \"itemFormatter\", {\n    get: function () {\n      return this._lbx.itemFormatter;\n    },\n    set: function (e) {\n      this._lbx.itemFormatter = asFunction(e);\n      this.selectedIndex = this._lbx.selectedIndex;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ComboBox.prototype, \"formatItem\", {\n    get: function () {\n      return this._lbx.formatItem;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ComboBox.prototype, \"selectedIndex\", {\n    get: function () {\n      return this._lbx.selectedIndex;\n    },\n    set: function (e) {\n      e != this.selectedIndex && isNumber(e) && (this._lbx.selectedIndex = e);\n      var t = this._lbx._oldSelectedIndex != this.selectedIndex;\n      e = this.selectedIndex;\n      var i = this.getDisplayText(e);\n      if (this.text != i || t) {\n        var n = this._internalSettingText;\n        this._internalSettingText = this._lbx._ignoredItemChangedEvents;\n        this._setText(i, !0);\n        \"\" != this.text && (this._emptyValueAction = !1);\n        this._internalSettingText = n;\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ComboBox.prototype, \"selectedItem\", {\n    get: function () {\n      return this._lbx.selectedItem;\n    },\n    set: function (e) {\n      this._lbx.selectedItem = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ComboBox.prototype, \"selectedValue\", {\n    get: function () {\n      return this.collectionView ? this._lbx.selectedValue : this.text;\n    },\n    set: function (e) {\n      this.collectionView ? this._lbx.selectedValue = e : null != e && (this.text = e.toString());\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ComboBox.prototype, \"isEditable\", {\n    get: function () {\n      return this._editable;\n    },\n    set: function (e) {\n      this._editable = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ComboBox.prototype, \"handleWheel\", {\n    get: function () {\n      return this._handleWheel;\n    },\n    set: function (e) {\n      this._handleWheel = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ComboBox.prototype, \"maxDropDownHeight\", {\n    get: function () {\n      return this._lbx.maxHeight;\n    },\n    set: function (e) {\n      this._lbx.maxHeight = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(ComboBox.prototype, \"maxDropDownWidth\", {\n    get: function () {\n      var e = this._dropDown,\n        t = e ? parseInt(e.style.maxWidth) : null;\n      return isNaN(t) ? null : t;\n    },\n    set: function (e) {\n      var t = this._dropDown.style;\n      e = asNumber(e, !0);\n      t.maxWidth = null == e ? \"\" : e + \"px\";\n      t.minWidth = \"\";\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  ComboBox.prototype.getDisplayText = function (e, t) {\n    void 0 === e && (e = this.selectedIndex);\n    void 0 === t && (t = this._trimText);\n    var i,\n      n = this.collectionView;\n    if (this.headerPath && e > -1 && hasItems(n)) {\n      var o = n.items[e];\n      i = null != (i = o ? this._pathHdr.getValue(o) : null) ? i.toString() : \"\";\n      this.isContentHtml && (i = toPlainText(i));\n    } else i = this._lbx.getDisplayText(e);\n    return t ? i.trim() : i;\n  };\n  ComboBox.prototype.indexOf = function (e, t, i) {\n    void 0 === i && (i = !1);\n    var n = this.collectionView,\n      o = this.caseSensitiveSearch;\n    if (hasItems(n) && null != e) {\n      e = e.toString();\n      o || (e = e.toLowerCase());\n      if (this._trimText && !i) {\n        -1 !== this.indexOf(e, !1, !0) || (e = e.trim());\n      }\n      var s = this.selectedIndex,\n        r = this.getDisplayText(s);\n      if (t) {\n        o || (r = r.toLowerCase());\n        if (e == r) return s;\n      } else if (!e && \"\" == r) return s;\n      for (var a = 0; a < n.items.length; a++) if (this._lbx.isItemEnabled(a)) {\n        r = this.getDisplayText(a);\n        this.trimText && (r = r.trim());\n        o || (r = r.toLowerCase());\n        if (t) {\n          if (r == e && !1 === this._emptyValueAction) return a;\n        } else if (e && 0 == r.indexOf(e) || !e && \"\" == r && !1 === this._emptyValueAction) return a;\n      }\n    }\n    return -1;\n  };\n  Object.defineProperty(ComboBox.prototype, \"listBox\", {\n    get: function () {\n      return this._lbx;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  ComboBox.prototype.onItemsSourceChanged = function (e) {\n    this.itemsSourceChanged.raise(this, e);\n  };\n  ComboBox.prototype.onSelectedIndexChanged = function (e) {\n    this._updateBtn();\n    this.selectedIndexChanged.raise(this, e);\n  };\n  ComboBox.prototype.refresh = function (t) {\n    void 0 === t && (t = !0);\n    e.prototype.refresh.call(this, t);\n    if (this.hostElement && hasItems(this.collectionView)) {\n      this._lbx.refresh();\n      this.selectedIndex > -1 && (this.selectedIndex = this._lbx.selectedIndex);\n    }\n  };\n  ComboBox.prototype.onLostFocus = function (t, i, n) {\n    if (this._composing) {\n      this._composing = !1;\n      this._setText(this.text, !0);\n    }\n    if ((!this.text && this.isRequired || n) && hasItems(this.collectionView)) {\n      void 0 !== i && (this.selectedIndex = -1 !== i ? i : 0);\n      null !== this._oldIndexToBeRestoredOnBlur && (this.selectedIndex = -1 !== this._oldIndexToBeRestoredOnBlur ? this._oldIndexToBeRestoredOnBlur : 0);\n    }\n    var o = this.text,\n      s = this.collectionView ? this.collectionView.items.length : 0;\n    e.prototype.onLostFocus.call(this, t);\n    var r = this.collectionView ? this.collectionView.items.length : 0;\n    this._trySelectionUpdateOnItemsSourceChanged(r !== s, o);\n  };\n  ComboBox.prototype.onIsDroppedDownChanging = function (t) {\n    if (!this.isDroppedDown && !this._hasItems()) {\n      t.cancel = !0;\n      return !1;\n    }\n    return e.prototype.onIsDroppedDownChanging.call(this, t);\n  };\n  ComboBox.prototype.onIsDroppedDownChanged = function (t) {\n    e.prototype.onIsDroppedDownChanged.call(this, t);\n    if (this.isDroppedDown) {\n      this._fmtItemHandlers = this.formatItem.handlerCount;\n      this._lbx.showSelection();\n    }\n    this._updateAria();\n  };\n  ComboBox.prototype._trySelectionUpdateOnItemsSourceChanged = function (e, t) {\n    if (e && t) {\n      var i = this.indexOf(t, !0);\n      i < 0 && (i = this.indexOf(t, !1));\n      this.selectedIndex = i;\n    }\n  };\n  ComboBox.prototype._setIsDisabled = function (t) {\n    e.prototype._setIsDisabled.call(this, t);\n    this._updateBtn();\n  };\n  ComboBox.prototype._updateBtn = function () {\n    var t = this.collectionView,\n      i = this._tbx,\n      n = this._hasItems();\n    e.prototype._updateBtn.call(this);\n    this._btn.style.display = this._showBtn && null != t ? \"\" : \"none\";\n    enable(this._btn, n && !this.isDisabled);\n    setAttribute(i, \"role\", n ? \"combobox\" : null);\n    setAttribute(i, \"aria-autocomplete\", n ? \"both\" : null);\n    this._updateAria();\n  };\n  ComboBox.prototype._hasItems = function () {\n    return hasItems(this.collectionView);\n  };\n  ComboBox.prototype._updateAria = function () {\n    var e = this._tbx,\n      t = this.isDroppedDown,\n      i = this.dropDown ? this.dropDown.id : null,\n      n = i && hasItems(this.collectionView);\n    setAttribute(e, \"aria-owns\", n && t ? i : null);\n    setAttribute(e, \"aria-expanded\", n ? t : null);\n  };\n  ComboBox.prototype._createDropDown = function () {\n    var e = this;\n    if (!this._lbx) {\n      this._lbx = new ListBox(this._dropDown);\n      this._lbx._container = this.hostElement;\n    }\n    this._lbx.maxHeight = 200;\n    this._lbx.selectedIndexChanged.addHandler(function () {\n      e._updateBtn();\n      var t = e._lbx.selectedIndex,\n        i = e._lbx.hostElement.children,\n        n = t > -1 && t < i.length ? i[t].id : null;\n      setAttribute(e._tbx, \"aria-activedescendant\", n && n.length ? n : null);\n      e.selectedIndex = t;\n      e.onSelectedIndexChanged();\n    });\n    this._lbx.itemsChanged.addHandler(function () {\n      e._updateBtn();\n    });\n  };\n  ComboBox.prototype._wheel = function (e) {\n    this._isWheel = !0;\n    if (this.handleWheel && !e.defaultPrevented && !this.isDroppedDown && !this.isReadOnly && this.containsFocus() && this.selectedIndex > -1) {\n      var t = this._findNext(\"\", e.deltaY > 0 ? 1 : -1);\n      t > -1 && (this.selectedIndex = t);\n      e.preventDefault();\n    }\n    this._isWheel = !1;\n  };\n  ComboBox.prototype._dropDownClick = function (t) {\n    t.defaultPrevented || t.target != this._dropDown && (this.isDroppedDown = !1);\n    this._restoreComboboxTbxVal && (this._tbx.value = this.getDisplayText(this.selectedIndex));\n    e.prototype._dropDownClick.call(this, t);\n  };\n  ComboBox.prototype._setText = function (t, i) {\n    if (!this._composing && !this._settingText) {\n      this._settingText = !0;\n      if (this.containsFocus()) {\n        var n = this.formatItem.handlerCount;\n        if (this._fmtItemHandlers != n) {\n          this._fmtItemHandlers = n;\n          this._lbx.loadList();\n        }\n      }\n      null == t && (t = \"\");\n      t = t.toString();\n      var o = this.selectedIndex,\n        s = this.collectionView,\n        r = this._getSelStart(),\n        a = -1,\n        l = !0;\n      if (this.isEditable && (this._delKey || this._getSelEnd() < t.length || !this.containsFocus())) {\n        i = !0;\n        l = !1;\n      }\n      o = this.indexOf(t, i);\n      if (l) {\n        o < 0 && i && (o = this.indexOf(t, !1));\n        o < 0 && r > 0 && (o = this.indexOf(t.substr(0, r), !1));\n      }\n      o < 0 && this._delKey && (o = this.indexOf(t, !1));\n      if (o < 0 && !this.isEditable && hasItems(s) && (t || this.isRequired)) {\n        var h = this._oldText || \"\";\n        o = Math.max(0, this.indexOf(h, !1));\n        r = 0;\n        for (var u = 0; u < t.length && u < h.length; u++) if (t[u] != h[u]) {\n          r = u;\n          break;\n        }\n      }\n      if ((!this._delKey || !this.isEditable || this._delKey && this.isEditable && t == this.getDisplayText(o)) && (!this._pristine || this._pristine && !this.isEditable) || this._isWheel || this._delKey && \"\" == t && o > -1) {\n        if (o > -1) {\n          a = r;\n          t = this.getDisplayText(o);\n        }\n        var c = this._tbx;\n        t != c.value && (c.value = t);\n        a > -1 && this.containsFocus() && !this.isTouching && this._updateInputSelection(a);\n      }\n      if (s) {\n        if (!t) if (o > -1) this._oldIndexToBeRestoredOnBlur = o;else {\n          this._oldIndexToBeRestoredOnBlur = this.indexOf(this._oldText, !0);\n          this._oldIndexToBeRestoredOnBlur = this._oldIndexToBeRestoredOnBlur < 0 ? this.indexOf(this._oldText, !1) : this._oldIndexToBeRestoredOnBlur;\n        }\n        this._restoreComboboxTbxVal = t && o > -1;\n        s.moveCurrentToPosition(o);\n      }\n      this._delKey = 0;\n      this._settingText = !1;\n      e.prototype._setText.call(this, t, i);\n    }\n  };\n  ComboBox.prototype._findNext = function (e, t, i) {\n    void 0 === i && (i = this.selectedIndex);\n    var n = this.collectionView,\n      o = n ? n.items.length : 0,\n      s = this._lbx,\n      r = this.caseSensitiveSearch;\n    if (n && o && t) {\n      r || (e = e.toLowerCase());\n      for (var a = i + t; a > -1 && a < o; a += t) {\n        var l = this.getDisplayText(a);\n        r || (l = l.toLowerCase());\n        if (0 == l.indexOf(e)) {\n          if (!this.dropDown.children[a] || s.isItemEnabled(a)) return a;\n        }\n      }\n    }\n    return i;\n  };\n  ComboBox.prototype._keydown = function (t) {\n    e.prototype._keydown.call(this, t);\n    if (!t.defaultPrevented && !this.isReadOnly && !t.altKey && hasItems(this.collectionView) && this._elRef == this._tbx && !this._isHiddenEditor()) {\n      this._delKey = 0;\n      var i = this._getSelStart(),\n        n = this._getSelEnd();\n      switch (t.keyCode) {\n        case Key.Back:\n        case Key.Delete:\n        case 88:\n          if (!t.ctrlKey && !t.metaKey && 88 == t.keyCode) break;\n          if (this._bsCollapse && !this.isEditable && i > 0 && n == this._tbx.value.length && hasItems(this.collectionView)) {\n            this._setSelRange(i - 1, n);\n            i -= 1;\n          }\n          this._delKey = t.keyCode;\n          break;\n        case Key.Up:\n        case Key.Down:\n          i == this.text.length && (i = 0);\n          this.selectedIndex = this._findNext(this.text.substr(0, i), t.keyCode == Key.Up ? -1 : 1);\n          this._setSelRange(i, this.text.length);\n          t.preventDefault();\n          break;\n        case Key.PageUp:\n          this._lbx._selectPrevPage();\n          this.selectAll();\n          t.preventDefault();\n          break;\n        case Key.PageDown:\n          this._lbx._selectNextPage();\n          this.selectAll();\n          t.preventDefault();\n      }\n      this.text.length > 0 && [\"Backspace\", \"Delete\", \"x\"].includes(t.key) && 0 === i && n === this.text.length || this._delKey && 1 === this.text.length ? this._emptyValueAction = !0 : this._composing || (this._emptyValueAction = !1);\n    }\n  };\n  ComboBox.prototype._input = function (e) {\n    this._draggingText && (\"\" === this.text ? this._emptyValueAction = !0 : this._emptyValueAction = !1);\n    this._setText(this.text, !1);\n    this._draggingText = !1;\n  };\n  ComboBox.prototype._updateInputSelection = function (e) {\n    var t = this._tbx;\n    this._elRef == t && this._setSelRange(e, t.value.length);\n  };\n  ComboBox.prototype._getSelStart = function () {\n    var e = this._tbx;\n    return e && e.value ? e.selectionStart : 0;\n  };\n  ComboBox.prototype._getSelEnd = function () {\n    var e = this._tbx;\n    return e && e.value ? e.selectionEnd : 0;\n  };\n  ComboBox.prototype._setSelRange = function (e, t) {\n    var i = this._tbx;\n    this._elRef != i || i.readOnly || setSelectionRange(i, e, t);\n  };\n  return ComboBox;\n}(DropDown);\nexport { ComboBox };\n_addCultureInfo(\"MultiSelect\", {\n  itemsSelected: \"{count:n0} items selected\",\n  selectAll: \"Select All\"\n});\nvar MultiSelect = function (e) {\n  __extends(MultiSelect, e);\n  function MultiSelect(t, i) {\n    var n = e.call(this, t) || this;\n    n._maxHdrItems = 2;\n    n._readOnly = !1;\n    n._hdrFmt = null;\n    n.checkedItemsChanged = new Event();\n    addClass(n.hostElement, \"wj-multiselect\");\n    n._tbx.readOnly = !0;\n    n.checkedMemberPath = null;\n    n.removeEventListener(n.dropDown, \"click\");\n    n._lbx.itemsChanged.addHandler(function () {\n      n._updateHeader(!1);\n    });\n    n._lbx.checkedItemsChanged.addHandler(function () {\n      n._updateHeader(!1);\n      n.onCheckedItemsChanged();\n    });\n    n.clickAction = ClickAction.Toggle;\n    n.initialize(i);\n    return n;\n  }\n  Object.defineProperty(MultiSelect.prototype, \"showSelectAllCheckbox\", {\n    get: function () {\n      return this._msLbx.showSelectAllCheckbox;\n    },\n    set: function (e) {\n      this._msLbx.showSelectAllCheckbox = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelect.prototype, \"showFilterInput\", {\n    get: function () {\n      return this._msLbx.showFilterInput;\n    },\n    set: function (e) {\n      this._msLbx.showFilterInput = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelect.prototype, \"delay\", {\n    get: function () {\n      return this._msLbx.delay;\n    },\n    set: function (e) {\n      this._msLbx.delay = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelect.prototype, \"caseSensitiveSearch\", {\n    get: function () {\n      return this._msLbx.caseSensitiveSearch;\n    },\n    set: function (e) {\n      this._msLbx.caseSensitiveSearch = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelect.prototype, \"filterInputPlaceholder\", {\n    get: function () {\n      return this._msLbx.filterInputPlaceholder;\n    },\n    set: function (e) {\n      this._msLbx.filterInputPlaceholder = asString(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelect.prototype, \"checkOnFilter\", {\n    get: function () {\n      return this._msLbx.checkOnFilter;\n    },\n    set: function (e) {\n      if (e != this.checkOnFilter) {\n        this._msLbx.checkOnFilter = asBoolean(e);\n        this.checkedItems = [];\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelect.prototype, \"selectAllLabel\", {\n    get: function () {\n      return this._msLbx.selectAllLabel;\n    },\n    set: function (e) {\n      this._msLbx.selectAllLabel = asString(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelect.prototype, \"checkedMemberPath\", {\n    get: function () {\n      return this._msLbx.checkedMemberPath;\n    },\n    set: function (e) {\n      this._msLbx.checkedMemberPath = asString(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelect.prototype, \"maxHeaderItems\", {\n    get: function () {\n      return this._maxHdrItems;\n    },\n    set: function (e) {\n      if (this._maxHdrItems != e) {\n        this._maxHdrItems = asNumber(e);\n        this._updateHeader();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelect.prototype, \"headerFormat\", {\n    get: function () {\n      return this._hdrFmt;\n    },\n    set: function (e) {\n      if (e != this._hdrFmt) {\n        this._hdrFmt = asString(e);\n        this._updateHeader();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelect.prototype, \"headerFormatter\", {\n    get: function () {\n      return this._hdrFormatter;\n    },\n    set: function (e) {\n      if (e != this._hdrFormatter) {\n        this._hdrFormatter = asFunction(e);\n        this._updateHeader();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiSelect.prototype, \"checkedItems\", {\n    get: function () {\n      return this._msLbx.checkedItems;\n    },\n    set: function (e) {\n      this._msLbx.checkedItems = null == e ? [] : asArray(e);\n      this._updateHeader();\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  MultiSelect.prototype.onCheckedItemsChanged = function (e) {\n    this.checkedItemsChanged.raise(this, e);\n  };\n  MultiSelect.prototype.dispose = function () {\n    this._lbx.dispose();\n    e.prototype.dispose.call(this);\n  };\n  MultiSelect.prototype.onIsDroppedDownChanged = function (t) {\n    var i = this;\n    e.prototype.onIsDroppedDownChanged.call(this, t);\n    setTimeout(function () {\n      if (i.isDroppedDown && i.containsFocus()) if (i.showFilterInput && !i.isTouching) i._msLbx._filter.focus();else {\n        var e = i.listBox;\n        if (e.selectedIndex < 0) {\n          var t = 0,\n            n = e.checkedItems;\n          n.length && (t = e.collectionView.items.indexOf(n[0]));\n          e.selectedIndex = Math.max(0, t);\n        }\n        e.showSelection(!0);\n        e.focus();\n      }\n    });\n  };\n  MultiSelect.prototype.onLostFocus = function () {\n    this._msLbx.onLostFocus();\n    this.isDroppedDown = !1;\n    e.prototype.onLostFocus.call(this);\n  };\n  MultiSelect.prototype._createDropDown = function () {\n    var t = createElement(\"<div></div>\", this._dropDown);\n    this._msLbx = new MultiSelectListBox(t);\n    this._lbx = this._msLbx.listBox;\n    e.prototype._createDropDown.call(this);\n  };\n  Object.defineProperty(MultiSelect.prototype, \"isReadOnly\", {\n    get: function () {\n      return this._readOnly;\n    },\n    set: function (e) {\n      this._readOnly = asBoolean(e);\n      toggleClass(this.hostElement, \"wj-state-readonly\", this.isReadOnly);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  MultiSelect.prototype.refresh = function (t) {\n    void 0 === t && (t = !0);\n    e.prototype.refresh.call(this, t);\n    this.hostElement && this._updateHeader();\n  };\n  MultiSelect.prototype._setText = function (e, t) {};\n  MultiSelect.prototype._keydown = function (t) {\n    e.prototype._keydown.call(this, t);\n    hasClass(this._tbx, \"wj-grid-ime\") || !t.defaultPrevented && hasItems(this.collectionView) && t.keyCode > 32 && (this.isDroppedDown = !0);\n  };\n  MultiSelect.prototype._hasItems = function () {\n    var e = this.collectionView,\n      t = e ? e.sourceCollection : null;\n    return hasItems(e) || t && t.length && this.showFilterInput;\n  };\n  MultiSelect.prototype._updateHeader = function (e) {\n    void 0 === e && (e = !0);\n    var t = \"\";\n    if (isFunction(this._hdrFormatter)) t = this._hdrFormatter(this);else {\n      var i = this.checkedItems;\n      if (i.length > 0) if (i.length <= this._maxHdrItems) {\n        if (this.headerPath) {\n          var n = new Binding(this.headerPath);\n          i = i.map(function (e) {\n            return n.getValue(e);\n          });\n        } else if (this.displayMemberPath) {\n          var o = new Binding(this.displayMemberPath);\n          i = i.map(function (e) {\n            return o.getValue(e);\n          });\n        }\n        this.isContentHtml && (i = i.map(function (e) {\n          return toPlainText(e);\n        }));\n        this.trimText && (i = i.map(function (e) {\n          return e ? e.toString().trim() : \"\";\n        }));\n        t = i.join(\", \");\n      } else t = format(this.headerFormat || culture.MultiSelect.itemsSelected, {\n        count: i.length\n      });\n    }\n    var s = this.inputElement;\n    if (t != s.value) {\n      s.value = t;\n      this.onTextChanged();\n    }\n    e && this._lbx._updateCheckedList(this.checkedItems);\n    this._updateState();\n  };\n  MultiSelect._DEF_CHECKED_PATH = \"$checked\";\n  return MultiSelect;\n}(ComboBox);\nexport { MultiSelect };\nvar Menu = function (e) {\n  __extends(Menu, e);\n  function Menu(t, i) {\n    var n = e.call(this, t) || this;\n    n._closing = !1;\n    n._cmd = null;\n    n._cmdPath = null;\n    n._cmdParamPath = null;\n    n._subPath = null;\n    n._owner = null;\n    n._isButton = !1;\n    n._openOnHover = !1;\n    n._closeOnLeave = !0;\n    n._subMenu = null;\n    n._hoverEnterBnd = n._hoverEnter.bind(n);\n    n._hoverLeaveBnd = n._hoverLeave.bind(n);\n    n._hoverOverBnd = n._hoverOver.bind(n);\n    n.itemClicked = new Event();\n    var o = n.hostElement,\n      s = n._tbx,\n      r = n._lbx,\n      a = n.dropDown;\n    addClass(o, \"wj-menu\");\n    s.style.display = \"none\";\n    n._hdr = n._elRef = createElement('<div wj-part=\"header\" class=\"wj-form-control\"/>');\n    s.parentElement.insertBefore(n._hdr, n._tbx);\n    o.tabIndex = n.isDisabled ? -1 : n._orgTabIndex;\n    n.isRequired = !1;\n    setAttribute(o, \"role\", \"menubar\", !0);\n    setAttribute(s, \"role\", null);\n    setAttribute(s, \"aria-autocomplete\", null);\n    setAttribute(s, \"aria-owns\", null);\n    setAttribute(a, \"role\", \"menu\");\n    r.itemRole = \"menuitem\";\n    if (\"SELECT\" == n._orgTag) {\n      n.header = o.getAttribute(\"header\");\n      n._lbx.itemsSource && (n.commandParameterPath = \"cmdParam\");\n    }\n    n.isContentHtml = !0;\n    n.maxDropDownHeight = 500;\n    n.addEventListener(n._hdr, \"click\", function (e) {\n      if (!e.defaultPrevented) {\n        n._clearHover(e);\n        if (n._isButton) {\n          n.isDroppedDown = !1;\n          n._raiseCommand();\n        } else n.isDroppedDown = !n.isDroppedDown;\n      }\n    });\n    r.lostFocus.addHandler(function () {\n      n.containsFocus() || (n.isDroppedDown = !1);\n    });\n    addClass(a, \"wj-menu-items\");\n    r.formatItem.addHandler(n._formatMenuItem.bind(n));\n    n.initialize(i);\n    return n;\n  }\n  Object.defineProperty(Menu.prototype, \"header\", {\n    get: function () {\n      return this._hdr.innerHTML;\n    },\n    set: function (e) {\n      this._hdr.innerHTML = asString(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Menu.prototype, \"command\", {\n    get: function () {\n      return this._cmd;\n    },\n    set: function (e) {\n      this._cmd = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Menu.prototype, \"commandPath\", {\n    get: function () {\n      return this._cmdPath;\n    },\n    set: function (e) {\n      this._cmdPath = asString(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Menu.prototype, \"commandParameterPath\", {\n    get: function () {\n      return this._cmdParamPath;\n    },\n    set: function (e) {\n      this._cmdParamPath = asString(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Menu.prototype, \"subItemsPath\", {\n    get: function () {\n      return this._subPath;\n    },\n    set: function (e) {\n      if (e != this._subPath) {\n        this._subPath = e;\n        this.refresh(!0);\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Menu.prototype, \"openOnHover\", {\n    get: function () {\n      return this._openOnHover;\n    },\n    set: function (e) {\n      this._openOnHover = asBoolean(e);\n      this._updateHoverEvents();\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Menu.prototype, \"closeOnLeave\", {\n    get: function () {\n      return this._closeOnLeave;\n    },\n    set: function (e) {\n      this._closeOnLeave = asBoolean(e);\n      this._updateHoverEvents();\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Menu.prototype, \"isButton\", {\n    get: function () {\n      return this._isButton;\n    },\n    set: function (e) {\n      this._isButton = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(Menu.prototype, \"owner\", {\n    get: function () {\n      return this._owner;\n    },\n    set: function (e) {\n      this._owner = asType(e, HTMLElement, !0);\n      this._enableDisableItems();\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Menu.prototype.show = function (e) {\n    if (!this.isDroppedDown) {\n      var t = this._lbx._ignoredItemChangedEvents;\n      this._lbx._ignoredItemChangedEvents = !0;\n      this.selectedIndex = -1;\n      this._lbx._ignoredItemChangedEvents = t;\n      if (this.onIsDroppedDownChanging(new CancelEventArgs())) {\n        var i = this.dropDown,\n          n = this.owner;\n        !n && e instanceof MouseEvent && (n = e.target);\n        n instanceof HTMLElement && (i[Control._OWNR_KEY] = n);\n        if (e instanceof MouseEvent && this.openOnHover && this.closeOnLeave) {\n          e = new Point(e.pageX - pageXOffset - 2, e.pageY - pageYOffset - 2);\n        }\n        showPopup(i, e, !1, this.isAnimated);\n        this.onIsDroppedDownChanged();\n        i.focus();\n      }\n    }\n  };\n  Menu.prototype.hide = function () {\n    if (this.isDroppedDown && this.onIsDroppedDownChanging(new CancelEventArgs())) {\n      hidePopup(this.dropDown);\n      this.onIsDroppedDownChanged();\n    }\n  };\n  Menu.prototype.onItemClicked = function (e) {\n    this.itemClicked.raise(this, e);\n  };\n  Menu.prototype.refresh = function (t) {\n    void 0 === t && (t = !0);\n    e.prototype.refresh.call(this, t);\n    this.hostElement && this._enableDisableItems();\n  };\n  Menu.prototype.onIsDroppedDownChanged = function (t) {\n    e.prototype.onIsDroppedDownChanged.call(this, t);\n    if (this.isDroppedDown) {\n      this._closing = !0;\n      var i = this._lbx._ignoredItemChangedEvents;\n      this._lbx._ignoredItemChangedEvents = !0;\n      this._defaultItem = this.selectedItem;\n      this.isRequired = !1;\n      this.selectedIndex = -1;\n      this._enableDisableItems();\n      this._closing = !1;\n      this._lbx._ignoredItemChangedEvents = i;\n      this.dropDown.focus();\n    } else {\n      if (!this.selectedItem) {\n        var n = this._lbx._checking;\n        this._lbx._checking = !0;\n        this.selectedItem = this._defaultItem;\n        this._lbx._checking = n;\n      }\n      var o = this._subMenu;\n      o && (o.isDroppedDown = !1);\n    }\n  };\n  Menu.prototype._updateHoverEvents = function () {\n    var e = this.hostElement,\n      t = this.dropDown,\n      i = this.addEventListener.bind(this),\n      n = this.removeEventListener.bind(this),\n      o = \"mouseleave\";\n    n(e, \"mouseenter\", this._hoverEnterBnd);\n    n(e, o, this._hoverLeaveBnd);\n    n(t, \"mouseover\", this._hoverOverBnd);\n    n(t, o, this._hoverLeaveBnd);\n    if (this._openOnHover) {\n      i(e, \"mouseenter\", this._hoverEnterBnd);\n      i(t, \"mouseover\", this._hoverOverBnd);\n      if (this._closeOnLeave) {\n        i(e, o, this._hoverLeaveBnd);\n        i(t, o, this._hoverLeaveBnd);\n      }\n    }\n  };\n  Menu.prototype._getSubItems = function (e) {\n    var t = this.subItemsPath,\n      i = e && t ? e[t] : null;\n    return isArray(i) && i.length ? i : null;\n  };\n  Menu.prototype._formatMenuItem = function (e, t) {\n    var i = t.item;\n    if (this._getSubItems(t.data)) addClass(i, \"wj-subitems\");else if (\"-\" == i.innerHTML) {\n      i.innerHTML = \"\";\n      addClass(i, \"wj-separator\");\n    }\n  };\n  Menu.prototype._keydown = function (t) {\n    if (!t.defaultPrevented) {\n      var i = this._getKeyCode(t);\n      if (this.isDroppedDown) switch (i) {\n        case Key.Enter:\n        case Key.Right:\n          if (this._showSubMenu()) {\n            t.preventDefault();\n            return;\n          }\n          break;\n        case Key.Left:\n          var n = Control.getControl(this.owner);\n          if (n instanceof Menu) {\n            var o = n.dropDown,\n              s = n.selectedIndex;\n            (s > -1 ? o.children[s] : o).focus();\n            t.preventDefault();\n            return;\n          }\n      }\n      if (i == Key.Enter) if (this.isDroppedDown) this.selectedIndex > -1 && this._raiseCommand();else {\n        this.isDroppedDown = !0;\n        t.preventDefault();\n      }\n    }\n    e.prototype._keydown.call(this, t);\n  };\n  Menu.prototype._dropDownClick = function (t) {\n    if (!t.defaultPrevented && t.target != this.dropDown) {\n      this._clearHover(t);\n      if (this._showSubMenu()) {\n        t.preventDefault();\n        return;\n      }\n      this.selectedIndex > -1 && this._raiseCommand();\n    }\n    e.prototype._dropDownClick.call(this, t);\n  };\n  Menu.prototype._showSubMenu = function () {\n    var e = this,\n      t = this._getSubItems(this.selectedItem);\n    if (!t) return null;\n    var i = this.dropDown.children[this.selectedIndex].getBoundingClientRect(),\n      n = new Point(i.right, i.top);\n    if (0 == i.height) return null;\n    var o = this.rightToLeft || \"rtl\" == this.dropDown.getAttribute(\"dir\");\n    o && (n.x = i.left);\n    var s = this._subMenu;\n    s && (s.isDroppedDown = !1);\n    s = new Menu(document.createElement(\"div\"), {\n      owner: this.hostElement,\n      itemsSource: t,\n      itemClicked: function (t, i) {\n        e.itemClicked.raise(t, i);\n      },\n      formatItem: function (t, i) {\n        e.formatItem.raise(t, i);\n      }\n    });\n    var r = this.collectionView,\n      a = s.collectionView;\n    r && r.filter && a && !a.filter && (a.filter = r.filter);\n    \"displayMemberPath,selectedValuePath,isContentHtml,command,commandPath,commandParameterPath,maxDropDownWidth,maxDropDownHeight,dropDownCssClass,isAnimated,subItemsPath,openOnHover,closeOnLeave\".split(\",\").forEach(function (t) {\n      s[t] = e[t];\n    });\n    var l = s.dropDown;\n    setAttribute(l, \"dir\", o ? \"rtl\" : null);\n    s.show(n);\n    l[Control._OWNR_KEY] = this.dropDown;\n    l.focus();\n    return s;\n  };\n  Menu.prototype._raiseCommand = function (e) {\n    var t = this.selectedItem,\n      i = this._getSubItems(t),\n      n = this._getCommand(t);\n    if (n && !i) {\n      var o = this._getCommandParm(t);\n      if (!this._canExecuteCommand(n, o)) return;\n      this._executeCommand(n, o);\n    }\n    var s = this.headerPath;\n    if (s) {\n      var r = new Binding(s).getValue(t);\n      r = null == r ? \"\" : r.toString();\n      this.header = this.isContentHtml ? r : escapeHtml(r);\n    }\n    this.onItemClicked(e);\n    if (this.containsFocus()) {\n      for (var a = this; a && a.owner;) {\n        var l = Control.getControl(a.owner);\n        if (!(l instanceof Menu)) break;\n        a = l;\n      }\n      var h = a.owner;\n      !h && a.dropDown && (h = a.dropDown[Control._OWNR_KEY]);\n      a.isDroppedDown = !1;\n      a.focus();\n      if (!a.containsFocus() && h instanceof HTMLElement && h.offsetHeight) if (isIE) {\n        var u = document.documentElement,\n          c = u.scrollLeft,\n          p = u.scrollTop;\n        h.focus();\n        u.scrollLeft = c, u.scrollTop = p;\n      } else h.focus();\n    }\n  };\n  Menu.prototype._getCommand = function (e) {\n    var t = e && this._cmdPath ? e[this._cmdPath] : null;\n    return t || this._cmd;\n  };\n  Menu.prototype._getCommandParm = function (e) {\n    var t = this._cmdParamPath;\n    return e && t ? e[t] : e;\n  };\n  Menu.prototype._executeCommand = function (e, t) {\n    e && !isFunction(e) && (e = e.executeCommand);\n    isFunction(e) && e(t);\n  };\n  Menu.prototype._canExecuteCommand = function (e, t) {\n    if (e) {\n      var i = e.canExecuteCommand;\n      if (isFunction(i)) return i(t);\n    }\n    return !0;\n  };\n  Menu.prototype._enableDisableItems = function () {\n    if (this.collectionView && (this._cmd || this._cmdPath)) for (var e = this.collectionView.items, t = 0; t < e.length; t++) {\n      var i = e[t],\n        n = this._getCommand(i);\n      if (n) {\n        var o = this._lbx.hostElement.children[t],\n          s = this._getCommandParm(i);\n        toggleClass(o, \"wj-state-disabled\", !this._canExecuteCommand(n, s));\n      }\n    }\n  };\n  Menu.prototype._clearHover = function (e) {\n    this._toHover && clearTimeout(this._toHover);\n    this._toHover = null;\n    Menu._evtHover = e;\n  };\n  Menu.prototype._isTargetDisabled = function (e) {\n    return hasClass(e.target, \"wj-state-disabled\");\n  };\n  Menu.prototype._hoverEnter = function (e) {\n    var t = this;\n    this._clearHover(e);\n    this._toHover = setTimeout(function () {\n      t._toHover = null;\n      t.isDroppedDown = !0;\n    }, Control._HOVER_DELAY);\n  };\n  Menu.prototype._hoverOver = function (e) {\n    var t = this;\n    this._clearHover(e);\n    this._toHover = setTimeout(function () {\n      t._toHover = null;\n      var i = t.listBox.indexOf(e.target);\n      if (i > -1 && !hasClass(e.target, \"wj-state-disabled\")) {\n        t.selectedIndex = i;\n        t._subMenu = t._showSubMenu();\n      }\n    }, Control._HOVER_DELAY);\n  };\n  Menu.prototype._hoverLeave = function (e) {\n    var t = this;\n    this._clearHover(e);\n    this.isDroppedDown && (this._toHover = setTimeout(function () {\n      var i = (e = Menu._evtHover) ? document.elementFromPoint(e.clientX, e.clientY) : null,\n        n = closest(i, \".wj-listbox.wj-menu-items\"),\n        o = t._subMenu;\n      if (!n && !contains(t.hostElement, i, !0)) {\n        t.isDroppedDown = !1;\n        o && (o.isDroppedDown = !1);\n      }\n    }, Control._LEAVE_DELAY));\n  };\n  Menu.prototype._setIsDisabled = function (t) {\n    e.prototype._setIsDisabled.call(this, t);\n    this.hostElement.tabIndex = this.isDisabled ? -1 : this._orgTabIndex;\n  };\n  Menu.prototype._setTabOrder = function (t) {\n    e.prototype._setTabOrder.call(this, t);\n    this.hostElement.tabIndex = this.isDisabled ? -1 : this._orgTabIndex;\n  };\n  return Menu;\n}(ComboBox);\nexport { Menu };\nvar InputTime = function (e) {\n  __extends(InputTime, e);\n  function InputTime(t, i) {\n    var n = e.call(this, t) || this;\n    n._format = \"t\";\n    n.valueChanged = new Event();\n    addClass(n.hostElement, \"wj-inputtime\");\n    n.isEditable = !0;\n    n._value = DateTime.newDate();\n    n._min = n._max = null;\n    n._msk = new _MaskProvider(n._tbx);\n    isIE9() || (n._tbx.type = \"tel\");\n    if (\"INPUT\" == n._orgTag) {\n      var o = n._tbx.getAttribute(\"value\");\n      o && (n.value = Globalize.parseDate(o, \"HH:mm:ss\"));\n    }\n    n.step = 15;\n    n.autoExpandSelection = !0;\n    n.initialize(i);\n    n._commitText();\n    return n;\n  }\n  Object.defineProperty(InputTime.prototype, \"inputElement\", {\n    get: function () {\n      return this._tbx;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputTime.prototype, \"inputType\", {\n    get: function () {\n      return this._tbx.type;\n    },\n    set: function (e) {\n      this._tbx.type = asString(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputTime.prototype, \"value\", {\n    get: function () {\n      return this._value;\n    },\n    set: function (e) {\n      (e = asDate(e, !this.isRequired)) && (e = this._clamp(e));\n      this._setText(e ? Globalize.format(e, this.format) : \"\", !0);\n      this.selectedItem && this.selectedItem.value && (e = DateTime.fromDateTime(e, this.selectedItem.value));\n      if (e != this._value && !DateTime.equals(e, this._value)) {\n        this._value = e;\n        this.onValueChanged();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputTime.prototype, \"text\", {\n    get: function () {\n      return this._tbx.value;\n    },\n    set: function (e) {\n      if (e != this.text && (this.text || !this.isRequired)) {\n        this._setText(e, !0);\n        this._commitText();\n      }\n      !this.text && this.isRequired && (this.selectedIndex = this._oldIndexToBeRestoredOnBlur < 0 ? 0 : this._oldIndexToBeRestoredOnBlur);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputTime.prototype, \"min\", {\n    get: function () {\n      return this._min;\n    },\n    set: function (e) {\n      this._min = asDate(e, !0);\n      this.isDroppedDown = !1;\n      this._updateItems();\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputTime.prototype, \"max\", {\n    get: function () {\n      return this._max;\n    },\n    set: function (e) {\n      this._max = asDate(e, !0);\n      this.isDroppedDown = !1;\n      this._updateItems();\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputTime.prototype, \"step\", {\n    get: function () {\n      return this._step;\n    },\n    set: function (e) {\n      if (e != this.step) {\n        this._step = asNumber(e, !0);\n        this.isDroppedDown = !1;\n        this._updateItems();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputTime.prototype, \"format\", {\n    get: function () {\n      return this._format;\n    },\n    set: function (e) {\n      if (e != this.format) {\n        this._format = asString(e);\n        this._tbx.value = Globalize.format(this.value, this.format);\n        hasItems(this.collectionView) && this._updateItems();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputTime.prototype, \"mask\", {\n    get: function () {\n      return this._msk.mask;\n    },\n    set: function (e) {\n      this._msk.mask = asString(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  InputTime.prototype.onLostFocus = function () {\n    e.prototype.onLostFocus.call(this);\n  };\n  InputTime.prototype.onValueChanged = function (e) {\n    this.valueChanged.raise(this, e);\n  };\n  InputTime.prototype.onItemsSourceChanged = function (t) {\n    e.prototype.onItemsSourceChanged.call(this, t);\n    this._hasCustomItems = null != this.itemsSource;\n  };\n  InputTime.prototype.refresh = function (t) {\n    void 0 === t && (t = !0);\n    e.prototype.refresh.call(this, t);\n    if (this.hostElement) {\n      this._msk.refresh();\n      this._tbx.value = Globalize.format(this.value, this.format);\n      this._updateItems();\n    }\n  };\n  InputTime.prototype.onSelectedIndexChanged = function (t) {\n    if (this.selectedIndex > -1 && !this._settingText) {\n      var i = this.value ? this.value : DateTime.newDate(),\n        n = null != this.selectedItem.value ? this.selectedItem.value : Globalize.parseDate(this.text, this.format, this.value);\n      this.value = DateTime.fromDateTime(i, n);\n    }\n    e.prototype.onSelectedIndexChanged.call(this, t);\n  };\n  InputTime.prototype._clamp = function (e) {\n    null != this._min && this._getTime(e) < this._getTime(this._min) && (e = DateTime.fromDateTime(e, this._min));\n    null != this._max && this._getTime(e) > this._getTime(this._max) && (e = DateTime.fromDateTime(e, this._max));\n    return e;\n  };\n  InputTime.prototype._wheel = function (t) {\n    if (!t.defaultPrevented && !this.isDroppedDown && !this.isReadOnly && this.containsFocus() && this.selectedIndex < 0 && this.value && isNumber(this.step) && this.step > 0) {\n      var i = DateTime.addMinutes(this.value, this.step * clamp(t.deltaY, -1, 1));\n      this.value = this._clamp(i);\n      this.selectAll();\n      t.preventDefault();\n    }\n    e.prototype._wheel.call(this, t);\n  };\n  InputTime.prototype._updateInputSelection = function (t) {\n    if (this._delKey) e.prototype._updateInputSelection.call(this, t);else {\n      for (var i = this._tbx.value; t < i.length && !i[t].match(/[a-z0-9]/i);) t++;\n      setSelectionRange(this._tbx, t, this._tbx.value.length);\n    }\n  };\n  InputTime.prototype._updateItems = function () {\n    if (!this._hasCustomItems) {\n      var e = [],\n        t = new Date(2020, 0),\n        i = new Date(2020, 0, 1, 23, 59, 59),\n        n = this.step;\n      this.min && t.setHours(this.min.getHours(), this.min.getMinutes(), this.min.getSeconds());\n      this.max && i.setHours(this.max.getHours(), this.max.getMinutes(), this.max.getSeconds());\n      if (isNumber(n) && n >= 1) for (var o = t; o <= i; o = DateTime.addMinutes(o, n)) e.push({\n        value: o,\n        text: Globalize.format(o, this.format)\n      });\n      var s = this.value;\n      this._settingText = !0;\n      this.displayMemberPath = \"text\";\n      this.selectedValuePath = \"text\";\n      this.itemsSource = e;\n      this._hasCustomItems = !1;\n      this._settingText = !1;\n      !s && this.isRequired || (this.value = s);\n    }\n  };\n  InputTime.prototype._getTime = function (e) {\n    return 3600 * e.getHours() + 60 * e.getMinutes() + e.getSeconds();\n  };\n  InputTime.prototype._keydown = function (t) {\n    e.prototype._keydown.call(this, t);\n    if (!t.defaultPrevented) switch (t.keyCode) {\n      case Key.Enter:\n        if (!this.isDroppedDown) {\n          this._commitText();\n          this.selectAll();\n        }\n        break;\n      case Key.Escape:\n        this.text = Globalize.format(this.value, this.format);\n        this.selectAll();\n    }\n  };\n  InputTime.prototype._commitText = function () {\n    if (this.text || this.isRequired) {\n      var e = this.value ? Globalize.format(this.value, this.format) : \"\";\n      if (this.text != e) {\n        var t = this.selectedItem && this.selectedItem.value ? this.selectedItem.value : Globalize.parseDate(this.text, this.format, this.value);\n        t ? (DateTime.sameTime(t, this._clamp(t)) || this.onInvalidInput(new CancelEventArgs())) && (this.value = DateTime.fromDateTime(this.value, t)) : this.onInvalidInput(new CancelEventArgs()) && (this.text = e);\n      }\n    } else this.value = null;\n  };\n  InputTime.prototype._copy = function (e, t) {\n    if (\"text\" === e) {\n      (t || \"\").toString() !== this.text && this._setText(t, !0);\n      return !0;\n    }\n    return !1;\n  };\n  return InputTime;\n}(ComboBox);\nexport { InputTime };\n_addCultureInfo(\"InputDateTime\", {\n  ariaLabels: {\n    tglDate: \"Toggle Calendar\",\n    tglTime: \"Toggle Time List\"\n  }\n});\nvar InputDateTime = function (e) {\n  __extends(InputDateTime, e);\n  function InputDateTime(t, i) {\n    var n = e.call(this, t) || this;\n    addClass(n.hostElement, \"wj-inputdatetime\");\n    var o = culture.InputDateTime.ariaLabels;\n    setAriaLabel(n._btn, o.tglDate);\n    setAriaLabel(n._btnTm, o.tglTime);\n    n.value = new Date();\n    n.format = \"g\";\n    n._inputTime = new InputTime(document.createElement(\"div\"), {\n      valueChanged: function (e) {\n        var t = n.rangeEnd;\n        n.value = DateTime.fromDateTime(n.value, e.value);\n        n.calendar._rngMode() && t && (n.rangeEnd = DateTime.fromDateTime(t, e.value));\n      },\n      isDroppedDownChanged: function (e) {\n        e.listBox.containsFocus() && n.inputElement.focus();\n        n._selectAll();\n      }\n    });\n    var s = n.addEventListener.bind(n);\n    n._btnTm = n.hostElement.querySelector('[wj-part=\"btn-tm\"]');\n    s(n._btnTm, \"mousedown\", function (e) {\n      n._btnclick(e);\n    });\n    n._ddDate = n._dropDown;\n    var r = n._ddTime = n._inputTime.dropDown;\n    s(r, \"keydown\", n._keydown.bind(n), !0);\n    s(r, \"blur\", function () {\n      n._updateFocusState();\n    }, !0);\n    s(r, \"click\", function (e) {\n      e.defaultPrevented || e.target != r && n.hostElement.focus();\n    }, !0);\n    n.initialize(i);\n    n._commitText();\n    return n;\n  }\n  Object.defineProperty(InputDateTime.prototype, \"timeMin\", {\n    get: function () {\n      return this._inputTime.min;\n    },\n    set: function (e) {\n      this._inputTime.min = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDateTime.prototype, \"timeMax\", {\n    get: function () {\n      return this._inputTime.max;\n    },\n    set: function (e) {\n      this._inputTime.max = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDateTime.prototype, \"timeFormat\", {\n    get: function () {\n      return this._inputTime.format;\n    },\n    set: function (e) {\n      this._inputTime.format = e;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDateTime.prototype, \"timeStep\", {\n    get: function () {\n      return this._inputTime.step;\n    },\n    set: function (e) {\n      this._inputTime.step = e;\n      this._btnTm.style.display = isNumber(e) && e > 0 ? \"\" : \"none\";\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(InputDateTime.prototype, \"inputTime\", {\n    get: function () {\n      return this._inputTime;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  InputDateTime.prototype._fromDateTime = function (e) {\n    return e;\n  };\n  InputDateTime.prototype._btnclick = function (t) {\n    var i = closest(t.target, \"button\") == this._btn ? this._ddDate : this._ddTime;\n    this._setDropdown(i);\n    e.prototype._btnclick.call(this, t);\n  };\n  InputDateTime.prototype.dispose = function () {\n    this._setDropdown(this._ddDate);\n    e.prototype.dispose.call(this);\n    this._inputTime.dispose();\n  };\n  InputDateTime.prototype.refresh = function (t) {\n    void 0 === t && (t = !0);\n    this._inputTime.refresh();\n    e.prototype.refresh.call(this, t);\n  };\n  InputDateTime.prototype._updateBtn = function () {\n    e.prototype._updateBtn.call(this);\n    if (this._btnTm) {\n      this._btnTm.tabIndex = this._btn.tabIndex;\n      this._btnTm.parentElement.style.display = this._btn.style.display;\n    }\n  };\n  InputDateTime.prototype._setDropdown = function (e) {\n    if (this._dropDown == e) return !1;\n    this.isDroppedDown && (this.isDroppedDown = !1);\n    var t = this.dropDownCssClass;\n    this.dropDownCssClass = \"\";\n    this._dropDown = e;\n    this.dropDownCssClass = t;\n    return !0;\n  };\n  InputDateTime.prototype._updateDropDown = function () {\n    var t = this._inputTime;\n    if (this._dropDown == t.dropDown) {\n      this._commitText();\n      e.prototype._updateDropDown.call(this);\n      t.isRequired = this.isRequired && null != this.value;\n      t.value = this.value;\n      this.isDroppedDown && t.listBox.showSelection();\n    } else e.prototype._updateDropDown.call(this);\n  };\n  InputDateTime.controlTemplate = '<div class=\"wj-template\"><div class=\"wj-input\"><div class=\"wj-input-group wj-input-btn-visible\"><input wj-part=\"input\" type=\"text\" class=\"wj-form-control\"/><span class=\"wj-input-group-btn\"><button wj-part=\"btn\" class=\"wj-btn wj-btn-default\" tabindex=\"-1\"><span class=\"wj-glyph-calendar\"></span></button><button wj-part=\"btn-tm\" class=\"wj-btn wj-btn-default\" tabindex=\"-1\"><span class=\"wj-glyph-clock\"></span></button></span></div></div><div wj-part=\"dropdown\" class=\"wj-content wj-dropdown-panel\"></div></div>';\n  return InputDateTime;\n}(InputDate);\nexport { InputDateTime };\nvar AutoComplete = function (e) {\n  __extends(AutoComplete, e);\n  function AutoComplete(t, i) {\n    var n = e.call(this, t) || this;\n    n._cssMatch = \"wj-state-match\";\n    n._minLength = 2;\n    n._maxItems = 6;\n    n._itemCount = 0;\n    n._beginsWith = !1;\n    n._delay = Control._SEARCH_DELAY;\n    n._query = \"\";\n    n._inCallback = !1;\n    n._srchProps = [];\n    n._oldSelectedIndex = -1;\n    addClass(n.hostElement, \"wj-autocomplete\");\n    n._bsCollapse = !1;\n    n.isEditable = !0;\n    n.isRequired = !1;\n    n.listBox.formatItem.addHandler(n._formatListItem, n);\n    n._itemsSourceFnCallbackBnd = n._itemSourceFunctionCallback.bind(n);\n    n.initialize(i);\n    return n;\n  }\n  Object.defineProperty(AutoComplete.prototype, \"minLength\", {\n    get: function () {\n      return this._minLength;\n    },\n    set: function (e) {\n      this._minLength = asNumber(e, !1, !0);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(AutoComplete.prototype, \"beginsWithSearch\", {\n    get: function () {\n      return this._beginsWith;\n    },\n    set: function (e) {\n      this._beginsWith = asBoolean(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(AutoComplete.prototype, \"maxItems\", {\n    get: function () {\n      return this._maxItems;\n    },\n    set: function (e) {\n      this._maxItems = asNumber(e, !1, !0);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(AutoComplete.prototype, \"delay\", {\n    get: function () {\n      return this._delay;\n    },\n    set: function (e) {\n      this._delay = asNumber(e, !1, !0);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(AutoComplete.prototype, \"searchMemberPath\", {\n    get: function () {\n      return this._srchProp;\n    },\n    set: function (e) {\n      this._srchProp = asString(e);\n      this._srchProps = e ? e.trim().split(/\\s*,\\s*/) : [];\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(AutoComplete.prototype, \"itemsSourceFunction\", {\n    get: function () {\n      return this._itemsSourceFn;\n    },\n    set: function (e) {\n      this._itemsSourceFn = asFunction(e);\n      isFunction(this._itemsSourceFn) && this.itemsSourceFunction(this.text, this.maxItems, this._itemsSourceFnCallbackBnd);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(AutoComplete.prototype, \"cssMatch\", {\n    get: function () {\n      return this._cssMatch;\n    },\n    set: function (e) {\n      this._cssMatch = asString(e);\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  AutoComplete.prototype.onSelectedIndexChanged = function (t) {\n    this._settingText || e.prototype.onSelectedIndexChanged.call(this, t);\n  };\n  AutoComplete.prototype._keydown = function (t) {\n    if (!t.defaultPrevented && this.isDroppedDown) switch (t.keyCode) {\n      case Key.Up:\n      case Key.Down:\n        this.selectAll();\n    }\n    e.prototype._keydown.call(this, t);\n  };\n  AutoComplete.prototype._setText = function (e) {\n    var t = this;\n    if (this._composing && e != this._oldText) {\n      this._oldText = e;\n      this.onTextChanged();\n    }\n    if (!this._inCallback && !this._settingText) {\n      this._toSearch || (this._oldSelectedIndex = this.selectedIndex);\n      if (this.selectedIndex > -1 && this.getDisplayText() != e) {\n        this._settingText = !0;\n        this.selectedIndex = -1;\n        this._settingText = !1;\n      }\n      this._toSearch && clearTimeout(this._toSearch);\n      if (e != this._oldText) {\n        var i = this._tbx,\n          n = this._tbx.selectionStart;\n        i.value != e && (i.value = e);\n        this._isWheel && this.containsFocus() && this._updateInputSelection(n);\n        this._oldText = e;\n        this.onTextChanged();\n        var o = this.collectionView;\n        if (!e && o) {\n          (this._query || this.selectedIndex < 0) && (this.isDroppedDown = !1);\n          this._query = this._rxHighlight = null;\n          o.filter = null;\n          var s = this.itemsSourceFunction;\n          if (isFunction(s)) {\n            this.isDroppedDown = !1;\n            s(this._query, this.maxItems, this._itemsSourceFnCallbackBnd);\n          }\n          -1 == this.selectedIndex && -1 != this._oldSelectedIndex && this.onSelectedIndexChanged();\n          return;\n        }\n      }\n      e != this.getDisplayText() && (this._toSearch = setTimeout(function () {\n        t._toSearch = null;\n        var e = t.text;\n        if (e.trim().length >= t._minLength && e != t._query) {\n          t._query = e.trim();\n          e = escapeRegExp(e);\n          var i = escapeHtml(e.trim()),\n            n = t.caseSensitiveSearch ? \"\" : \"i\";\n          t._beginsWith || (n += \"g\");\n          t._rxSrch = t._beginsWith ? new RegExp(\"^\" + e + \".*\", n) : new RegExp(\"(?=.*\" + e.replace(/ /g, \")(?=.*\") + \")\", n);\n          t._rxHighlight = t._beginsWith ? new RegExp(\"^\" + e, n) : new RegExp(\"(\" + i.replace(/\\s+/g, \"|\") + \")\", n);\n          var o = t.itemsSourceFunction;\n          isFunction(o) ? o(t._query, t.maxItems, t._itemsSourceFnCallbackBnd) : t._updateItems();\n        }\n        -1 == t.selectedIndex && -1 != t._oldSelectedIndex && t.onSelectedIndexChanged();\n      }, this._delay));\n    }\n  };\n  AutoComplete.prototype.onLostFocus = function (t) {\n    var i = !1;\n    if (this.isRequired && !this.isEditable && this.text) {\n      i = !0;\n      var n = this.indexOf(this.text, !0);\n      n < 0 && (n = this.indexOf(this.text, !1));\n      n > -1 && (this._oldSelectedIndex = n);\n      n < 0 && (this._oldSelectedIndex = 0);\n    }\n    if (this._toSearch) {\n      clearTimeout(this._toSearch);\n      var o = this._delay;\n      this._delay = 0;\n      this._setText(this.text);\n      this.delay = o;\n    }\n    e.prototype.onLostFocus.call(this, t, this._oldSelectedIndex, i);\n  };\n  AutoComplete.prototype._itemSourceFunctionCallback = function (e) {\n    this._inCallback = !0;\n    var t = asCollectionView(e || []);\n    t.moveCurrentToPosition(-1);\n    this.itemsSource = t;\n    this._inCallback = !1;\n    if (this.containsFocus()) {\n      var i = this._tbx,\n        n = i.selectionStart,\n        o = i.selectionEnd,\n        s = this.collectionView;\n      this.isDroppedDown = null != s && s.items.length > 0;\n      setSelectionRange(i, n, o);\n      this.refresh();\n    }\n  };\n  AutoComplete.prototype.onIsDroppedDownChanged = function (t) {\n    e.prototype.onIsDroppedDownChanged.call(this, t);\n    if (this.containsFocus() && !this.isTouching) {\n      var i = this.collectionView;\n      if (this.selectedIndex < 0 && i) {\n        var n = i.items,\n          o = this.text;\n        1 == n.length && n[0] == o ? this.selectedIndex = 0 : setSelectionRange(this._tbx, o.length);\n      }\n    }\n    this._query = \"\";\n  };\n  AutoComplete.prototype._updateItems = function () {\n    var e = this.collectionView;\n    if (e) {\n      this._inCallback = !0;\n      e.beginUpdate();\n      this._itemCount = 0;\n      e.filter = this._filter.bind(this);\n      e.moveCurrentToPosition(-1);\n      e.endUpdate();\n      this._inCallback = !1;\n      var t = e.items.length,\n        i = this._tbx,\n        n = i.selectionStart,\n        o = i.selectionEnd;\n      this.text.trim() || (t = 0);\n      this.isDroppedDown = t > 0 && this.containsFocus();\n      t || this.isEditable || (this.selectedIndex = -1);\n      if (1 == t && this.selectedIndex < 0) {\n        var s = this._getItemText(e.items[0], !1),\n          r = i.value;\n        if (!this.caseSensitiveSearch) {\n          s = s.toLowerCase();\n          r = r.toLowerCase();\n        }\n        s == r && (this.selectedIndex = 0);\n      }\n      this.isDroppedDown && setSelectionRange(i, n, o);\n      this.refresh();\n    }\n  };\n  AutoComplete.prototype._filter = function (e) {\n    if (this._itemCount >= this._maxItems && this._query) return !1;\n    var t = [this._getItemText(e, !1)];\n    this._srchProps && this._srchProps.forEach(function (i) {\n      var n = e[i];\n      null != n && t.push(n);\n    });\n    this.isContentHtml && (t = t.map(function (e) {\n      return e.replace(/(<[^>]*>|&[^;]*;)/g, \"\");\n    }));\n    for (var i = 0; i < t.length; i++) if (this._rxSrch.test(t[i])) {\n      this._itemCount++;\n      return !0;\n    }\n    return !1;\n  };\n  AutoComplete.prototype._getItemText = function (e, t) {\n    var i = e ? e.toString() : \"\",\n      n = t && this.headerPath ? this._pathHdr : this._lbx._pathDisplay;\n    n && (i = null != (i = n.getValue(e)) ? i.toString() : \"\");\n    return i;\n  };\n  AutoComplete.prototype._formatListItem = function (e, t) {\n    var i = this;\n    this._cssMatch && this._rxHighlight && this._query && (t.item.innerHTML = t.item.innerHTML.replace(this._rxHighlight, function (e, t, n, o) {\n      return i._enclosed(o, n, \"<\", \">\") || i._enclosed(o, n, \"&\", \";\") ? e : '<span class=\"' + i._cssMatch + '\">' + e + \"</span>\";\n    }));\n  };\n  AutoComplete.prototype._enclosed = function (e, t, i, n) {\n    for (var o = t; o >= 0 && e[o] != n; o--) if (e[o] == i) for (var s = t; s < e.length && e[s] != i; s++) if (e[s] == n) return !0;\n    return !1;\n  };\n  AutoComplete.prototype._wheel = function (t) {\n    e.prototype._wheel.call(this, t);\n  };\n  return AutoComplete;\n}(ComboBox);\nexport { AutoComplete };\nvar MultiAutoComplete = function (e) {\n  __extends(MultiAutoComplete, e);\n  function MultiAutoComplete(t, i) {\n    var n = e.call(this, t) || this;\n    n._selItems = [];\n    n._maxSelItems = null;\n    n._lastInputValue = \"\";\n    n._selPath = new Binding(null);\n    n._notAddItm = !1;\n    n.selectedItemsChanged = new Event();\n    addClass(n.hostElement, \"wj-multi-autocomplete\");\n    n._wjTpl = n.hostElement.querySelector(\".wj-template\");\n    n._wjInput = n.hostElement.querySelector(\".wj-input\");\n    n.showDropDownButton = !1;\n    n.initialize(i);\n    n.addEventListener(n.hostElement, \"keyup\", n._keyup.bind(n), !0);\n    n.addEventListener(window, \"resize\", n._adjustInputWidth.bind(n));\n    n.addEventListener(n._tbx, \"focus\", function () {\n      n._itemOff();\n    });\n    n._addHelperInput();\n    n._initSeltems();\n    n.listBox.itemsChanged.addHandler(function () {\n      return n.selectedIndex = -1;\n    });\n    n._refreshHeader();\n    n._updateTabIndex();\n    return n;\n  }\n  Object.defineProperty(MultiAutoComplete.prototype, \"showDropDownButton\", {\n    set: function (e) {\n      this._showBtn = !1;\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiAutoComplete.prototype, \"maxSelectedItems\", {\n    get: function () {\n      return this._maxSelItems;\n    },\n    set: function (e) {\n      if (this._maxSelItems != e) {\n        this._maxSelItems = asNumber(e, !0);\n        this._updateMaxItems();\n        this._refreshHeader();\n        this._clearSelIndex();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiAutoComplete.prototype, \"selectedMemberPath\", {\n    get: function () {\n      return this._selPath.path;\n    },\n    set: function (e) {\n      if ((e = asString(e)) !== this.selectedMemberPath) {\n        this._selPath.path = e;\n        this._initSeltems();\n        this._refreshHeader();\n        this.onSelectedItemsChanged();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  Object.defineProperty(MultiAutoComplete.prototype, \"selectedItems\", {\n    get: function () {\n      return this._selItems;\n    },\n    set: function (e) {\n      var t = this._selItems === e;\n      t || null == this._selItems || null == e || this._selItems.length !== e.length || (t = this._selItems.every(function (t, i) {\n        return t === e[i];\n      }));\n      this._selItems = asArray(e);\n      if (!t) {\n        if (this.selectedMemberPath && \"\" !== this.selectedMemberPath && this._selItems) for (var i = 0; i < this._selItems.length; i++) {\n          var n = this._selItems[i];\n          this._setSelItem(n, !1);\n        }\n        this._updateMaxItems();\n        this.onSelectedItemsChanged();\n        this._refreshHeader();\n        this._clearSelIndex();\n      }\n    },\n    enumerable: !0,\n    configurable: !0\n  });\n  MultiAutoComplete.prototype.onSelectedItemsChanged = function (e) {\n    this.selectedItemsChanged.raise(this, e);\n  };\n  MultiAutoComplete.prototype.onIsDroppedDownChanged = function (t) {\n    !this.isDroppedDown && this.selectedIndex > -1 && !this._notAddItm && this._addItem(!0);\n    this._notAddItm = !1;\n    e.prototype.onIsDroppedDownChanged.call(this, t);\n  };\n  MultiAutoComplete.prototype.refresh = function (t) {\n    void 0 === t && (t = !0);\n    e.prototype.refresh.call(this, t);\n    if (this.hostElement) {\n      this._initSeltems();\n      this.isDroppedDown || this._refreshHeader();\n    }\n  };\n  MultiAutoComplete.prototype._keydown = function (t) {\n    if (!this.isReadOnly) {\n      if (!t.defaultPrevented) switch (t.keyCode) {\n        case Key.Back:\n          this._lastInputValue = this._tbx.value;\n          break;\n        case Key.Enter:\n          this._itemOff();\n          this._addItem(!0);\n          isIE() && setSelectionRange(this._tbx, this._tbx.textContent.length, this._tbx.textContent.length);\n          break;\n        case Key.Tab:\n          if (this.isDroppedDown) {\n            this._addItem(!1);\n            this._tbx.value = \"\";\n            this._lbx.selectedIndex = -1;\n            this.isDroppedDown = !1;\n            this.containsFocus() || this.focus();\n            t.preventDefault();\n          } else this._updateFocus();\n          break;\n        case Key.Space:\n          if (\"\" !== this._tbx.value) return;\n          if (!this.isDroppedDown && !this._tbx.disabled) {\n            this.isDroppedDown = !0;\n            this._clearSelIndex();\n          }\n          break;\n        case Key.Escape:\n          this.isDroppedDown && (this._notAddItm = !0);\n          break;\n        case Key.Left:\n          this._itemOn(!this.rightToLeft);\n          break;\n        case Key.Right:\n          this._itemOn(!!this.rightToLeft);\n          break;\n        case Key.Up:\n        case Key.Down:\n          var i = getActiveElement();\n          if (t.altKey) {\n            if (this._tbx == i) {\n              this.isDroppedDown = !this.isDroppedDown;\n              this.isDroppedDown || this._tbx.focus();\n              t.preventDefault();\n              return;\n            }\n          } else if (this._tbx !== i) return;\n        default:\n          if (t.keyCode === Key.Back || t.keyCode === Key.Delete) return;\n          this._itemOff();\n          null != this._maxSelItems && this._selItems.length >= this._maxSelItems && t.preventDefault();\n      }\n      this._tbx.disabled || e.prototype._keydown.call(this, t);\n    }\n  };\n  MultiAutoComplete.prototype._updateState = function () {\n    e.prototype._updateState.call(this);\n    this._wjTpl && (hasClass(this.hostElement, \"wj-state-focused\") || this._itemOff());\n  };\n  MultiAutoComplete.prototype._keyup = function (e) {\n    if (!this.isReadOnly && !e.defaultPrevented) switch (e.keyCode) {\n      case Key.Back:\n        0 === this._tbx.value.length && 0 === this._lastInputValue.length && this._delItem(!1);\n        break;\n      case Key.Delete:\n        this._delItem(!0);\n    }\n  };\n  MultiAutoComplete.prototype._addHelperInput = function () {\n    var e = document.createElement(\"input\");\n    e.type = \"text\";\n    e.tabIndex = -1;\n    e.className = \"wj-token-helper\";\n    e.readOnly = !0;\n    this._wjTpl.insertBefore(e, this._wjInput);\n    this._helperInput = e;\n  };\n  MultiAutoComplete.prototype._refreshHeader = function () {\n    for (var e = this.hostElement.querySelectorAll(\".wj-token\"), t = 0; t < e.length; t++) this._wjTpl.removeChild(e[t]);\n    var i = this.selectedItems;\n    if (i && 0 !== i.length) {\n      for (t = 0; t < i.length; t++) this._insertToken(i[t]);\n      this._wjInput.style.cssFloat = this.rightToLeft ? \"right\" : \"left\";\n      this._adjustInputWidth();\n    } else {\n      this._wjInput.style.cssFloat = this.rightToLeft ? \"right\" : \"left\";\n      this._adjustInputWidth();\n    }\n  };\n  MultiAutoComplete.prototype._insertToken = function (e) {\n    var t = this._getItemText(e, !0);\n    this.isContentHtml || (t = escapeHtml(t));\n    this._wjTpl.insertBefore(this._createItem(t), this._wjInput);\n  };\n  MultiAutoComplete.prototype._updateMaxItems = function () {\n    null != this._maxSelItems && this._selItems && this._selItems.length > this._maxSelItems && (this._selItems = this._selItems.slice(0, this._maxSelItems));\n  };\n  MultiAutoComplete.prototype._updateFocus = function () {\n    var e = this,\n      t = this._wjTpl.querySelector(\".\" + MultiAutoComplete._clsActive);\n    if (t) {\n      removeClass(t, MultiAutoComplete._clsActive);\n      setTimeout(function () {\n        e._tbx.focus();\n      });\n    } else this._clearSelIndex();\n  };\n  MultiAutoComplete.prototype._addItem = function (e) {\n    if (this.selectedItems.indexOf(this.selectedItem) > -1) this._clearSelIndex();else if (this.selectedIndex > -1) {\n      this._updateSelItems(this.selectedItem, !0);\n      this._refreshHeader();\n      e && this._clearSelIndex();\n      this._disableInput(!0);\n    }\n  };\n  MultiAutoComplete.prototype._delItem = function (e) {\n    var t,\n      i,\n      n = this._wjTpl.querySelector(\".\" + MultiAutoComplete._clsActive),\n      o = !1;\n    if (!e || n) {\n      if (n) {\n        if ((i = this._getItemIndex(n)) > -1) {\n          t = this._selItems[i];\n          o = !0;\n        }\n      } else if (this._selItems.length > 0) {\n        t = this._selItems[this._selItems.length - 1];\n        o = !0;\n      }\n      if (o) {\n        this._updateSelItems(t, !1);\n        this._refreshHeader();\n        this._clearSelIndex();\n        this._disableInput(!1);\n      }\n      this._tbx.focus();\n    }\n  };\n  MultiAutoComplete.prototype._updateSelItems = function (e, t) {\n    if (t) {\n      this._selItems && 0 !== this._selItems.length || (this._selItems = []);\n      if (null != this._maxSelItems && this._selItems.length >= this._maxSelItems) return;\n      this._selItems.push(e);\n    } else {\n      var i = this._selItems.indexOf(e);\n      this._selItems.splice(i, 1);\n    }\n    this._hasSelectedMemeberPath() && this._setSelItem(e, t);\n    this.onSelectedItemsChanged();\n  };\n  MultiAutoComplete.prototype._createItem = function (e) {\n    var t = this,\n      i = document.createElement(\"div\"),\n      n = document.createElement(\"span\"),\n      o = document.createElement(\"a\");\n    i.appendChild(n);\n    i.appendChild(o);\n    i.className = \"wj-token\";\n    n.className = \"wj-token-label\";\n    n.innerHTML = e;\n    o.className = \"wj-token-close\";\n    o.href = \"#\";\n    o.tabIndex = -1;\n    o.text = \"×\";\n    i.style.cssFloat = this.rightToLeft ? \"right\" : \"left\";\n    this.addEventListener(i, \"click\", function (e) {\n      t._helperInput.focus();\n      var n = t._wjTpl.querySelector(\".\" + MultiAutoComplete._clsActive);\n      n && removeClass(n, MultiAutoComplete._clsActive);\n      addClass(i, MultiAutoComplete._clsActive);\n      e.stopPropagation();\n      e.preventDefault();\n    });\n    this.addEventListener(o, \"click\", function (e) {\n      if (!t.isReadOnly) {\n        var n = t._getItemIndex(i);\n        if (n > -1) {\n          var o = t._selItems[n];\n          t._updateSelItems(o, !1);\n        }\n        t._wjTpl.removeChild(i);\n        t._adjustInputWidth();\n        t._disableInput(!1);\n        t._tbx.focus();\n        e.stopPropagation();\n        e.preventDefault();\n      }\n    });\n    return i;\n  };\n  MultiAutoComplete.prototype._itemOn = function (e) {\n    var t,\n      i,\n      n,\n      o = getActiveElement();\n    if ((this._tbx != o || 0 === this._tbx.value.length) && 0 !== (t = this._wjTpl.querySelectorAll(\".wj-token\")).length) {\n      i = this._wjTpl.querySelector(\".\" + MultiAutoComplete._clsActive);\n      n = this._getItemIndex(i);\n      if (e) {\n        if (0 === n) return;\n        if (-1 === n) {\n          addClass(t[t.length - 1], MultiAutoComplete._clsActive);\n          this._helperInput.focus();\n        } else {\n          removeClass(i, MultiAutoComplete._clsActive);\n          addClass(t[n - 1], MultiAutoComplete._clsActive);\n          this._helperInput.focus();\n        }\n      } else if (!e) {\n        if (-1 === n) return;\n        if (n !== t.length - 1) {\n          removeClass(i, MultiAutoComplete._clsActive);\n          addClass(t[n + 1], MultiAutoComplete._clsActive);\n          this._helperInput.focus();\n        } else {\n          removeClass(i, MultiAutoComplete._clsActive);\n          this._tbx.focus();\n        }\n      }\n    }\n  };\n  MultiAutoComplete.prototype._itemOff = function () {\n    var e = this._wjTpl.querySelector(\".\" + MultiAutoComplete._clsActive);\n    e && removeClass(e, MultiAutoComplete._clsActive);\n  };\n  MultiAutoComplete.prototype._initSeltems = function () {\n    if (this.selectedMemberPath) {\n      this._selItems.splice(0, this._selItems.length);\n      var e = this.collectionView;\n      if (e) for (var t = 0; t < e.sourceCollection.length; t++) this._getSelItem(t) && this._selItems.push(e.sourceCollection[t]);\n    }\n  };\n  MultiAutoComplete.prototype._getSelItem = function (e) {\n    var t = this.collectionView,\n      i = t ? t.sourceCollection[e] : null;\n    return !(!isObject(i) || !this.selectedMemberPath) && this._selPath.getValue(i);\n  };\n  MultiAutoComplete.prototype._setSelItem = function (e, t) {\n    this.itemsSource;\n    isObject(e) && this._selPath.getValue(e) != t && this._selPath.setValue(e, t);\n  };\n  MultiAutoComplete.prototype._clearSelIndex = function () {\n    this.selectedIndex = -1;\n  };\n  MultiAutoComplete.prototype._hasSelectedMemeberPath = function () {\n    return this.selectedMemberPath && \"\" !== this.selectedMemberPath;\n  };\n  MultiAutoComplete.prototype._disableInput = function (e) {\n    if (null != this._maxSelItems) if (this._selItems.length < this._maxSelItems) {\n      this._tbx.disabled = !1;\n      this._tbx.focus();\n    } else {\n      this._tbx.disabled = !0;\n      this.hostElement.focus();\n    }\n  };\n  MultiAutoComplete.prototype._adjustInputWidth = function () {\n    this._tbx.style.width = \"60px\";\n    var e,\n      t = getElementRect(this.hostElement),\n      i = getElementRect(this._tbx),\n      n = getComputedStyle(this._tbx),\n      o = parseInt(n.paddingLeft, 10),\n      s = parseInt(n.paddingRight, 10);\n    e = this.rightToLeft ? i.left + i.width - t.left - o - s - 8 : t.left + t.width - i.left - o - s - 8;\n    this._tbx.style.width = e + \"px\";\n  };\n  MultiAutoComplete.prototype._getItemIndex = function (e) {\n    for (var t = this.hostElement.querySelectorAll(\".wj-token\"), i = 0; i < t.length; i++) if (e === t[i]) return i;\n    return -1;\n  };\n  MultiAutoComplete.prototype._setIsDisabled = function (t) {\n    e.prototype._setIsDisabled.call(this, t);\n    this._updateTabIndex();\n  };\n  MultiAutoComplete.prototype._setTabOrder = function (e) {\n    this._orgTabIndex = e;\n    this._updateTabIndex();\n  };\n  MultiAutoComplete.prototype._updateTabIndex = function () {\n    var e = this.hostElement;\n    this._tbx.tabIndex = this.isDisabled ? -1 : this._orgTabIndex;\n    e.tabIndex = -1;\n  };\n  MultiAutoComplete._clsActive = \"wj-token-active\";\n  return MultiAutoComplete;\n}(AutoComplete);\nexport { MultiAutoComplete };\n_registerModule(\"wijmo.input\", selfModule);","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}